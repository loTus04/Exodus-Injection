(window.webpackJsonp=window.webpackJsonp||[]).push([[192],{4413:function(e,t,r){"use strict";function s(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const i=r(5898);t.constants=i,s(r(4750)),s(r(5337)),s(r(7613)),s(r(5006)),s(r(5338)),s(r(7617))},4414:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FIXED_POINT=10**8,t.TRANSFER_FEE=.1*t.FIXED_POINT,t.IN_TRANSFER_FEE=.1*t.FIXED_POINT,t.OUT_TRANSFER_FEE=.1*t.FIXED_POINT,t.SIGNATURE_FEE=5*t.FIXED_POINT,t.DELEGATE_FEE=25*t.FIXED_POINT,t.VOTE_FEE=1*t.FIXED_POINT,t.MULTISIGNATURE_FEE=5*t.FIXED_POINT,t.MULTISIGNATURE_MAX_LIFETIME=72,t.MULTISIGNATURE_MIN_LIFETIME=1,t.MULTISIGNATURE_MAX_KEYSGROUP=15,t.MULTISIGNATURE_MIN_KEYSGROUP=1,t.DAPP_FEE=25*t.FIXED_POINT,t.USERNAME_MAX_LENGTH=20,t.BYTESIZES={TYPE:1,TIMESTAMP:4,MULTISIGNATURE_PUBLICKEY:32,RECIPIENT_ID:8,AMOUNT:8,SIGNATURE_TRANSACTION:64,SECOND_SIGNATURE_TRANSACTION:64,DATA:64},t.EPOCH_TIME=new Date(Date.UTC(2016,4,24,17,0,0,0)),t.EPOCH_TIME_MILLISECONDS=t.EPOCH_TIME.getTime();t.EPOCH_TIME_SECONDS=Math.floor(t.EPOCH_TIME.getTime()/1e3);t.MAX_ADDRESS_NUMBER="18446744073709551615",t.MAX_TRANSACTION_ID="18446744073709551615",t.MAX_TRANSACTION_AMOUNT="9223372036854775807",t.UNCONFIRMED_TRANSACTION_TIMEOUT=10800,t.UNCONFIRMED_MULTISIG_TRANSACTION_TIMEOUT=86400,t.MAX_MULTISIG_SIGNATURES=15,t.MAX_PUBLIC_KEY_LENGTH=32,t.MAX_TRANSFER_ASSET_DATA_LENGTH=64},4452:function(e,t,r){"use strict";function s(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),s(r(7620)),s(r(7621)),s(r(5341)),s(r(5900)),s(r(5901)),s(r(5902)),s(r(5346)),s(r(5007)),s(r(5008)),s(r(7671)),s(r(5917)),s(r(7672))},4491:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class TransactionError extends Error{constructor(e="",t="",r="",s,i){super(),this.message=e,this.name="TransactionError",this.id=t,this.dataPath=r,this.actual=s,this.expected=i}toString(){const e=`Transaction: ${this.id} failed at ${this.dataPath}: ${this.message}`,t=this.actual?`${e}, actual: ${this.actual}`:e;return this.expected?`${t}, expected: ${this.expected}`:t}}t.TransactionError=TransactionError;t.TransactionPendingError=class TransactionPendingError extends TransactionError{constructor(e="",t="",r=""){super(e),this.name="TransactionPendingError",this.id=t,this.dataPath=r}toString(){return`Transaction: ${this.id} failed at ${this.dataPath}: ${this.message} `}},t.convertToTransactionError=(e,t)=>t?t.map(t=>new TransactionError(`'${t.dataPath}' ${t.message}`,e,t.dataPath)):[],t.convertToAssetError=(e,t)=>t?t.map(t=>new TransactionError(`'${t.dataPath||".asset"}' ${t.message}`,e,t.dataPath||".asset")):[]},4622:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4414),a=r(4491),o=r(5340),u=r(4452),c=r(5342);var d;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NONMULTISIGNATURE=1]="NONMULTISIGNATURE",e[e.PENDING=2]="PENDING",e[e.READY=3]="READY",e[e.FAIL=4]="FAIL"}(d=t.MultisignatureStatus||(t.MultisignatureStatus={})),t.ENTITY_ACCOUNT="account",t.ENTITY_TRANSACTION="transaction";t.BaseTransaction=class BaseTransaction{constructor(e){this._multisignatureStatus=d.UNKNOWN;const t="object"==typeof e&&null!==e?e:{};this.amount=new s(u.isValidNumber(t.amount)?t.amount:"0"),this.fee=new s(u.isValidNumber(t.fee)?t.fee:"0"),this._id=t.id,this.recipientId=t.recipientId||"",this.recipientPublicKey=t.recipientPublicKey||void 0,this.senderPublicKey=t.senderPublicKey||"";try{this.senderId=t.senderId?t.senderId:i.getAddressFromPublicKey(this.senderPublicKey)}catch(e){this.senderId=""}this._signature=t.signature,this.signatures=t.signatures||[],this._signSignature=t.signSignature,this.timestamp="number"==typeof t.timestamp?t.timestamp:1/0,this.type="number"==typeof t.type?t.type:1/0,this.confirmations=t.confirmations,this.blockId=t.blockId,this.height=t.height,this.receivedAt=t.receivedAt?new Date(t.receivedAt):void 0,this.relays="number"==typeof t.relays?t.relays:void 0}get id(){if(!this._id)throw new Error("id is required to be set before use");return this._id}get signature(){if(!this._signature)throw new Error("signature is required to be set before use");return this._signature}get signSignature(){return this._signSignature}toJSON(){return{id:this.id,blockId:this.blockId,height:this.height,relays:this.relays,confirmations:this.confirmations,amount:this.amount.toString(),type:this.type,timestamp:this.timestamp,senderPublicKey:this.senderPublicKey,senderId:this.senderId,recipientId:this.recipientId,recipientPublicKey:this.recipientPublicKey,fee:this.fee.toString(),signature:this.signature,signSignature:this.signSignature?this.signSignature:void 0,signatures:this.signatures,asset:this.assetToJSON(),receivedAt:this.receivedAt?this.receivedAt.toISOString():void 0}}isReady(){return this._multisignatureStatus===d.READY||this._multisignatureStatus===d.NONMULTISIGNATURE}getBytes(){return Buffer.concat([this.getBasicBytes(),this._signature?i.hexToBuffer(this._signature):Buffer.alloc(0),this._signSignature?i.hexToBuffer(this._signSignature):Buffer.alloc(0)])}validate(){const e=[...this._validateSchema(),...this.validateAsset()];if(e.length>0)return o.createResponse(this.id,e);const t=this.getBasicBytes(),{valid:r,error:s}=u.validateSignature(this.senderPublicKey,this.signature,t,this.id);!r&&s&&e.push(s);const i=u.validateTransactionId(this.id,this.getBytes());return i&&e.push(i),o.createResponse(this.id,e)}verifyAgainstOtherTransactions(e){const t=this.verifyAgainstTransactions(e);return o.createResponse(this.id,t)}apply(e){const t=e.account.getOrDefault(this.senderId),r=this._verify(t),{errors:i}=this.processMultisignatures(e);i&&r.push(...i);const n=new s(t.balance).sub(this.fee),u=Object.assign({},t,{balance:n.toString(),publicKey:t.publicKey||this.senderPublicKey});e.account.set(u.address,u);const c=this.applyAsset(e);return r.push(...c),this._multisignatureStatus===d.PENDING&&1===r.length&&r[0]instanceof a.TransactionPendingError?{id:this.id,status:o.Status.PENDING,errors:r}:o.createResponse(this.id,r)}undo(e){const t=e.account.getOrDefault(this.senderId),r=new s(t.balance).add(this.fee),i=Object.assign({},t,{balance:r.toString(),publicKey:t.publicKey||this.senderPublicKey}),u=r.lte(n.MAX_TRANSACTION_AMOUNT)?[]:[new a.TransactionError("Invalid balance amount",this.id,".balance",t.balance,r.toString())];e.account.set(i.address,i);const c=this.undoAsset(e);return u.push(...c),o.createResponse(this.id,u)}addMultisignature(e,t){const r=e.account.get(this.senderId);if(r.membersPublicKeys&&!r.membersPublicKeys.includes(t.publicKey))return o.createResponse(this.id,[new a.TransactionError(`Public Key '${t.publicKey}' is not a member for account '${r.address}'.`,this.id)]);if(this.signatures.includes(t.signature))return o.createResponse(this.id,[new a.TransactionError(`Signature '${t.signature}' already present in transaction.`,this.id)]);const{valid:s}=u.validateSignature(t.publicKey,t.signature,this.getBasicBytes(),this.id);if(s)return this.signatures.push(t.signature),this.processMultisignatures(e);const i=s?[]:[new a.TransactionError(`Failed to add signature '${t.signature}'.`,this.id,".signatures")];return o.createResponse(this.id,i)}addVerifiedMultisignature(e){return this.signatures.includes(e)?o.createResponse(this.id,[new a.TransactionError("Failed to add signature.",this.id,".signatures")]):(this.signatures.push(e),o.createResponse(this.id,[]))}processMultisignatures(e){const t=e.account.get(this.senderId),r=this.getBasicBytes(),{status:s,errors:i}=u.verifyMultiSignatures(this.id,t,this.signatures,r);return this._multisignatureStatus=s,this._multisignatureStatus===d.PENDING?{id:this.id,status:o.Status.PENDING,errors:i}:o.createResponse(this.id,i)}isExpired(e=new Date){this.receivedAt||(this.receivedAt=new Date);const t=Math.floor(e.getTime()/1e3),r=this._multisignatureStatus===d.PENDING||this._multisignatureStatus===d.READY?n.UNCONFIRMED_MULTISIG_TRANSACTION_TIMEOUT:n.UNCONFIRMED_TRANSACTION_TIMEOUT;return t-Math.floor(this.receivedAt.getTime()/1e3)>r}sign(e,t){this._signature=void 0,this._signSignature=void 0,this._signature=i.signData(i.hash(this.getBytes()),e),t&&(this._signSignature=i.signData(i.hash(this.getBytes()),t)),this._id=u.getId(this.getBytes())}fromSync(e){const t={id:e.t_id,height:e.b_height,blockId:e.b_id||e.t_blockId,type:parseInt(e.t_type,10),timestamp:parseInt(e.t_timestamp,10),senderPublicKey:e.t_senderPublicKey,requesterPublicKey:e.t_requesterPublicKey,senderId:e.t_senderId,recipientId:e.t_recipientId,recipientPublicKey:e.m_recipientPublicKey||null,amount:e.t_amount,fee:e.t_fee,signature:e.t_signature,signSignature:e.t_signSignature,signatures:e.t_signatures?e.t_signatures.split(","):[],confirmations:parseInt(e.confirmations||0,10),asset:{}};return Object.assign({},t,{asset:this.assetFromSync(e)||{}})}getBasicBytes(){const e=Buffer.alloc(n.BYTESIZES.TYPE,this.type),t=Buffer.alloc(n.BYTESIZES.TIMESTAMP);t.writeIntLE(this.timestamp,0,n.BYTESIZES.TIMESTAMP);const r=i.hexToBuffer(this.senderPublicKey),s=this.recipientId?i.bigNumberToBuffer(this.recipientId.slice(0,-1),n.BYTESIZES.RECIPIENT_ID).slice(0,n.BYTESIZES.RECIPIENT_ID):Buffer.alloc(n.BYTESIZES.RECIPIENT_ID),a=this.amount.toBuffer({endian:"little",size:n.BYTESIZES.AMOUNT});return Buffer.concat([e,t,r,s,a,this.assetToBytes()])}_verify(e){const t=Buffer.concat([this.getBasicBytes(),i.hexToBuffer(this.signature)]);return[u.verifySenderPublicKey(this.id,e,this.senderPublicKey),u.verifySenderId(this.id,e,this.senderId),u.verifyBalance(this.id,e,this.fee),u.verifySecondSignature(this.id,e,this.signSignature,t)].filter(Boolean)}_validateSchema(){const e=this.toJSON();u.validator.validate(c.baseTransaction,e);const t=a.convertToTransactionError(this.id,u.validator.errors);if(!t.find(e=>".senderPublicKey"===e.dataPath)){const e=u.validateSenderIdAndPublicKey(this.id,this.senderId,this.senderPublicKey);e&&t.push(e)}return t}}},4750:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513);t.bigNumberToBuffer=(e,t)=>new s(e).toBuffer({size:t,endian:"big"}),t.bufferToBigNumberString=e=>s.fromBuffer(e).toString(),t.bufferToHex=e=>Buffer.from(e).toString("hex");const i=/^[0-9a-f]+/i;t.hexToBuffer=(e,t="Argument")=>{if("string"!=typeof e)throw new TypeError(t+" must be a string.");const r=(e.match(i)||[])[0];if(!r||r.length!==e.length)throw new TypeError(t+" must be a valid hex string.");if(r.length%2!=0)throw new TypeError(t+" must have a valid length of hex string.");return Buffer.from(r,"hex")}},5006:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(27),i=r(4750),n=e=>{const t=s.createHash("sha256");return t.update(e),t.digest()};t.hash=(e,t)=>{if(Buffer.isBuffer(e))return n(e);if("string"==typeof e&&"string"==typeof t){if(!["utf8","hex"].includes(t))throw new Error("Unsupported string format. Currently only `hex` and `utf8` are supported.");const r="utf8"===t?Buffer.from(e,"utf8"):i.hexToBuffer(e);return n(r)}throw new Error("Unsupported data format. Currently only Buffers or `hex` and `utf8` strings are supported.")}},5007:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4414);t.getTimeFromBlockchainEpoch=e=>{const t=e||(new Date).getTime(),r=s.EPOCH_TIME_MILLISECONDS;return Math.floor((t-r)/1e3)},t.getTimeWithOffset=e=>{const r=(new Date).getTime(),s=e?r+1e3*e:r;return t.getTimeFromBlockchainEpoch(s)}},5008:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(5903);t.checkPublicKeysForDuplicates=s.checkPublicKeysForDuplicates,t.validatePublicKey=s.validatePublicKey,t.validatePublicKeys=s.validatePublicKeys,t.validateKeysgroup=s.validateKeysgroup,t.validateAddress=s.validateAddress,t.validateNonTransferAmount=s.validateNonTransferAmount,t.validateTransferAmount=s.validateTransferAmount,t.validateUsername=s.validateUsername,t.validateFee=s.validateFee,t.isValidInteger=s.isValidInteger,t.isGreaterThanMaxTransactionAmount=s.isGreaterThanMaxTransactionAmount,t.isGreaterThanZero=s.isGreaterThanZero,t.isNumberString=s.isNumberString,t.stringEndsWith=s.stringEndsWith,t.isUnique=s.isUnique,t.isValidNumber=s.isValidNumber,t.isValidTransferData=s.isValidTransferData;var i=r(7622);t.validateTransaction=i.validateTransaction;var n=r(5904);t.validator=n.validator},5337:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(7612),i=r(4638),n=r(275),a=r(4750),o=r(5006);t.getFirstEightBytesReversed=e=>s(Buffer.from(e).slice(0,8)),t.toAddress=e=>{if(!Buffer.from(e).slice(0,8).equals(e))throw new Error("The buffer for Lisk addresses must not have more than 8 bytes");return a.bufferToBigNumberString(e)+"L"},t.getAddressFromPublicKey=e=>{const r=o.hash(e,"hex"),s=t.getFirstEightBytesReversed(r);return t.toAddress(s)},t.convertPublicKeyEd2Curve=i.convertPublicKey,t.convertPrivateKeyEd2Curve=i.convertSecretKey,t.stringifyEncryptedPassphrase=e=>{if("object"!=typeof e||null===e)throw new Error("Encrypted passphrase to stringify must be an object.");const t=e.iterations?e:{salt:e.salt,cipherText:e.cipherText,iv:e.iv,tag:e.tag,version:e.version};return n.stringify(t)};const u=e=>{const t=void 0===e?void 0:parseInt(e,10);if(void 0!==t&&Number.isNaN(t))throw new Error("Could not parse iterations.");return t};t.parseEncryptedPassphrase=e=>{if("string"!=typeof e)throw new Error("Encrypted passphrase to parse must be a string.");const t=n.parse(e),{iterations:r,salt:s,cipherText:i,iv:a,tag:o,version:c}=t;if("string"!=typeof r&&void 0!==r||"string"!=typeof s||"string"!=typeof i||"string"!=typeof a||"string"!=typeof o||"string"!=typeof c)throw new Error("Encrypted passphrase to parse must have only one value per key.");return{iterations:u(r),salt:s,cipherText:i,iv:a,tag:o,version:c}}},5338:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4750),i=r(5337),n=r(5006),a=r(5339);t.getPrivateAndPublicKeyBytesFromPassphrase=e=>{const t=n.hash(e,"utf8"),{publicKeyBytes:r,privateKeyBytes:s}=a.getKeyPair(t);return{privateKeyBytes:s,publicKeyBytes:r}},t.getPrivateAndPublicKeyFromPassphrase=e=>{const{privateKeyBytes:r,publicKeyBytes:i}=t.getPrivateAndPublicKeyBytesFromPassphrase(e);return{privateKey:s.bufferToHex(r),publicKey:s.bufferToHex(i)}},t.getKeys=t.getPrivateAndPublicKeyFromPassphrase,t.getAddressAndPublicKeyFromPassphrase=e=>{const{publicKey:r}=t.getKeys(e);return{address:i.getAddressFromPublicKey(r),publicKey:r}},t.getAddressFromPassphrase=e=>{const{publicKey:r}=t.getKeys(e);return i.getAddressFromPublicKey(r)},t.getAddressFromPrivateKey=e=>{const t=a.getPublicKey(s.hexToBuffer(e)),r=s.bufferToHex(t);return i.getAddressFromPublicKey(r)}},5339:function(e,t,r){"use strict";let s;Object.defineProperty(t,"__esModule",{value:!0});try{if("disable"===process.env.NACL_FAST)throw new Error("Use tweetnacl");s=r(7614)}catch(e){process.env.NACL_FAST="disable",s=r(7616)}t.NACL_SIGN_PUBLICKEY_LENGTH=32,t.NACL_SIGN_SIGNATURE_LENGTH=64,t.box=s.box,t.openBox=s.openBox,t.signDetached=s.signDetached,t.verifyDetached=s.verifyDetached,t.getRandomBytes=s.getRandomBytes,t.getKeyPair=s.getKeyPair,t.getPublicKey=s.getPublicKey},5340:function(e,t,r){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FAIL=0]="FAIL",e[e.OK=1]="OK",e[e.PENDING=2]="PENDING"}(s=t.Status||(t.Status={})),t.createResponse=(e,t)=>({id:e,status:t&&t.length>0?s.FAIL:s.OK,errors:t||[]})},5341:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4414);t.isValidValue=e=>void 0!==e&&(("number"!=typeof e||!Number.isNaN(e))&&!1!==e),t.checkRequiredFields=(e,r)=>{const s=Object.keys(r);return e.forEach(e=>{if(!s.includes(e)||!t.isValidValue(r[e]))throw new Error(e+" is a required parameter.")}),!0},t.getAssetDataForTransferTransaction=({data:e})=>e?Buffer.from(e,"utf8"):Buffer.alloc(0),t.getAssetDataForRegisterSecondSignatureTransaction=({signature:e})=>{t.checkRequiredFields(["publicKey"],e);const{publicKey:r}=e;return i.hexToBuffer(r)},t.getAssetDataForRegisterDelegateTransaction=({delegate:e})=>{t.checkRequiredFields(["username"],e);const{username:r}=e;return Buffer.from(r,"utf8")},t.getAssetDataForCastVotesTransaction=({votes:e})=>{if(!Array.isArray(e))throw new Error("votes parameter must be an Array.");return Buffer.from(e.join(""),"utf8")},t.getAssetDataForRegisterMultisignatureAccountTransaction=({multisignature:e})=>{t.checkRequiredFields(["min","lifetime","keysgroup"],e);const{min:r,lifetime:s,keysgroup:i}=e,n=Buffer.alloc(1,r),a=Buffer.alloc(1,s),o=Buffer.from(i.join(""),"utf8");return Buffer.concat([n,a,o])};t.getAssetDataForCreateDappTransaction=({dapp:e})=>{t.checkRequiredFields(["name","link","type","category"],e);const{name:r,description:s,tags:i,link:n,icon:a,type:o,category:u}=e,c=Buffer.from(r,"utf8"),d=Buffer.from(n,"utf8"),l=Buffer.alloc(4);l.writeIntLE(o,0,4);const p=Buffer.alloc(4);p.writeIntLE(u,0,4);const g=s?Buffer.from(s,"utf8"):Buffer.alloc(0),h=i?Buffer.from(i,"utf8"):Buffer.alloc(0),f=a?Buffer.from(a,"utf8"):Buffer.alloc(0);return Buffer.concat([c,g,h,d,f,l,p])},t.getAssetDataForTransferIntoDappTransaction=({inTransfer:e})=>{t.checkRequiredFields(["dappId"],e);const{dappId:r}=e;return Buffer.from(r,"utf8")},t.getAssetDataForTransferOutOfDappTransaction=({outTransfer:e})=>{t.checkRequiredFields(["dappId","transactionId"],e);const{dappId:r,transactionId:s}=e,i=Buffer.from(r,"utf8"),n=Buffer.from(s,"utf8");return Buffer.concat([i,n])};const a={0:t.getAssetDataForTransferTransaction,1:t.getAssetDataForRegisterSecondSignatureTransaction,2:t.getAssetDataForRegisterDelegateTransaction,3:t.getAssetDataForCastVotesTransaction,4:t.getAssetDataForRegisterMultisignatureAccountTransaction,5:t.getAssetDataForCreateDappTransaction,6:t.getAssetDataForTransferIntoDappTransaction,7:t.getAssetDataForTransferOutOfDappTransaction};t.getAssetBytes=e=>a[e.type](e.asset);const o=["type","timestamp","senderPublicKey","amount"];t.checkTransaction=e=>{t.checkRequiredFields(o,e);const{data:r}=e.asset;if(r&&r.length>n.BYTESIZES.DATA)throw new Error(`Transaction asset data exceeds size of ${n.BYTESIZES.DATA}.`);return!0},t.getTransactionBytes=e=>{t.checkTransaction(e);const{type:r,timestamp:a,senderPublicKey:o,recipientId:u,amount:c,signature:d,signSignature:l}=e,p=Buffer.alloc(n.BYTESIZES.TYPE,r),g=Buffer.alloc(n.BYTESIZES.TIMESTAMP);g.writeIntLE(a,0,n.BYTESIZES.TIMESTAMP);const h=i.hexToBuffer(o),f=u?i.bigNumberToBuffer(u.slice(0,-1),n.BYTESIZES.RECIPIENT_ID):Buffer.alloc(n.BYTESIZES.RECIPIENT_ID),y=new s(c);if(y.lt(0))throw new Error("Transaction amount must not be negative.");if(y.gt(new s(n.MAX_TRANSACTION_AMOUNT)))throw new Error("Transaction amount is too large.");const m=y.toBuffer({endian:"little",size:n.BYTESIZES.AMOUNT}),T=t.getAssetBytes(e),b=d?i.hexToBuffer(d):Buffer.alloc(0),E=l?i.hexToBuffer(l):Buffer.alloc(0);return Buffer.concat([p,g,h,f,m,T,b,E])}},5342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transaction={$id:"lisk/transaction",type:"object",required:["type","amount","fee","senderPublicKey","timestamp"],properties:{id:{type:"string"},blockId:{type:"string"},amount:{type:["string","integer"]},fee:{type:["string","integer"]},type:{type:"integer"},timestamp:{type:"integer"},senderId:{type:"string"},senderPublicKey:{type:"string"},recipientId:{type:["string","null"]},recipientPublicKey:{type:["string","null"]},signature:{type:"string"},signSignature:{type:"string"},signatures:{type:"array"},asset:{type:"object"},receivedAt:{type:"string"}}},t.baseTransaction={$id:"lisk/base-transaction",type:"object",required:["id","type","amount","fee","senderPublicKey","timestamp","asset","signature"],properties:{id:{type:"string",format:"id"},blockId:{type:"string",format:"id"},height:{type:"integer",minimum:0},confirmations:{type:"integer",minimum:0},amount:{type:"string",format:"amount"},fee:{type:"string",format:"fee"},type:{type:"integer",minimum:0},timestamp:{type:"integer",minimum:-2147483648,maximum:2147483647},senderId:{type:"string",format:"address"},senderPublicKey:{type:"string",format:"publicKey"},senderSecondPublicKey:{type:"string",format:"publicKey"},recipientId:{type:"string"},recipientPublicKey:{type:"string",format:"emptyOrPublicKey"},signature:{type:"string",format:"signature"},signSignature:{type:"string",format:"signature"},signatures:{type:"array",uniqueItems:!0,items:{type:"string",format:"signature"},minItems:0,maxItems:15},asset:{type:"object"},receivedAt:{type:"string",format:"date-time"}}},t.transferTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{recipientId:{format:"address"},amount:{format:"transferAmount"},asset:{type:"object",properties:{data:{type:"string",format:"transferData",maxLength:64}}}}}}},t.signatureTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{amount:{format:"nonTransferAmount"},asset:{type:"object",required:["signature"],properties:{signature:{type:"object",required:["publicKey"],properties:{publicKey:{type:"string",format:"publicKey"}}}}}}}}},t.delegateTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{amount:{format:"nonTransferAmount"},asset:{type:"object",required:["delegate"],properties:{delegate:{type:"object",required:["username"],properties:{username:{type:"string",maxLength:20}}}}}}}}},t.voteTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{amount:{format:"nonTransferAmount"},asset:{type:"object",required:["votes"],properties:{votes:{type:"array",uniqueSignedPublicKeys:!0,minItems:1,maxItems:33,items:{type:"string",format:"signedPublicKey"}}}}}}}},t.multiTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{amount:{format:"nonTransferAmount"},asset:{type:"object",required:["multisignature"],properties:{multisignature:{type:"object",required:["min","lifetime","keysgroup"],properties:{min:{type:"integer",minimum:1,maximum:15},lifetime:{type:"integer",minimum:1,maximum:72},keysgroup:{type:"array",uniqueItems:!0,minItems:1,maxItems:15,items:{type:"string",format:"additionPublicKey"}}}}}}}}}},t.dappTransaction={$merge:{source:{$ref:"lisk/base-transaction"},with:{properties:{amount:{format:"nonTransferAmount"},asset:{type:"object",required:["dapp"],properties:{dapp:{type:"object",required:["name","type","category","link"],properties:{icon:{type:"string"},category:{type:"integer"},type:{type:"integer"},link:{type:"string"},tags:{type:"string"},description:{type:"string"},name:{type:"string"}}}}}}}}}},5346:function(e,t,r){"use strict";var s=this&&this.__rest||function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&(r[s[i]]=e[s[i]])}return r};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4413),n=r(4491),a=r(5900);t.multiSignTransaction=(e,t)=>{const{signature:r,signSignature:n}=e,o=s(e,["signature","signSignature"]),u=a.getTransactionHash(o);return i.signData(u,t)},t.validateSignature=(e,t,r,s)=>{const a=i.hash(r),o=i.verifyData(a,t,e);return{valid:o,error:o?void 0:new n.TransactionError("Failed to validate signature "+t,s,".signature")}},t.signaturesAreUnique=e=>[...new Set(e)].length===e.length,t.checkPublicKeySignatureUniqueness=(e,r,s,i)=>{const n=new Set,a=new Set;return e.forEach(e=>{r.forEach(r=>{if(n.has(e)||a.has(r))return;const{valid:o}=t.validateSignature(e,r,s,i);o&&(n.add(e),a.add(r))})}),a},t.validateMultisignatures=(e,r,s,i,a)=>{if(!t.signaturesAreUnique(r))return{valid:!1,errors:[new n.TransactionError("Encountered duplicate signature in transaction",a,".signatures")]};const o=t.checkPublicKeySignatureUniqueness(e,r,i,a),u=r.filter(e=>!o.has(e));return r.length<s?{valid:!1,errors:[new n.TransactionPendingError("Missing signatures",a,".signatures")]}:{valid:o.size>=s&&0===u.length,errors:u.length>0?u.map(e=>new n.TransactionError("Failed to validate signature "+e,a,".signatures")):[]}},t.signTransaction=(e,t)=>{const r=a.getTransactionHash(e);return i.signData(r,t)},t.secondSignTransaction=(e,r)=>Object.assign({},e,{signSignature:t.signTransaction(e,r)}),t.verifyTransaction=(e,r)=>{if(!e.signature)throw new Error("Cannot verify transaction without signature.");if(e.signSignature&&!r)throw new Error("Cannot verify signSignature without secondPublicKey.");const{signature:n,signSignature:o}=e,u=s(e,["signature","signSignature"]),c=e.signSignature?Object.assign({},u,{signature:n}):u,d=a.getTransactionHash(c),l=e.signSignature&&r?r:e.senderPublicKey,p=e.signSignature?e.signSignature:e.signature,g=i.verifyData(d,p,l);return e.signSignature?g&&t.verifyTransaction(c):g}},5898:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIGNED_MESSAGE_PREFIX="Lisk Signed Message:\n"},5899:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4622),a=r(4414),o=r(4491),u=r(4452);t.transferAssetFormatSchema={type:"object",properties:{data:{type:"string",format:"transferData",maxLength:64}}};class TransferTransaction extends n.BaseTransaction{constructor(e){super(e);const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{}}assetToBytes(){const{data:e}=this.asset;return e?Buffer.from(e,"utf8"):Buffer.alloc(0)}assetToJSON(){return this.asset}async prepare(e){await e.account.cache([{address:this.senderId},{address:this.recipientId}])}verifyAgainstTransactions(e){return[]}validateAsset(){u.validator.validate(t.transferAssetFormatSchema,this.asset);const e=o.convertToAssetError(this.id,u.validator.errors);0!==this.type&&e.push(new o.TransactionError("Invalid type",this.id,".type",this.type,0)),u.validateTransferAmount(this.amount.toString())||e.push(new o.TransactionError("Amount must be a valid number in string format.",this.id,".amount",this.amount.toString())),this.fee.eq(a.TRANSFER_FEE)||e.push(new o.TransactionError("Fee must be equal to "+a.TRANSFER_FEE,this.id,".fee",this.fee.toString(),a.TRANSFER_FEE)),this.recipientId||e.push(new o.TransactionError("`recipientId` must be provided.",this.id,".recipientId"));try{u.validateAddress(this.recipientId)}catch(t){e.push(new o.TransactionError(t.message,this.id,".recipientId",this.recipientId))}if(this.recipientPublicKey){const t=i.getAddressFromPublicKey(this.recipientPublicKey);this.recipientId!==t&&e.push(new o.TransactionError("recipientId does not match recipientPublicKey.",this.id,".recipientId",this.recipientId,t))}return e}applyAsset(e){const t=[],r=e.account.get(this.senderId),i=u.verifyAmountBalance(this.id,r,this.amount,this.fee);i&&t.push(i);const n=new s(r.balance).sub(this.amount),c=Object.assign({},r,{balance:n.toString()});e.account.set(c.address,c);const d=e.account.getOrDefault(this.recipientId),l=new s(d.balance).add(this.amount);l.gt(a.MAX_TRANSACTION_AMOUNT)&&t.push(new o.TransactionError("Invalid amount",this.id,".amount",this.amount.toString()));const p=Object.assign({},d,{balance:l.toString()});return e.account.set(p.address,p),t}undoAsset(e){const t=[],r=e.account.get(this.senderId),i=new s(r.balance).add(this.amount);i.gt(a.MAX_TRANSACTION_AMOUNT)&&t.push(new o.TransactionError("Invalid amount",this.id,".amount",this.amount.toString()));const n=Object.assign({},r,{balance:i.toString()});e.account.set(n.address,n);const c=e.account.getOrDefault(this.recipientId),d=u.verifyBalance(this.id,c,this.amount);d&&t.push(d);const l=new s(c.balance).sub(this.amount),p=Object.assign({},c,{balance:l.toString()});return e.account.set(p.address,p),t}assetFromSync(e){if(e.tf_data){return{data:e.tf_data.toString("utf8")}}}}t.TransferTransaction=TransferTransaction},5900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5341);t.getTransactionHash=e=>{const t=i.getTransactionBytes(e);return s.hash(t)}},5901:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(4491),n=r(5341);t.getId=e=>{const t=s.hash(e),r=s.getFirstEightBytesReversed(t);return s.bufferToBigNumberString(r)},t.validateTransactionId=(e,r)=>{const s=t.getId(r);return e!==s?new i.TransactionError("Invalid transaction id",e,".id",e,s):void 0},t.getTransactionId=e=>{const t=n.getTransactionBytes(e),r=s.hash(t),i=s.getFirstEightBytesReversed(r);return s.bufferToBigNumberString(i)}},5902:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4414),n=r(5008),a=e=>(e.split(".")[1]||"").length;t.convertBeddowsToLSK=e=>{if("string"!=typeof e)throw new Error("Cannot convert non-string amount");if(a(e))throw new Error("Beddows amount should not have decimal points");const t=new s(e);if(n.isGreaterThanMaxTransactionAmount(t))throw new Error("Beddows amount out of range");return t.div(i.FIXED_POINT).toString(10)},t.convertLSKToBeddows=e=>{if("string"!=typeof e)throw new Error("Cannot convert non-string amount");if(a(e)>8)throw new Error("LSK amount has too many decimal points");const t=new s(e).mul(i.FIXED_POINT);if(n.isGreaterThanMaxTransactionAmount(t))throw new Error("LSK amount out of range");return t.toString()},t.prependPlusToPublicKeys=e=>e.map(e=>"+"+e),t.prependMinusToPublicKeys=e=>e.map(e=>"-"+e)},5903:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4414);t.validatePublicKey=e=>{if(i.hexToBuffer(e).length!==n.MAX_PUBLIC_KEY_LENGTH)throw new Error(`Public key ${e} length differs from the expected 32 bytes for a public key.`);return!0},t.isNullByteIncluded=e=>new RegExp("\\0|\\U00000000").test(e),t.validateUsername=e=>!t.isNullByteIncluded(e)&&(e===e.trim().toLowerCase()&&(!/^[0-9]{1,21}[L|l]$/g.test(e)&&!!/^[a-z0-9!@$&_.]+$/g.test(e))),t.validateSignature=e=>/^[a-f0-9]{128}$/i.test(e),t.checkPublicKeysForDuplicates=e=>e.every((t,r)=>{if(e.slice(r+1).includes(t))throw new Error(`Duplicated public key: ${e[r]}.`);return!0}),t.stringEndsWith=(e,t)=>t.some(t=>e.endsWith(t)),t.validatePublicKeys=e=>e.every(t.validatePublicKey)&&t.checkPublicKeysForDuplicates(e),t.validateKeysgroup=e=>{if(e.length<n.MULTISIGNATURE_MIN_KEYSGROUP||e.length>n.MULTISIGNATURE_MAX_KEYSGROUP)throw new Error(`Expected between ${n.MULTISIGNATURE_MIN_KEYSGROUP} and ${n.MULTISIGNATURE_MAX_KEYSGROUP} public keys in the keysgroup.`);return t.validatePublicKeys(e)};t.validateAddress=e=>{if(e.length<2||e.length>22)throw new Error("Address length does not match requirements. Expected between 2 and 22 characters.");if("L"!==e[e.length-1])throw new Error('Address format does not match requirements. Expected "L" at the end.');if(e.includes("."))throw new Error("Address format does not match requirements. Address includes invalid character: `.`.");const t=e.slice(0,-1),r=new s(t);if(r.gt(new s(n.MAX_ADDRESS_NUMBER)))throw new Error("Address format does not match requirements. Address out of maximum range.");if(t!==r.toString(10))throw new Error("Address string format does not match it's number representation.");return!0},t.isGreaterThanZero=e=>e.cmp(0)>0,t.isGreaterThanMaxTransactionAmount=e=>e.gt(new s(n.MAX_TRANSACTION_AMOUNT)),t.isGreaterThanMaxTransactionId=e=>e.gt(new s(n.MAX_TRANSACTION_ID)),t.isNumberString=e=>"string"==typeof e&&/^[0-9]+$/g.test(e),t.validateNonTransferAmount=e=>t.isNumberString(e)&&"0"===e,t.validateTransferAmount=e=>t.isNumberString(e)&&t.isGreaterThanZero(new s(e))&&!t.isGreaterThanMaxTransactionAmount(new s(e)),t.isValidTransferData=e=>Buffer.byteLength(e,"utf8")<=n.MAX_TRANSFER_ASSET_DATA_LENGTH,t.validateFee=e=>t.isNumberString(e)&&t.isGreaterThanZero(new s(e))&&!t.isGreaterThanMaxTransactionAmount(new s(e)),t.isValidInteger=e=>"number"==typeof e&&Math.floor(e)===e,t.isUnique=e=>[...new Set(e)].length===e.length,t.isValidNumber=e=>"number"==typeof e||"string"==typeof e&&t.isNumberString(e)},5904:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(7623),n=r(7654),a=r(5342),o=r(5903);t.validator=new i({allErrors:!0,removeAdditional:"all"}),n(t.validator),t.validator.addFormat("signature",o.validateSignature),t.validator.addFormat("id",e=>o.isNumberString(e)&&!o.isGreaterThanMaxTransactionId(new s(e))),t.validator.addFormat("address",e=>{try{return o.validateAddress(e),!0}catch(e){return!1}}),t.validator.addFormat("amount",o.isNumberString),t.validator.addFormat("transferAmount",o.validateTransferAmount),t.validator.addFormat("nonTransferAmount",o.validateNonTransferAmount),t.validator.addFormat("transferData",e=>!o.isNullByteIncluded(e)&&o.isValidTransferData(e)),t.validator.addFormat("fee",o.validateFee),t.validator.addFormat("emptyOrPublicKey",e=>{if(null===e||""===e)return!0;try{return o.validatePublicKey(e),!0}catch(e){return!1}}),t.validator.addFormat("publicKey",e=>{try{return o.validatePublicKey(e),!0}catch(e){return!1}}),t.validator.addFormat("signedPublicKey",e=>{try{const t=e[0];if("+"!==t&&"-"!==t)return!1;const r=e.slice(1);return o.validatePublicKey(r),!0}catch(e){return!1}}),t.validator.addFormat("additionPublicKey",e=>{if("+"!==e[0])return!1;try{const t=e.slice(1);return o.validatePublicKey(t),!0}catch(e){return!1}}),t.validator.addFormat("username",o.validateUsername),t.validator.addFormat("noNullByte",e=>!o.isNullByteIncluded(e)),t.validator.addKeyword("uniqueSignedPublicKeys",{type:"array",compile:()=>e=>new Set(e.filter(e=>"string"==typeof e).map(e=>e.slice(1))).size===e.length}),t.validator.addSchema(a.baseTransaction)},5917:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5346),n=r(5007),a=r(5901);t.prepareTransaction=(e,t,r,o)=>{const u=t?s.getKeys(t).publicKey:void 0,c=n.getTimeWithOffset(o),d=Object.assign({amount:"0",recipientId:"",senderPublicKey:u,timestamp:c},e);if(void 0===d.type)throw new Error("Invalid transaction to process");if(!t)return d;const l=Object.assign({},d,{signature:i.signTransaction(d,t)}),p="string"==typeof r&&1!==d.type?i.secondSignTransaction(l,r):l;return Object.assign({},p,{id:a.getTransactionId(p)})}},5918:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(4622),n=r(4414),a=r(4491),o=r(4452);t.secondSignatureAssetFormatSchema={type:"object",required:["signature"],properties:{signature:{type:"object",required:["publicKey"],properties:{publicKey:{type:"string",format:"publicKey"}}}}};class SecondSignatureTransaction extends i.BaseTransaction{constructor(e){super(e);const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{signature:{}}}assetToBytes(){const{signature:{publicKey:e}}=this.asset;return s.hexToBuffer(e)}assetToJSON(){return this.asset}async prepare(e){await e.account.cache([{address:this.senderId}])}verifyAgainstTransactions(e){return e.filter(e=>e.type===this.type&&e.senderPublicKey===this.senderPublicKey).map(e=>new a.TransactionError("Register second signature only allowed once per account.",e.id,".asset.signature"))}validateAsset(){o.validator.validate(t.secondSignatureAssetFormatSchema,this.asset);const e=a.convertToAssetError(this.id,o.validator.errors);return 1!==this.type&&e.push(new a.TransactionError("Invalid type",this.id,".type",this.type,1)),this.amount.eq(0)||e.push(new a.TransactionError("Amount must be zero for second signature registration transaction",this.id,".amount",this.amount.toString(),"0")),this.fee.eq(n.SIGNATURE_FEE)||e.push(new a.TransactionError("Fee must be equal to "+n.SIGNATURE_FEE,this.id,".fee",this.fee.toString(),n.SIGNATURE_FEE)),this.recipientId&&e.push(new a.TransactionError("RecipientId is expected to be undefined.",this.id,".recipientId",this.recipientId,"")),this.recipientPublicKey&&e.push(new a.TransactionError("RecipientPublicKey is expected to be undefined.",this.id,".recipientPublicKey",this.recipientPublicKey,"")),e}applyAsset(e){const t=[],r=e.account.get(this.senderId);r.secondPublicKey&&t.push(new a.TransactionError("Register second signature only allowed once per account.",this.id,".secondPublicKey"));const s=Object.assign({},r,{secondPublicKey:this.asset.signature.publicKey,secondSignature:1});return e.account.set(s.address,s),t}undoAsset(e){const t=e.account.get(this.senderId),r=Object.assign({},t,{secondPublicKey:null,secondSignature:0});return e.account.set(r.address,r),[]}sign(e){this._signature=void 0,this._signSignature=void 0,this._signature=s.signData(s.hash(this.getBytes()),e),this._id=o.getId(this.getBytes())}assetFromSync(e){if(!e.s_publicKey)return;return{signature:{transactionId:e.t_id,publicKey:e.s_publicKey}}}}t.SecondSignatureTransaction=SecondSignatureTransaction},5919:function(e,t,r){"use strict";var s=this&&this.__rest||function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&(r[s[i]]=e[s[i]])}return r};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4622),n=r(4414),a=r(4491),o=r(4452);t.delegateAssetFormatSchema={type:"object",required:["delegate"],properties:{delegate:{type:"object",required:["username"],properties:{username:{type:"string",minLength:1,maxLength:20,format:"username"}}}}};class DelegateTransaction extends i.BaseTransaction{constructor(e){super(e);const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{delegate:{}},this.containsUniqueData=!0}assetToBytes(){const{delegate:{username:e}}=this.asset;return Buffer.from(e,"utf8")}assetToJSON(){return this.asset}async prepare(e){await e.account.cache([{address:this.senderId},{username:this.asset.delegate.username}])}verifyAgainstTransactions(e){return e.filter(e=>e.type===this.type&&e.senderPublicKey===this.senderPublicKey).map(e=>new a.TransactionError("Register delegate only allowed once per account.",e.id,".asset.delegate"))}validateAsset(){o.validator.validate(t.delegateAssetFormatSchema,this.asset);const e=a.convertToAssetError(this.id,o.validator.errors);return 2!==this.type&&e.push(new a.TransactionError("Invalid type",this.id,".type",this.type,2)),this.amount.eq(0)||e.push(new a.TransactionError("Amount must be zero for delegate registration transaction",this.id,".amount",this.amount.toString(),"0")),this.fee.eq(n.DELEGATE_FEE)||e.push(new a.TransactionError("Fee must be equal to "+n.DELEGATE_FEE,this.id,".fee",this.fee.toString(),n.DELEGATE_FEE)),this.recipientId&&e.push(new a.TransactionError("RecipientId is expected to be undefined",this.id,".recipientId",this.recipientId)),this.recipientPublicKey&&e.push(new a.TransactionError("Invalid recipientPublicKey",this.id,".recipientPublicKey")),e}applyAsset(e){const t=[],r=e.account.get(this.senderId);e.account.find(e=>e.username===this.asset.delegate.username)&&t.push(new a.TransactionError("Username is not unique.",this.id,".asset.delegate.username")),(r.isDelegate||r.username)&&t.push(new a.TransactionError("Account is already a delegate",this.id,".asset.delegate.username"));const s=Object.assign({},r,{username:this.asset.delegate.username,vote:0,isDelegate:1});return e.account.set(s.address,s),t}undoAsset(e){const t=e.account.get(this.senderId),{username:r}=t,i=s(t,["username"]),n=Object.assign({},t,{username:null,vote:0,isDelegate:0});return e.account.set(i.address,n),[]}assetFromSync(e){if(!e.d_username)return;return{delegate:{username:e.d_username,publicKey:e.t_senderPublicKey,address:e.t_senderId}}}}t.DelegateTransaction=DelegateTransaction},5920:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4622),a=r(4414),o=r(4491),u=r(4452),c=r(5008);t.voteAssetFormatSchema={type:"object",required:["votes"],properties:{votes:{type:"array",minItems:1,maxItems:33,items:{type:"string",format:"signedPublicKey"},uniqueSignedPublicKeys:!0}}};class VoteTransaction extends n.BaseTransaction{constructor(e){super(e);const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{},this.containsUniqueData=!0}assetToBytes(){return Buffer.from(this.asset.votes.join(""),"utf8")}assetToJSON(){return this.asset}async prepare(e){const t=this.asset.votes.map(e=>({publicKey:e.slice(1)})),r=[{address:this.senderId},...t];await e.account.cache(r)}verifyAgainstTransactions(e){const t=e.filter(e=>e.senderPublicKey===this.senderPublicKey&&e.type===this.type).map(e=>new VoteTransaction(e)),r=this.asset.votes.map(e=>e.substring(1));return t.reduce((e,t)=>{const s=t.asset.votes.map(e=>e.substring(1)).filter(e=>r.includes(e));return s.length>0?[...e,new o.TransactionError("Transaction includes conflicting votes: "+s.toString(),this.id,".asset.votes")]:e},[])}validateAsset(){c.validator.validate(t.voteAssetFormatSchema,this.asset);const e=o.convertToAssetError(this.id,c.validator.errors);this.amount.eq(new s(0))||e.push(new o.TransactionError("Amount must be zero for vote transaction",this.id,".amount",this.amount.toString(),"0")),3!==this.type&&e.push(new o.TransactionError("Invalid type",this.id,".type",this.type,3));try{c.validateAddress(this.recipientId)}catch(t){e.push(new o.TransactionError("RecipientId must be set for vote transaction",this.id,".recipientId",this.recipientId))}return this.recipientPublicKey&&this.recipientId!==i.getAddressFromPublicKey(this.recipientPublicKey)&&e.push(new o.TransactionError("recipientId does not match recipientPublicKey.",this.id,".recipientId")),this.fee.eq(new s(a.VOTE_FEE))||e.push(new o.TransactionError("Fee must be equal to "+a.VOTE_FEE,this.id,".fee",this.fee.toString(),a.VOTE_FEE)),e}applyAsset(e){const t=[],r=e.account.get(this.senderId),i=u.verifyAmountBalance(this.id,r,this.amount,this.fee);i&&t.push(i);const n=new s(r.balance).sub(new s(this.amount));this.asset.votes.forEach(r=>{const s=r.substring(1),i=e.account.find(e=>e.publicKey===s);i&&(!i||void 0!==i.username&&""!==i.username&&null!==i.username)||t.push(new o.TransactionError(s+" is not a delegate.",this.id,".asset.votes"))});const a=r.votedDelegatesPublicKeys||[];this.asset.votes.forEach(e=>{const r=e.charAt(0),s=e.substring(1);"+"===r&&a.includes(s)?t.push(new o.TransactionError(s+" is already voted.",this.id,".asset.votes")):"-"!==r||a.includes(s)||t.push(new o.TransactionError(s+" is not voted.",this.id,".asset.votes"))});const c=this.asset.votes.filter(e=>"+"===e.charAt(0)).map(e=>e.substring(1)),d=this.asset.votes.filter(e=>"-"===e.charAt(0)).map(e=>e.substring(1)),l=[...r.votedDelegatesPublicKeys||[],...c].filter(e=>!d.includes(e));l.length>101&&t.push(new o.TransactionError(`Vote cannot exceed 101 but has ${l.length}.`,this.id,".asset.votes",l.length.toString(),101));const p=Object.assign({},r,{balance:n.toString(),votedDelegatesPublicKeys:l});return e.account.set(p.address,p),t}undoAsset(e){const t=[],r=e.account.get(this.senderId),i=new s(r.balance).add(new s(this.amount));i.gt(a.MAX_TRANSACTION_AMOUNT)&&t.push(new o.TransactionError("Invalid amount",this.id,".amount",this.amount.toString()));const n=this.asset.votes.filter(e=>"+"===e.charAt(0)).map(e=>e.substring(1)),u=this.asset.votes.filter(e=>"-"===e.charAt(0)).map(e=>e.substring(1)),c=[...r.votedDelegatesPublicKeys||[],...u].filter(e=>!n.includes(e));c.length>101&&t.push(new o.TransactionError(`Vote cannot exceed 101 but has ${c.length}.`,this.id,".asset.votes",c.length.toString(),101));const d=Object.assign({},r,{balance:i.toString(),votedDelegatesPublicKeys:c});return e.account.set(d.address,d),t}assetFromSync(e){if(!e.v_votes)return;return{votes:e.v_votes.split(",")}}}t.VoteTransaction=VoteTransaction},5921:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4413),n=r(4622),a=r(4414),o=r(4491),u=r(5340),c=r(4452);t.multisignatureAssetFormatSchema={type:"object",required:["multisignature"],properties:{multisignature:{type:"object",required:["min","lifetime","keysgroup"],properties:{min:{type:"integer",minimum:1,maximum:15},lifetime:{type:"integer",minimum:1,maximum:72},keysgroup:{type:"array",uniqueItems:!0,minItems:1,maxItems:15,items:{type:"string",format:"additionPublicKey"}}}}}};const d=e=>e.map(e=>e.substring(1));class MultisignatureTransaction extends n.BaseTransaction{constructor(e){super(e),this._multisignatureStatus=n.MultisignatureStatus.PENDING;const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{multisignature:{}}}assetToBytes(){const{multisignature:{min:e,lifetime:t,keysgroup:r}}=this.asset,s=Buffer.alloc(1,e),i=Buffer.alloc(1,t),n=Buffer.from(r.join(""),"utf8");return Buffer.concat([s,i,n])}assetToJSON(){return this.asset}async prepare(e){const t=d(this.asset.multisignature.keysgroup).map(e=>({address:i.getAddressFromPublicKey(e)}));await e.account.cache([{address:this.senderId},...t])}verifyAgainstTransactions(e){return e.filter(e=>e.type===this.type&&e.senderPublicKey===this.senderPublicKey).map(e=>new o.TransactionError("Register multisignature only allowed once per account.",e.id,".asset.multisignature"))}validateAsset(){c.validator.validate(t.multisignatureAssetFormatSchema,this.asset);const e=o.convertToAssetError(this.id,c.validator.errors);if(4!==this.type&&e.push(new o.TransactionError("Invalid type",this.id,".type",this.type,4)),this.amount.eq(new s(0))||e.push(new o.TransactionError("Amount must be zero for multisignature registration transaction",this.id,".amount",this.amount.toString(),"0")),e.length>0)return e;const r=new s(a.MULTISIGNATURE_FEE).mul(new s(this.asset.multisignature.keysgroup.length+1));return this.fee.eq(r)||e.push(new o.TransactionError("Fee must be equal to "+r.toString(),this.id,".fee",this.fee.toString(),r.toString())),this.asset.multisignature.min>this.asset.multisignature.keysgroup.length&&e.push(new o.TransactionError("Invalid multisignature min. Must be less than or equal to keysgroup size",this.id,".asset.multisignature.min",this.asset.multisignature.min)),this.recipientId&&e.push(new o.TransactionError("RecipientId is expected to be undefined",this.id,".recipientId",this.recipientId)),this.recipientPublicKey&&e.push(new o.TransactionError("RecipientPublicKey is expected to be undefined",this.id,".recipientPublicKey",this.recipientPublicKey)),e}processMultisignatures(e){const t=this.getBasicBytes(),{valid:r,errors:s}=c.validateMultisignatures(this.asset.multisignature.keysgroup.map(e=>e.substring(1)),this.signatures,this.asset.multisignature.keysgroup.length,t,this.id);return r?(this._multisignatureStatus=n.MultisignatureStatus.READY,u.createResponse(this.id,s)):s&&1===s.length&&s[0]instanceof o.TransactionPendingError?(this._multisignatureStatus=n.MultisignatureStatus.PENDING,{id:this.id,status:u.Status.PENDING,errors:s}):(this._multisignatureStatus=n.MultisignatureStatus.FAIL,u.createResponse(this.id,s))}applyAsset(e){const t=[],r=e.account.get(this.senderId);r.membersPublicKeys&&r.membersPublicKeys.length>0&&t.push(new o.TransactionError("Register multisignature only allowed once per account.",this.id,".signatures")),this.asset.multisignature.keysgroup.includes("+"+r.publicKey)&&t.push(new o.TransactionError("Invalid multisignature keysgroup. Can not contain sender",this.id,".signatures"));const s=Object.assign({},r,{membersPublicKeys:d(this.asset.multisignature.keysgroup),multiMin:this.asset.multisignature.min,multiLifetime:this.asset.multisignature.lifetime});return e.account.set(s.address,s),((e,t)=>{t.forEach(t=>{const r=i.getAddressFromPublicKey(t),s=e.account.getOrDefault(r),n=Object.assign({},s,{publicKey:s.publicKey||t});e.account.set(s.address,n)})})(e,s.membersPublicKeys),t}undoAsset(e){const t=e.account.get(this.senderId),r=Object.assign({},t,{membersPublicKeys:[],multiMin:0,multiLifetime:0});return e.account.set(r.address,r),[]}addMultisignature(e,t){if(!this.asset.multisignature.keysgroup.map(e=>e.slice(1)).includes(t.publicKey))return u.createResponse(this.id,[new o.TransactionError(`Public Key '${t.publicKey}' is not a member.`,this.id)]);if(this.signatures.includes(t.signature))return u.createResponse(this.id,[new o.TransactionError("Encountered duplicate signature in transaction",this.id)]);const{valid:r}=c.validateSignature(t.publicKey,t.signature,this.getBasicBytes(),this.id);if(r)return this.signatures.push(t.signature),this.processMultisignatures(e);const s=r?[]:[new o.TransactionError(`Failed to add signature ${t.signature}.`,this.id,".signatures")];return u.createResponse(this.id,s)}assetFromSync(e){if(!e.m_keysgroup)return;return{multisignature:{min:e.m_min,lifetime:e.m_lifetime,keysgroup:"string"==typeof e.m_keysgroup?e.m_keysgroup.split(","):e.m_keysgroup}}}}t.MultisignatureTransaction=MultisignatureTransaction},5922:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4622),i=r(4414),n=r(4491),a=r(5008);t.dappAssetFormatSchema={type:"object",required:["dapp"],properties:{dapp:{type:"object",required:["name","type","category"],properties:{icon:{type:"string",format:"uri",maxLength:2e3},category:{type:"integer",minimum:0,maximum:8},type:{type:"integer",minimum:0,maximum:1},link:{type:"string",format:"uri",minLength:0,maxLength:2e3},tags:{type:"string",format:"noNullByte",maxLength:160},description:{type:"string",format:"noNullByte",maxLength:160},name:{type:"string",format:"noNullByte",minLength:1,maxLength:32}}}}};class DappTransaction extends s.BaseTransaction{constructor(e){super(e);const t="object"==typeof e&&null!==e?e:{};this.asset=t.asset||{dapp:{}},this.containsUniqueData=!0,this.asset&&this.asset.dapp&&"object"==typeof this.asset.dapp&&(this.asset.dapp.description=this.asset.dapp.description||void 0,this.asset.dapp.icon=this.asset.dapp.icon||void 0,this.asset.dapp.tags=this.asset.dapp.tags||void 0)}assetToBytes(){const{name:e,description:t,tags:r,link:s,icon:i,type:n,category:a}=this.asset.dapp,o=Buffer.from(e,"utf8"),u=s?Buffer.from(s,"utf8"):Buffer.alloc(0),c=Buffer.alloc(4);c.writeIntLE(n,0,4);const d=Buffer.alloc(4);d.writeIntLE(a,0,4);const l=t?Buffer.from(t,"utf8"):Buffer.alloc(0),p=r?Buffer.from(r,"utf8"):Buffer.alloc(0),g=i?Buffer.from(i,"utf8"):Buffer.alloc(0);return Buffer.concat([o,l,p,u,g,c,d])}assetToJSON(){return this.asset}async prepare(e){await e.account.cache([{address:this.senderId}]),await e.transaction.cache([{dapp_name:this.asset.dapp.name},{dapp_link:this.asset.dapp.link}])}verifyAgainstTransactions(e){const t=e.filter(e=>e.type===this.type),r=t.filter(e=>"dapp"in e.asset&&e.asset.dapp.name===this.asset.dapp.name).length>0?[new n.TransactionError("Dapp with the same name already exists.",this.id,".asset.dapp.name",this.asset.dapp.name)]:[];return t.filter(e=>"dapp"in e.asset&&this.asset.dapp.link&&this.asset.dapp.link===e.asset.dapp.link).length>0&&r.push(new n.TransactionError("Dapp with the same link already exists.",this.id,".asset.dapp.link",this.asset.dapp.link)),r}validateAsset(){a.validator.validate(t.dappAssetFormatSchema,this.asset);const e=n.convertToAssetError(this.id,a.validator.errors);5!==this.type&&e.push(new n.TransactionError("Invalid type",this.id,".type",this.type,5)),this.amount.eq(0)||e.push(new n.TransactionError("Amount must be zero for dapp transaction",this.id,".amount",this.amount.toString(),"0")),this.recipientId&&e.push(new n.TransactionError("RecipientId is expected to be undefined",this.id,".recipientId")),this.fee.eq(i.DAPP_FEE)||e.push(new n.TransactionError("Fee must be equal to "+i.DAPP_FEE,this.id,".fee",this.fee.toString(),i.DAPP_FEE));const r=[".zip"];if(e.length>0)return e;this.asset.dapp.link&&!a.stringEndsWith(this.asset.dapp.link,r)&&e.push(new n.TransactionError("Dapp icon must have suffix "+r.toString(),this.id,".asset.dapp.link",this.asset.dapp.link));const s=[".png",".jpeg",".jpg"];if(this.asset.dapp.icon&&!a.stringEndsWith(this.asset.dapp.icon,s)&&e.push(new n.TransactionError("Dapp icon must have suffix of one of "+s.toString(),this.id,".asset.dapp.icon",this.asset.dapp.icon)),this.asset.dapp.tags){const t=this.asset.dapp.tags.split(",").map(e=>e.trim()).sort();t.length!==new Set(t).size&&e.push(new n.TransactionError("Dapp tags must have unique set",this.id,".asset.dapp.tags",this.asset.dapp.tags))}return e}applyAsset(e){const t=[];e.transaction.find(e=>5===e.type&&e.id!==this.id&&e.asset.dapp&&e.asset.dapp.name===this.asset.dapp.name)&&t.push(new n.TransactionError("Application name already exists: "+this.asset.dapp.name,this.id,this.asset.dapp.name));return e.transaction.find(e=>5===e.type&&e.id!==this.id&&e.asset.dapp&&e.asset.dapp.link===this.asset.dapp.link)&&t.push(new n.TransactionError("Application link already exists: "+this.asset.dapp.link,this.id,this.asset.dapp.link)),t}undoAsset(e){return[]}assetFromSync(e){if(!e.dapp_name)return;return{dapp:{name:e.dapp_name,description:e.dapp_description,tags:e.dapp_tags,type:e.dapp_type,link:e.dapp_link,category:e.dapp_category,icon:e.dapp_icon}}}}t.DappTransaction=DappTransaction},7613:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(27),i=r(4750),n=r(5337),a=r(5338),o=r(5339),u=1e6;t.encryptMessageWithPassphrase=(e,t,r)=>{const{privateKeyBytes:s}=a.getPrivateAndPublicKeyBytesFromPassphrase(t),u=Buffer.from(n.convertPrivateKeyEd2Curve(s)),c=i.hexToBuffer(r),d=Buffer.from(e,"utf8"),l=o.getRandomBytes(24),p=n.convertPublicKeyEd2Curve(c);if(null===p)throw new Error("given public key is not a valid Ed25519 public key");const g=Buffer.from(p),h=o.box(d,l,g,u);return{nonce:i.bufferToHex(l),encryptedMessage:i.bufferToHex(h)}},t.decryptMessageWithPassphrase=(e,t,r,s)=>{const{privateKeyBytes:u}=a.getPrivateAndPublicKeyBytesFromPassphrase(r),c=Buffer.from(n.convertPrivateKeyEd2Curve(u)),d=i.hexToBuffer(s),l=i.hexToBuffer(e),p=i.hexToBuffer(t),g=n.convertPublicKeyEd2Curve(d);if(null===g)throw new Error("given public key is not a valid Ed25519 public key");const h=Buffer.from(g);try{const e=o.openBox(l,p,h,c);return Buffer.from(e).toString()}catch(e){if(e.message.match(/bad nonce size|nonce must be a buffer of size crypto_box_NONCEBYTES/))throw new Error("Expected nonce to be 24 bytes.");throw new Error("Something went wrong during decryption. Is this the full encrypted message?")}};const c=(e,t,r)=>s.pbkdf2Sync(e,t,r,32,"sha256");t.encryptPassphraseWithPassword=(e,t,r=u)=>{const i=s.randomBytes(12),n=s.randomBytes(16),a=c(t,n,r),o=s.createCipheriv("aes-256-gcm",a,i),d=o.update(e,"utf8"),l=Buffer.concat([d,o.final()]),p=o.getAuthTag();return{iterations:r,cipherText:l.toString("hex"),iv:i.toString("hex"),salt:n.toString("hex"),tag:p.toString("hex"),version:"1"}},t.decryptPassphraseWithPassword=(e,t)=>{const{iterations:r=u,cipherText:n,iv:a,salt:o,tag:d}=e,l=(e=>{const t=i.hexToBuffer(e,"Tag");if(16!==t.length)throw new Error("Tag must be 16 bytes.");return t})(d),p=c(t,i.hexToBuffer(o,"Salt"),r),g=s.createDecipheriv("aes-256-gcm",p,i.hexToBuffer(a,"IV"));g.setAuthTag(l);const h=g.update(i.hexToBuffer(n,"Cipher text"));return Buffer.concat([h,g.final()]).toString()}},7614:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(7615);t.box=(e,t,r,i)=>{const n=Buffer.alloc(e.length+s.crypto_box_MACBYTES);return s.crypto_box_easy(n,e,t,r,i),n},t.openBox=(e,t,r,i)=>{const n=Buffer.alloc(e.length-s.crypto_box_MACBYTES);if(!s.crypto_box_open_easy(n,e,t,r,i))throw new Error("Failed to decrypt message");return n},t.signDetached=(e,t)=>{const r=Buffer.alloc(s.crypto_sign_BYTES);return s.crypto_sign_detached(r,e,t),r},t.verifyDetached=(e,t,r)=>s.crypto_sign_verify_detached(t,e,r),t.getRandomBytes=e=>{const t=Buffer.alloc(e);return s.randombytes_buf(t),t},t.getKeyPair=e=>{const t=Buffer.alloc(s.crypto_sign_PUBLICKEYBYTES),r=Buffer.alloc(s.crypto_sign_SECRETKEYBYTES);return s.crypto_sign_seed_keypair(t,r,e),{publicKeyBytes:t,privateKeyBytes:r}},t.getPublicKey=e=>{const t=Buffer.alloc(s.crypto_sign_PUBLICKEYBYTES),r=Buffer.alloc(s.crypto_sign_SECRETKEYBYTES);return s.crypto_sign_seed_keypair(t,r,e),t}},7616:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(79);t.box=(e,t,r,i)=>Buffer.from(s.box(e,t,r,i)),t.openBox=(e,t,r,i)=>{const n=s.box.open(e,t,r,i);if(null===n)throw new Error("Failed to decrypt message");return Buffer.from(n)},t.signDetached=(e,t)=>Buffer.from(s.sign.detached(e,t)),t.verifyDetached=s.sign.detached.verify,t.getRandomBytes=e=>Buffer.from(s.randomBytes(e)),t.getKeyPair=e=>{const{publicKey:t,secretKey:r}=s.sign.keyPair.fromSeed(e);return{privateKeyBytes:Buffer.from(r),publicKeyBytes:Buffer.from(t)}};t.getPublicKey=e=>{const{publicKey:t}=s.sign.keyPair.fromSeed(e.slice(0,32));return Buffer.from(t)}},7617:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(315),i=r(4750),n=r(5898),a=r(5006),o=r(5338),u=r(5339),c=e=>`-----${e}-----`,d=c("BEGIN LISK SIGNED MESSAGE"),l=c("MESSAGE"),p=c("PUBLIC KEY"),g=c("SECOND PUBLIC KEY"),h=c("SIGNATURE"),f=c("SECOND SIGNATURE"),y=c("END LISK SIGNED MESSAGE"),m=Buffer.from(n.SIGNED_MESSAGE_PREFIX,"utf8"),T=s.encode(n.SIGNED_MESSAGE_PREFIX.length);t.digestMessage=e=>{const t=Buffer.from(e,"utf8"),r=s.encode(e.length),i=Buffer.concat([T,m,r,t]);return a.hash(a.hash(i))},t.signMessageWithPassphrase=(e,r)=>{const s=t.digestMessage(e),{privateKeyBytes:n,publicKeyBytes:a}=o.getPrivateAndPublicKeyBytesFromPassphrase(r),c=u.signDetached(s,n);return{message:e,publicKey:i.bufferToHex(a),signature:i.bufferToHex(c)}},t.verifyMessageWithPublicKey=({message:e,publicKey:r,signature:s})=>{const n=t.digestMessage(e),a=i.hexToBuffer(s),o=i.hexToBuffer(r);if(o.length!==u.NACL_SIGN_PUBLICKEY_LENGTH)throw new Error(`Invalid publicKey, expected ${u.NACL_SIGN_PUBLICKEY_LENGTH}-byte publicKey`);if(a.length!==u.NACL_SIGN_SIGNATURE_LENGTH)throw new Error(`Invalid signature length, expected ${u.NACL_SIGN_SIGNATURE_LENGTH}-byte signature`);return u.verifyDetached(n,a,o)},t.signMessageWithTwoPassphrases=(e,r,s)=>{const n=t.digestMessage(e),a=o.getPrivateAndPublicKeyBytesFromPassphrase(r),c=o.getPrivateAndPublicKeyBytesFromPassphrase(s),d=u.signDetached(n,a.privateKeyBytes),l=u.signDetached(n,c.privateKeyBytes);return{message:e,publicKey:i.bufferToHex(a.publicKeyBytes),secondPublicKey:i.bufferToHex(c.publicKeyBytes),signature:i.bufferToHex(d),secondSignature:i.bufferToHex(l)}},t.verifyMessageWithTwoPublicKeys=({message:e,signature:r,secondSignature:s,publicKey:n,secondPublicKey:a})=>{const o=t.digestMessage(e),c=i.hexToBuffer(r),d=i.hexToBuffer(s),l=i.hexToBuffer(n),p=i.hexToBuffer(a);if(c.length!==u.NACL_SIGN_SIGNATURE_LENGTH)throw new Error(`Invalid first signature length, expected ${u.NACL_SIGN_SIGNATURE_LENGTH}-byte signature`);if(d.length!==u.NACL_SIGN_SIGNATURE_LENGTH)throw new Error(`Invalid second signature length, expected ${u.NACL_SIGN_SIGNATURE_LENGTH}-byte signature`);if(l.length!==u.NACL_SIGN_PUBLICKEY_LENGTH)throw new Error(`Invalid first publicKey, expected ${u.NACL_SIGN_PUBLICKEY_LENGTH}-byte publicKey`);if(p.length!==u.NACL_SIGN_PUBLICKEY_LENGTH)throw new Error(`Invalid second publicKey, expected ${u.NACL_SIGN_PUBLICKEY_LENGTH}-byte publicKey`);return u.verifyDetached(o,c,l)&&u.verifyDetached(o,d,p)},t.printSignedMessage=({message:e,signature:t,publicKey:r,secondSignature:s,secondPublicKey:i})=>[d,l,e,p,r,i?g:void 0,i,h,t,s?f:void 0,s,y].filter(Boolean).join("\n"),t.signAndPrintMessage=(e,r,s)=>{const i=s?t.signMessageWithTwoPassphrases(e,r,s):t.signMessageWithPassphrase(e,r);return t.printSignedMessage(i)},t.signDataWithPrivateKey=(e,t)=>{const r=u.signDetached(e,t);return i.bufferToHex(r)},t.signDataWithPassphrase=(e,r)=>{const{privateKeyBytes:s}=o.getPrivateAndPublicKeyBytesFromPassphrase(r);return t.signDataWithPrivateKey(e,s)},t.signData=t.signDataWithPassphrase,t.verifyData=(e,t,r)=>u.verifyDetached(e,i.hexToBuffer(t),i.hexToBuffer(r))},7618:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(7619);t.transfer=i.transfer;const n=r(5899);t.TransferTransaction=n.TransferTransaction;const a=r(7673);t.registerSecondPassphrase=a.registerSecondPassphrase;const o=r(5918);t.SecondSignatureTransaction=o.SecondSignatureTransaction;const u=r(5919);t.DelegateTransaction=u.DelegateTransaction;const c=r(7674);t.registerDelegate=c.registerDelegate;const d=r(7675);t.castVotes=d.castVotes;const l=r(5920);t.VoteTransaction=l.VoteTransaction;const p=r(5921);t.MultisignatureTransaction=p.MultisignatureTransaction;const g=r(7676);t.registerMultisignature=g.registerMultisignature;const h=r(7677);t.createDapp=h.createDapp;const f=r(5922);t.DappTransaction=f.DappTransaction;const y=r(4622);t.BaseTransaction=y.BaseTransaction;const m=r(4414);t.constants=m;const T=r(7678);t.createSignatureObject=T.createSignatureObject;const b=r(4491);t.convertToAssetError=b.convertToAssetError,t.TransactionError=b.TransactionError;const E=r(5340);t.Status=E.Status;const v=r(4452),S={BN:s,convertBeddowsToLSK:v.convertBeddowsToLSK,convertLSKToBeddows:v.convertLSKToBeddows,isValidInteger:v.isValidInteger,multiSignTransaction:v.multiSignTransaction,prependMinusToPublicKeys:v.prependMinusToPublicKeys,prependPlusToPublicKeys:v.prependPlusToPublicKeys,stringEndsWith:v.stringEndsWith,validator:v.validator,validateAddress:v.validateAddress,validateKeysgroup:v.validateKeysgroup,validatePublicKey:v.validatePublicKey,validatePublicKeys:v.validatePublicKeys,verifyAmountBalance:v.verifyAmountBalance,validateNonTransferAmount:v.validateNonTransferAmount,validateTransferAmount:v.validateTransferAmount,signTransaction:v.signTransaction,getTransactionBytes:v.getTransactionBytes,getTransactionId:v.getTransactionId,verifyTransaction:v.verifyTransaction,checkPublicKeysForDuplicates:v.checkPublicKeysForDuplicates,getTransactionHash:v.getTransactionHash,prepareTransaction:v.prepareTransaction,signRawTransaction:v.signRawTransaction,validateFee:v.validateFee,validateTransaction:v.validateTransaction};t.utils=S},7619:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5899),n=r(4414),a=r(4452);t.transfer=e=>{(({amount:e,recipientId:t,recipientPublicKey:r,data:i})=>{if(!a.validateTransferAmount(e))throw new Error("Amount must be a valid number in string format.");if(!t&&!r)throw new Error("Either recipientId or recipientPublicKey must be provided.");if(void 0!==t&&a.validateAddress(t),void 0!==r&&a.validatePublicKey(r),t&&r&&t!==s.getAddressFromPublicKey(r))throw new Error("recipientId does not match recipientPublicKey.");if(i&&i.length>0){if("string"!=typeof i)throw new Error("Invalid encoding in transaction data. Data must be utf-8 encoded string.");if(i.length>n.BYTESIZES.DATA)throw new Error("Transaction data field cannot exceed 64 bytes.")}})(e);const{data:t,amount:r,recipientPublicKey:o,passphrase:u,secondPassphrase:c}=e,d=o?s.getAddressFromPublicKey(o):void 0,l=e.recipientId?e.recipientId:d,p=Object.assign({},a.createBaseTransaction(e),{asset:t?{data:t}:{},amount:r,fee:n.TRANSFER_FEE.toString(),recipientId:l,recipientPublicKey:o,type:0});if(!u)return p;const g=Object.assign({},p,{recipientId:l,senderId:p.senderId,senderPublicKey:p.senderPublicKey}),h=new i.TransferTransaction(g);return h.sign(u,c),h.toJSON()}},7620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(4491);t.validateSenderIdAndPublicKey=(e,t,r)=>{const n=s.getAddressFromPublicKey(r);return t.toUpperCase()!==n.toUpperCase()?new i.TransactionError("`senderId` does not match `senderPublicKey`",e,".senderId",n,t):void 0}},7621:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5007);t.createBaseTransaction=({passphrase:e,timeOffset:t})=>{const{address:r,publicKey:n}=e?s.getAddressAndPublicKeyFromPassphrase(e):{address:void 0,publicKey:void 0};return{amount:"0",recipientId:"",senderId:r,senderPublicKey:n,timestamp:i.getTimeWithOffset(t)}}},7622:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5342),i=r(5904),n={0:i.validator.compile(s.transferTransaction),1:i.validator.compile(s.signatureTransaction),2:i.validator.compile(s.delegateTransaction),3:i.validator.compile(s.voteTransaction),4:i.validator.compile(s.multiTransaction),5:i.validator.compile(s.dappTransaction)};t.validateTransaction=e=>{if(void 0===e.type||null===e.type)throw new Error("Transaction type is required.");const t=(e=>{const t=n[e];if(!t)throw new Error("Unsupported transaction type.");return t})(e.type),r=t(e),s=t.errors?t.errors.filter(e=>"$merge"!==e.keyword):void 0;return r&&4===e.type?(e=>e.asset.multisignature.min>e.asset.multisignature.keysgroup.length?{valid:!1,errors:[{dataPath:".asset.multisignature.min",keyword:"multisignatures.keysgroup.min",message:".asset.multisignature.min cannot be greater than .asset.multisignature.keysgroup.length",params:{},schemaPath:"lisk/base-transaction"}]}:{valid:!0})(e):{valid:r,errors:s}}},7656:function(e,t,r){"use strict";e.exports.apply=r(7657),e.exports.generate=r(7658),e.exports.merge=r(7668)},7657:function(e,t,r){"use strict";e.exports=function e(t,r){if(null===r||"object"!=typeof r||Array.isArray(r))return r;(null===t||"object"!=typeof t||Array.isArray(t))&&(t={});for(var s=Object.keys(r),i=0;i<s.length;i++){var n=s[i];null===r[n]?t.hasOwnProperty(n)&&delete t[n]:t[n]=e(t[n],r[n])}return t}},7658:function(e,t,r){"use strict";var s=r(7659);e.exports=function e(t,r){if(null===t||null===r||"object"!=typeof t||"object"!=typeof r||Array.isArray(t)!==Array.isArray(r))return r;if(Array.isArray(t))return function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!s(t[r],e[r]))return!1;return!0}(t,r)?void 0:r;var i,n,a={},o=Object.keys(t),u=Object.keys(r),c={};for(n=0;n<u.length;n++)i=u[n],-1===o.indexOf(i)&&(c[i]=!0,a[i]=r[i]);var d={};for(n=0;n<o.length;n++)if(i=o[n],-1===u.indexOf(i))d[i]=!0,a[i]=null;else if(null!==t[i]&&"object"==typeof t[i]){var l=e(t[i],r[i]);void 0!==l&&(a[i]=l)}else t[i]!==r[i]&&(a[i]=r[i]);return Object.keys(a).length>0?a:void 0}},7660:function(e,t,r){"use strict";var s=r(1734)(),i=r(1740)("Object.prototype.toString"),n=function(e){return!(s&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},a=function(e){return!!n(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},o=function(){return n(arguments)}();n.isLegacyArguments=a,e.exports=o?n:a},7663:function(e,t,r){"use strict";var s,i,n,a,o=r(1740),u=r(1734)();if(u){s=o("Object.prototype.hasOwnProperty"),i=o("RegExp.prototype.exec"),n={};var c=function(){throw n};a={toString:c,valueOf:c},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=c)}var d=o("Object.prototype.toString"),l=Object.getOwnPropertyDescriptor;e.exports=u?function(e){if(!e||"object"!=typeof e)return!1;var t=l(e,"lastIndex");if(!(t&&s(t,"value")))return!1;try{i(e,a)}catch(e){return e===n}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===d(e)}},7667:function(e,t,r){"use strict";var s=Date.prototype.getDay,i=Object.prototype.toString,n=r(1734)();e.exports=function(e){return"object"==typeof e&&null!==e&&(n?function(e){try{return s.call(e),!0}catch(e){return!1}}(e):"[object Date]"===i.call(e))}},7668:function(e,t,r){"use strict";e.exports=function e(t,r){if(null===t||null===r||"object"!=typeof t||"object"!=typeof r||Array.isArray(t)!==Array.isArray(r))return r;var s=JSON.parse(JSON.stringify(t));return Object.keys(r).forEach((function(i){void 0!==t[i]?s[i]=e(t[i],r[i]):s[i]=r[i]})),s}},7671:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4513),i=r(4622),n=r(4491),a=r(5902),o=r(5346);t.verifySenderPublicKey=(e,t,r)=>t.publicKey&&t.publicKey!==r?new n.TransactionError("Invalid sender publicKey",e,".senderPublicKey",r,t.publicKey):void 0,t.verifySenderId=(e,t,r)=>t.address.toUpperCase()!==r.toUpperCase()?new n.TransactionError("Invalid sender address",e,".senderId",r.toUpperCase(),t.address.toUpperCase()):void 0,t.verifyBalance=(e,t,r)=>new s(t.balance).lt(new s(r))?new n.TransactionError(`Account does not have enough LSK: ${t.address}, balance: ${a.convertBeddowsToLSK(t.balance.toString())}`,e,".balance"):void 0,t.verifyAmountBalance=(e,t,r,i)=>{const o=new s(t.balance);if(o.gte(0)&&o.lt(new s(r)))return new n.TransactionError(`Account does not have enough LSK: ${t.address}, balance: ${a.convertBeddowsToLSK(o.plus(i).toString())}`,e,".balance")},t.verifySecondSignature=(e,t,r,s)=>{if(!t.secondPublicKey&&r)return new n.TransactionError("Sender does not have a secondPublicKey",e,".signSignature");if(!t.secondPublicKey)return;if(!r)return new n.TransactionError("Missing signSignature",e,".signSignature");const{valid:i,error:a}=o.validateSignature(t.secondPublicKey,r,s,e);return i?void 0:a};const u=e=>!!(e.membersPublicKeys&&e.membersPublicKeys.length>0&&e.multiMin);t.verifyMultiSignatures=(e,t,r,s)=>{if(!u(t)&&r.length>0)return{status:i.MultisignatureStatus.FAIL,errors:[new n.TransactionError("Sender is not a multisignature account",e,".signatures")]};if(!u(t))return{status:i.MultisignatureStatus.NONMULTISIGNATURE,errors:[]};const{valid:a,errors:c}=o.validateMultisignatures(t.membersPublicKeys,r,t.multiMin,s,e);return a?{status:i.MultisignatureStatus.READY,errors:[]}:c&&1===c.length&&c[0]instanceof n.TransactionPendingError?{status:i.MultisignatureStatus.PENDING,errors:c}:{status:i.MultisignatureStatus.FAIL,errors:c||[]}}},7672:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5917),n=r(5007);t.signRawTransaction=({transaction:e,passphrase:t,secondPassphrase:r,timeOffset:a})=>{const{publicKey:o,address:u}=s.getAddressAndPublicKeyFromPassphrase(t),c={senderPublicKey:o,senderSecondPublicKey:r?s.getPrivateAndPublicKeyFromPassphrase(r).publicKey:void 0,senderId:u,timestamp:n.getTimeWithOffset(a)},d=Object.assign({},e,c);return i.prepareTransaction(d,t,r)}},7673:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(5918),n=r(4414),a=r(4452);t.registerSecondPassphrase=e=>{(({secondPassphrase:e})=>{if("string"!=typeof e)throw new Error("Please provide a secondPassphrase. Expected string.")})(e);const{passphrase:t,secondPassphrase:r}=e,{publicKey:o}=s.getKeys(r),u=Object.assign({},a.createBaseTransaction(e),{type:1,fee:n.SIGNATURE_FEE.toString(),asset:{signature:{publicKey:o}}});if(!t)return u;const c=new i.SecondSignatureTransaction(u);return c.sign(t),c.toJSON()}},7674:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5919),i=r(4414),n=r(4452);t.registerDelegate=e=>{(({username:e})=>{if(!e||"string"!=typeof e)throw new Error("Please provide a username. Expected string.");if(e.length>i.USERNAME_MAX_LENGTH)throw new Error(`Username length does not match requirements. Expected to be no more than ${i.USERNAME_MAX_LENGTH} characters.`)})(e);const{username:t,passphrase:r,secondPassphrase:a}=e;if(!t||"string"!=typeof t)throw new Error("Please provide a username. Expected string.");if(t.length>i.USERNAME_MAX_LENGTH)throw new Error(`Username length does not match requirements. Expected to be no more than ${i.USERNAME_MAX_LENGTH} characters.`);const o=Object.assign({},n.createBaseTransaction(e),{type:2,fee:i.DELEGATE_FEE.toString(),asset:{delegate:{username:t}}});if(!r)return o;const u=new s.DelegateTransaction(o);return u.sign(r,a),u.toJSON()}},7675:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5920),i=r(4414),n=r(4452);t.castVotes=e=>{(({votes:e=[],unvotes:t=[]})=>{if(!Array.isArray(e))throw new Error("Please provide a valid votes value. Expected an array if present.");if(!Array.isArray(t))throw new Error("Please provide a valid unvotes value. Expected an array if present.");n.validatePublicKeys([...e,...t])})(e);const{passphrase:t,secondPassphrase:r,votes:a=[],unvotes:o=[]}=e,u=[...n.prependPlusToPublicKeys(a),...n.prependMinusToPublicKeys(o)],c=Object.assign({},n.createBaseTransaction(e),{type:3,fee:i.VOTE_FEE.toString(),asset:{votes:u}});if(!t)return c;const d=Object.assign({},c,{senderId:c.senderId,senderPublicKey:c.senderPublicKey,recipientId:c.senderId,recipientPublicKey:c.senderPublicKey}),l=new s.VoteTransaction(d);return l.sign(t,r),l.toJSON()}},7676:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5921),i=r(4414),n=r(4452);t.registerMultisignature=e=>{(({keysgroup:e,lifetime:t,minimum:r})=>{if(!n.isValidInteger(t)||t<i.MULTISIGNATURE_MIN_LIFETIME||t>i.MULTISIGNATURE_MAX_LIFETIME)throw new Error(`Please provide a valid lifetime value. Expected integer between ${i.MULTISIGNATURE_MIN_LIFETIME} and ${i.MULTISIGNATURE_MAX_LIFETIME}.`);if(!n.isValidInteger(r)||r<i.MULTISIGNATURE_MIN_KEYSGROUP||r>i.MULTISIGNATURE_MAX_KEYSGROUP)throw new Error(`Please provide a valid minimum value. Expected integer between ${i.MULTISIGNATURE_MIN_KEYSGROUP} and ${i.MULTISIGNATURE_MAX_KEYSGROUP}.`);if(e.length<r)throw new Error("Minimum number of signatures is larger than the number of keys in the keysgroup.");n.validateKeysgroup(e)})(e);const{keysgroup:t,lifetime:r,minimum:a,passphrase:o,secondPassphrase:u}=e,c=n.prependPlusToPublicKeys(t),d=c.length+1,l=Object.assign({},n.createBaseTransaction(e),{type:4,fee:(i.MULTISIGNATURE_FEE*d).toString(),asset:{multisignature:{min:a,lifetime:r,keysgroup:c}}});if(!o)return l;const p=new s.MultisignatureTransaction(l);return p.sign(o,u),p.toJSON()}},7677:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5922),i=r(4414),n=r(4452);t.createDapp=e=>{(({options:e})=>{if("object"!=typeof e)throw new Error("Options must be an object.");const{category:t,name:r,type:s,link:i,description:a,tags:o,icon:u}=e;if(!n.isValidInteger(t))throw new Error("Dapp category must be an integer.");if("string"!=typeof r)throw new Error("Dapp name must be a string.");if(!n.isValidInteger(s))throw new Error("Dapp type must be an integer.");if("string"!=typeof i)throw new Error("Dapp link must be a string.");if(void 0!==a&&"string"!=typeof a)throw new Error("Dapp description must be a string if provided.");if(void 0!==o&&"string"!=typeof o)throw new Error("Dapp tags must be a string if provided.");if(void 0!==u&&"string"!=typeof u)throw new Error("Dapp icon must be a string if provided.")})(e);const{passphrase:t,secondPassphrase:r,options:a}=e,o=Object.assign({},n.createBaseTransaction(e),{type:5,fee:i.DAPP_FEE.toString(),asset:{dapp:a}});if(!t)return o;const u=Object.assign({},o,{senderId:o.senderId,senderPublicKey:o.senderPublicKey}),c=new s.DappTransaction(u);return c.sign(t,r),c.toJSON()}},7678:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4413),i=r(4452);t.createSignatureObject=(e,t)=>{if(!i.verifyTransaction(e))throw new Error("Invalid transaction.");if(!e.id)throw new Error("Transaction ID is required to create a signature object.");const{publicKey:r}=s.getPrivateAndPublicKeyFromPassphrase(t);return{transactionId:e.id,publicKey:r,signature:i.multiSignTransaction(e,t)}}}}]);