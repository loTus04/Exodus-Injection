(window.webpackJsonp=window.webpackJsonp||[]).push([[253],{4243:function(t,e,r){"use strict";r.r(e);var n=r(4220),i=r(5569),s=r(155),a=r(4428),o=r(469),c=r(896);const u="0x0000000000000000000000000000456e65726779";class VETCoin extends(Object(o.g)(Object(o.h)(s.a))){constructor({alias:t,feeData:e,explorers:r,txWebUrl:n,socket:i}){super({alias:t,name:"VeChain",ticker:"VET",decimal:18,derivation:"m/44'/818'/0'/0/0",unspendableBalance:"0",explorers:r,txWebUrl:n,feeData:e,socket:i}),this.plugins=[new c.a],this.fee=e.fee,this.feeData=e,this.transactions=[],this.feeTokenContract=u,this.tokens={},this.eventEmmiter.on(this.ticker+"::confirmed-socket-tx",(t,e,r)=>{this.getInfo(),e&&e.direction?this.bus.$emit("socket::newtx",{id:t,ticker:r,amount:e.amount,txid:e.txid}):this.bus.$emit("socket::newtx::outgoing",{id:t,ticker:r})})}get feeTicker(){return"VTHO"}async getExcludedTokenList(){return[]}createToken(...t){return new a.h(this.ticker,...t)}async loadTokensList(t){const e=this.createToken("VeThor","VTHO",18,this.feeTokenContract,this.feeTokenContract,!1,!0);t.push(e),t.store.walletsCollection[e.alias].set(e.id.toUpperCase(),e),this.tokens[this.feeTokenContract]=e}loadWallet(t,e){return new Promise((t,r)=>{const i=e.trim().split(/\s+/);n.a.mnemonic.validate(i)||r(new Error("Error, fail words in VET mnemonic string"));const s=n.a.mnemonic.derivePrivateKey(i);s||r(new Error(this.ticker+" privateKey is empty!!!"));const a=n.a.secp256k1.derivePublicKey(s);this.privateKey="0x"+s.toString("hex"),this.address="0x"+n.a.publicKeyToAddress(a).toString("hex"),t(this)})}getAddress(){if(this.privateKey){const t=Buffer.from(this.privateKey.substring(2),"hex"),e=n.a.secp256k1.derivePublicKey(t);return"0x"+n.a.publicKeyToAddress(e).toString("hex")}return new Error(this.ticker+" privateKey is empty!!!")}async validateAddress(t){return!!t&&Boolean(t.match(/0x[0-9a-f]{40}/i))}async createTransaction({address:t,amount:e}){const r=Number(this.toCurrencyUnit(await this.getFee()));return this.createTransactionWithData(t,e,"0x",r)}async createTokenTransaction({contract:t,amount:e,dataToSend:r,fee:n}){return this.createTransactionWithData(t,e,r,n)}async createTransactionWithData(t,e,r,s){const a=await this.getProvider("block").getLatestBlock(),o=Buffer.from(this.privateKey.substring(2),"hex"),c="0x"+new this.BN(e).toString(16),u=a.id.substring(0,18),h=new i.a({chainTag:74,blockRef:u,expiration:720,clauses:[{to:t,value:c,data:r}],gasPriceCoef:0,gas:Number(this.convertVTHOToGas(s)),dependsOn:null,nonce:0}),l=n.a.blake2b256(h.encode());return h.signature=n.a.secp256k1.sign(l,o),"0x"+h.encode().toString("hex")}convertGasToVTHO(t){return Number(new this.BN(Number(t)).div(new this.BN(1e3)))}convertVTHOToGas(t){return Number(new this.BN(Number(t)).mul(new this.BN(1e3)))}async getInfo(){const t=await this.getProvider("balance").getInfo(this.address);return null!=t&&t.balance&&(this.balance=t.balance),null!=t&&t.energy&&(this.tokens[u].balance=t.energy),{balance:this.balance,energy:this.tokens[u].balance}}async getFee(){return this.toMinimalUnit(this.fee||this.convertGasToVTHO(i.a.intrinsicGas([])))}async isAvailableForFee(){const t=this.tokens[this.feeTokenContract],e=await this.getFee();return!!t&&(t.indivisibleBalance&&t.indivisibleBalance.gte(e))}async availableBalance(){const t=new this.BN(this.balance).sub(new this.BN(this.unspendableBalance));return t.lt(new this.BN(0))?"0":this.toCurrencyUnit(t)}async fetchUserTokens(t){return[]}get instance(){return{ticker:this.ticker,name:this.name,alias:this.alias,assetName:this.assetName,decimal:this.decimal,parent:this.parent,toCurrencyUnit:t=>this.toCurrencyUnit(t),toMinimalUnit:t=>this.toMinimalUnit(t),feeCoefficient:this.coefficient,feeDefault:this.feeData&&this.feeData.fee}}}e.default=VETCoin},4428:function(t,e,r){"use strict";r.d(e,"c",(function(){return o})),r.d(e,"b",(function(){return c})),r.d(e,"g",(function(){return u})),r.d(e,"a",(function(){return h})),r.d(e,"h",(function(){return l})),r.d(e,"i",(function(){return f})),r.d(e,"e",(function(){return y})),r.d(e,"d",(function(){return m})),r.d(e,"f",(function(){return THETAToken_THETAToken}));var n=r(31),i=r(394),s=r(4),a=r(3);class ETHToken_ETHToken extends i.a{constructor(...t){super(...t),this.gasLimit="150000",this.coefficient=1}async getInfo(){return{balance:String(this.balance),transactions:this.transactions}}async getFee({amount:t=0,isSendAll:e,gasPrice:r,gasLimit:n}){const i=Number(r.toString())*Number(this.coefficient),s=n||this.gasLimit;return new this.BN(s).mul(new this.BN(i))}getFeeSettings(){return n.a.get("eth-gas-price")}async createTransaction({address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i=this.gasLimit,multiplier:s=this.multiplier,nonce:a}){return{address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i,contract:this.contract,multiplier:s,nonce:a}}async sendTransaction(t){return new Promise((e,r)=>{this.web3.eth.sendSignedTransaction(t).on("transactionHash",t=>{e({txid:t})}).catch(t=>{const e=this.parent.coreLibrary.currentProvider.host,n=new s.d({type:a.s,error:t,url:e,instance:this});r(n)})})}}var o=ETHToken_ETHToken;class BSCToken_BSCToken extends i.a{constructor(...t){super(...t),this.gasLimit="150000",this.coefficient=1}async getInfo(){return{balance:String(this.balance),transactions:this.transactions}}async getFee({amount:t=0,isSendAll:e,gasPrice:r,gasLimit:n}){const i=Number(r.toString())*Number(this.coefficient),s=n||this.gasLimit;return new this.BN(s).mul(new this.BN(i))}async createTransaction({address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i=this.gasLimit,multiplier:s=this.multiplier,nonce:a}){return{address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i,contract:this.contract,multiplier:s,nonce:a}}async sendTransaction(t){return new Promise((e,r)=>{this.web3.eth.sendSignedTransaction(t).on("transactionHash",t=>{e({txid:t})}).catch(t=>{const e=this.parent.coreLibrary.currentProvider.host,n=new s.d({type:a.s,error:t,url:e,instance:this});r(n)})})}}var c=BSCToken_BSCToken;class TRXToken_TRXToken extends i.a{async createTransaction({address:t,amount:e}){return{address:t,amount:e,contract:this.contract,transfer:!0,feeLimit:1e7}}getUserTicker(){return-1!==this.ticker.indexOf("-")&&this.ticker.split("-")[1]||this.ticker}}var u=TRXToken_TRXToken;class BNBToken_BNBToken extends i.a{constructor(...t){super(...t),this.fields.paymentId=!0,this.balances={}}async availableBalance(){return this.balances&&this.balances.available?this.balances.available:this.divisibleBalance?String(this.divisibleBalance):"0"}async getInfo(){return await this.getBalance(),{balance:String(this.balance),transactions:this.transactions}}async createTransaction({address:t,amount:e,memo:r}){return{address:t,amount:e,memo:r,asset:this.ticker}}async getBalance(){return this.balance}async getTransactions(){return this.transactions}getUserTicker(){return this.ticker.split("-")[0]}}var h=BNBToken_BNBToken;class VETToken_VETToken extends i.a{constructor(...t){super(...t),this.fee="60"}get feeTicker(){return"VTHO"}async getInfo(){return{balance:String(this.balance),transactions:this.transactions}}async getFee(){return new this.BN(this.toMinimalUnit(this.fee))}async createTransaction({address:t,amount:e}){const r=Number(this.toCurrencyUnit(await this.getFee())),n=`0xa9059cbb${this.addLeadingZero(t.substring(2),64)}${this.addLeadingZero(new this.BN(e).toString(16),64)}`;return{contract:this.contract,amount:"0",dataToSend:n,fee:r}}async isAvailableForFee(){const t=await this.getFee();return this.indivisibleBalance.gte(t)}async availableBalance(){const t=await this.getFee(),e=new this.BN(this.balance).sub(t);return e.lt(new this.BN(0))?"0":this.toCurrencyUnit(e)}addLeadingZero(t,e){return String(t).padStart(e,"0")}}var l=VETToken_VETToken;class ZILToken_ZILToken extends i.a{async createTransaction({address:t,amount:e}){return{address:t,amount:e,contract:this.contract}}}var f=ZILToken_ZILToken,d=r(16),p=r.n(d);class MATICToken_MATICToken extends i.a{constructor(...t){super(...t),this.gasLimit="150000",this.coefficient=1,this.BN=p.a}async getInfo(){return{balance:String(this.balance),transactions:this.transactions}}async getFee({gasPrice:t,gasLimit:e}){const r=new this.BN(t.toString()).mul(new this.BN(this.coefficient)),n=e||this.gasLimit;return new this.BN(n).mul(new this.BN(r))}async createTransaction({address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i=this.gasLimit,multiplier:s=this.multiplier,nonce:a}){return{address:t,amount:e,custom:r,userGasPrice:n,gasLimit:i,contract:this.contract,multiplier:s,nonce:a}}async sendTransaction(t){return new Promise((e,r)=>{this.web3.eth.sendSignedTransaction(t).on("transactionHash",t=>{e({txid:t})}).catch(t=>{const e=this.parent.coreLibrary.currentProvider.host;r(new s.d({type:a.s,error:t,url:e,instance:this}))})})}}var y=MATICToken_MATICToken;class LUNCToken_LUNCToken extends i.a{constructor(...t){super(...t),this.denom=t[9],this.fields.paymentId=!0}async createTransaction({address:t,amount:e,userGasPrice:r,gasLimit:n,multiplier:i,feeLimit:s=1e7,memo:a}){return{address:t,amount:e,contract:this.contract,transfer:!0,ticker:this.ticker,userGasPrice:r,gasLimit:n,multiplier:i,feeLimit:s,denom:this.denom,memo:a}}}var m=LUNCToken_LUNCToken;class THETAToken_THETAToken extends i.a{constructor(...t){super(...t),this.id=this.ticker,this.network=this.config.network}async createTransaction({address:t,amount:e,userFee:r}){return{address:t,amount:e,contract:this.contract,ticker:this.ticker,userFee:r||await this.getFee()}}getFeeTicker(){return this.config.feeTicker}async availableBalance(t){if(!this.balance)return"0";const e=new p.a(this.balance).sub(new p.a(t));return e.gte(new p.a(0))?this.toCurrencyUnit(e):"0"}async isAvailableForSend(t,e){const r=await this.availableBalance(this.toMinimalUnit(e));return new p.a(this.toMinimalUnit(t)).lte(new p.a(this.toMinimalUnit(r)))}async getFee(){const t=this.config.defaultFee;if(!t)throw new Error(this.ticker+" provide defaultFee in config");return new this.BN(t)}}},4494:function(t,e){function r(t){return(4294967296+t).toString(16).substring(1)}t.exports={normalizeInput:function(t){let e;if(t instanceof Uint8Array)e=t;else{if("string"!=typeof t)throw new Error("Input must be an string, Buffer or Uint8Array");e=(new TextEncoder).encode(t)}return e},toHex:function(t){return Array.prototype.map.call(t,(function(t){return(t<16?"0":"")+t.toString(16)})).join("")},debugPrint:function(t,e,n){let i="\n"+t+" = ";for(let s=0;s<e.length;s+=2){if(32===n)i+=r(e[s]).toUpperCase(),i+=" ",i+=r(e[s+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=r(e[s+1]).toUpperCase(),i+=r(e[s]).toUpperCase()}s%6==4?i+="\n"+new Array(t.length+4).join(" "):s<e.length-2&&(i+=" ")}console.log(i)},testSpeed:function(t,e,r){let n=(new Date).getTime();const i=new Uint8Array(e);for(let t=0;t<e;t++)i[t]=t%256;const s=(new Date).getTime();console.log("Generated random input in "+(s-n)+"ms"),n=s;for(let s=0;s<r;s++){const r=t(i),s=(new Date).getTime(),a=s-n;n=s,console.log("Hashed in "+a+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(a/1e3)*100)/100+" MB PER SECOND")}}}},4635:function(t,e,r){const n=r(4636),i=r(4637);t.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},4636:function(t,e,r){const n=r(4494);function i(t,e,r){const n=t[e]+t[r];let i=t[e+1]+t[r+1];n>=4294967296&&i++,t[e]=n,t[e+1]=i}function s(t,e,r,n){let i=t[e]+r;r<0&&(i+=4294967296);let s=t[e+1]+n;i>=4294967296&&s++,t[e]=i,t[e+1]=s}function a(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function o(t,e,r,n,a,o){const c=l[a],u=l[a+1],f=l[o],d=l[o+1];i(h,t,e),s(h,t,c,u);let p=h[n]^h[t],y=h[n+1]^h[t+1];h[n]=y,h[n+1]=p,i(h,r,n),p=h[e]^h[r],y=h[e+1]^h[r+1],h[e]=p>>>24^y<<8,h[e+1]=y>>>24^p<<8,i(h,t,e),s(h,t,f,d),p=h[n]^h[t],y=h[n+1]^h[t+1],h[n]=p>>>16^y<<16,h[n+1]=y>>>16^p<<16,i(h,r,n),p=h[e]^h[r],y=h[e+1]^h[r+1],h[e]=y>>>31^p<<1,h[e+1]=p>>>31^y<<1}const c=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),u=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(t){return 2*t}))),h=new Uint32Array(32),l=new Uint32Array(32);function f(t,e){let r=0;for(r=0;r<16;r++)h[r]=t.h[r],h[r+16]=c[r];for(h[24]=h[24]^t.t,h[25]=h[25]^t.t/4294967296,e&&(h[28]=~h[28],h[29]=~h[29]),r=0;r<32;r++)l[r]=a(t.b,4*r);for(r=0;r<12;r++)o(0,8,16,24,u[16*r+0],u[16*r+1]),o(2,10,18,26,u[16*r+2],u[16*r+3]),o(4,12,20,28,u[16*r+4],u[16*r+5]),o(6,14,22,30,u[16*r+6],u[16*r+7]),o(0,10,20,30,u[16*r+8],u[16*r+9]),o(2,12,22,24,u[16*r+10],u[16*r+11]),o(4,14,16,26,u[16*r+12],u[16*r+13]),o(6,8,18,28,u[16*r+14],u[16*r+15]);for(r=0;r<16;r++)t.h[r]=t.h[r]^h[r]^h[r+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(t,e,r,n){if(0===t||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");const i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};d.fill(0),d[0]=t,e&&(d[1]=e.length),d[2]=1,d[3]=1,r&&d.set(r,32),n&&d.set(n,48);for(let t=0;t<16;t++)i.h[t]=c[t]^a(d,4*t);return e&&(y(i,e),i.c=128),i}function y(t,e){for(let r=0;r<e.length;r++)128===t.c&&(t.t+=t.c,f(t,!1),t.c=0),t.b[t.c++]=e[r]}function m(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;f(t,!0);const e=new Uint8Array(t.outlen);for(let r=0;r<t.outlen;r++)e[r]=t.h[r>>2]>>8*(3&r);return e}function b(t,e,r,i,s){r=r||64,t=n.normalizeInput(t),i&&(i=n.normalizeInput(i)),s&&(s=n.normalizeInput(s));const a=p(r,e,i,s);return y(a,t),m(a)}t.exports={blake2b:b,blake2bHex:function(t,e,r,i,s){const a=b(t,e,r,i,s);return n.toHex(a)},blake2bInit:p,blake2bUpdate:y,blake2bFinal:m}},4637:function(t,e,r){const n=r(4494);function i(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function s(t,e,r,n,i,s){u[t]=u[t]+u[e]+i,u[n]=a(u[n]^u[t],16),u[r]=u[r]+u[n],u[e]=a(u[e]^u[r],12),u[t]=u[t]+u[e]+s,u[n]=a(u[n]^u[t],8),u[r]=u[r]+u[n],u[e]=a(u[e]^u[r],7)}function a(t,e){return t>>>e^t<<32-e}const o=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),u=new Uint32Array(16),h=new Uint32Array(16);function l(t,e){let r=0;for(r=0;r<8;r++)u[r]=t.h[r],u[r+8]=o[r];for(u[12]^=t.t,u[13]^=t.t/4294967296,e&&(u[14]=~u[14]),r=0;r<16;r++)h[r]=i(t.b,4*r);for(r=0;r<10;r++)s(0,4,8,12,h[c[16*r+0]],h[c[16*r+1]]),s(1,5,9,13,h[c[16*r+2]],h[c[16*r+3]]),s(2,6,10,14,h[c[16*r+4]],h[c[16*r+5]]),s(3,7,11,15,h[c[16*r+6]],h[c[16*r+7]]),s(0,5,10,15,h[c[16*r+8]],h[c[16*r+9]]),s(1,6,11,12,h[c[16*r+10]],h[c[16*r+11]]),s(2,7,8,13,h[c[16*r+12]],h[c[16*r+13]]),s(3,4,9,14,h[c[16*r+14]],h[c[16*r+15]]);for(r=0;r<8;r++)t.h[r]^=u[r]^u[r+8]}function f(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=e?e.length:0;if(e&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const n={h:new Uint32Array(o),b:new Uint8Array(64),c:0,t:0,outlen:t};return n.h[0]^=16842752^r<<8^t,r>0&&(d(n,e),n.c=64),n}function d(t,e){for(let r=0;r<e.length;r++)64===t.c&&(t.t+=t.c,l(t,!1),t.c=0),t.b[t.c++]=e[r]}function p(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;l(t,!0);const e=new Uint8Array(t.outlen);for(let r=0;r<t.outlen;r++)e[r]=t.h[r>>2]>>8*(3&r)&255;return e}function y(t,e,r){r=r||32,t=n.normalizeInput(t);const i=f(r,e);return d(i,t),p(i)}t.exports={blake2s:y,blake2sHex:function(t,e,r){const i=y(t,e,r);return n.toHex(i)},blake2sInit:f,blake2sUpdate:d,blake2sFinal:p}},6629:function(t,e,r){"use strict";var n="undefined"==typeof process||!process.nextTick||Boolean(process.browser),i=r(6630),s=r(6631),a=r(6633),o=r(910),c=r(920);function u(t){return"function"==typeof t}function h(t){return o("keccak256").update(t).digest()}t.exports={version:"1.1.0",browser:n,scrypt:null,crypto:r(n?1736:27),constants:{cipher:"aes-128-ctr",ivBytes:16,keyBytes:32,pbkdf2:{c:262144,dklen:32,hash:"sha256",prf:"hmac-sha256"},scrypt:{memory:28e7,dklen:32,n:262144,r:8,p:1}},isHex:function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/i))},isBase64:function(t){var e;return!(t.length%4>0||t.match(/[^0-9a-z+\/=]/i))&&!(-1!==(e=t.indexOf("="))&&!t.slice(e).match(/={1,2}/))},str2buf:function(t,e){return t&&t.constructor===String?(!e&&this.isHex(t)&&(e="hex"),!e&&this.isBase64(t)&&(e="base64"),Buffer.from(t,e)):t},isCipherAvailable:function(t){return this.crypto.getCiphers().some((function(e){return e===t}))},encrypt:function(t,e,r,n){var i,s;if(n=n||this.constants.cipher,!this.isCipherAvailable(n))throw new Error(n+" is not available");return s=(i=this.crypto.createCipheriv(n,this.str2buf(e),this.str2buf(r))).update(this.str2buf(t)),Buffer.concat([s,i.final()])},decrypt:function(t,e,r,n){var i,s;if(n=n||this.constants.cipher,!this.isCipherAvailable(n))throw new Error(n+" is not available");return s=(i=this.crypto.createDecipheriv(n,this.str2buf(e),this.str2buf(r))).update(this.str2buf(t)),Buffer.concat([s,i.final()])},privateKeyToAddress:function(t){var e;return(e=this.str2buf(t)).length<32&&(e=Buffer.concat([Buffer.alloc(32-e.length,0),e])),"0x"+h(Buffer.from(a.publicKeyCreate(e,!1).slice(1))).slice(-20).toString("hex")},getMAC:function(t,e){if(null!=t&&null!=e)return h(Buffer.concat([this.str2buf(t).slice(16,32),this.str2buf(e)])).toString("hex")},deriveKeyUsingScrypt:function(t,e,r,n){var i=r.kdfparams.n||this.constants.scrypt.n,s=r.kdfparams.r||this.constants.scrypt.r,a=r.kdfparams.p||this.constants.scrypt.p,o=r.kdfparams.dklen||this.constants.scrypt.dklen;if(!u(n))return Buffer.from(c.syncScrypt(t,e,i,s,a,o));c.scrypt(t,e,i,s,a,o).then((function(t){n(Buffer.from(t))})).catch(n)},deriveKey:function(t,e,r,n){var s,a=this;if(null==t||!e)throw new Error("Must provide password and salt to derive a key");return(r=r||{}).kdfparams=r.kdfparams||{},t=this.str2buf(t,"utf8"),e=this.str2buf(e),"scrypt"===r.kdf?this.deriveKeyUsingScrypt(t,e,r,n):("hmac-sha256"===(s=r.kdfparams.prf||this.constants.pbkdf2.prf)&&(s="sha256"),u(n)?void(this.crypto.pbkdf2?this.crypto.pbkdf2(t,e,r.kdfparams.c||this.constants.pbkdf2.c,r.kdfparams.dklen||this.constants.pbkdf2.dklen,s,(function(t,e){if(t)return n(t);n(e)})):setTimeout((function(){n(Buffer.from(i.codec.hex.fromBits(i.misc.pbkdf2(t.toString("utf8"),i.codec.hex.toBits(e.toString("hex")),r.kdfparams.c||a.constants.pbkdf2.c,8*(r.kdfparams.dklen||a.constants.pbkdf2.dklen))),"hex"))}),0)):this.crypto.pbkdf2Sync?this.crypto.pbkdf2Sync(t,e,r.kdfparams.c||this.constants.pbkdf2.c,r.kdfparams.dklen||this.constants.pbkdf2.dklen,s):Buffer.from(i.codec.hex.fromBits(i.misc.pbkdf2(t.toString("utf8"),i.codec.hex.toBits(e.toString("hex")),r.kdfparams.c||a.constants.pbkdf2.c,8*(r.kdfparams.dklen||a.constants.pbkdf2.dklen))),"hex"))},create:function(t,e){var r,n,i=this;function s(s){var o=s.slice(0,r);return a.privateKeyVerify(o)?{privateKey:o,iv:s.slice(r,r+n),salt:s.slice(r+n)}:i.create(t,e)}if(r=(t=t||{}).keyBytes||this.constants.keyBytes,n=t.ivBytes||this.constants.ivBytes,!u(e))return s(this.crypto.randomBytes(r+n+r));this.crypto.randomBytes(r+n+r,(function(t,r){if(t)return e(t);e(s(r))}))},marshal:function(t,e,r,n,i){var a,o,c;return(i=i||{}).kdfparams=i.kdfparams||{},c=i.cipher||this.constants.cipher,a=this.encrypt(e,t.slice(0,16),n,c).toString("hex"),o={address:this.privateKeyToAddress(e).slice(2),crypto:{cipher:i.cipher||this.constants.cipher,ciphertext:a,cipherparams:{iv:n.toString("hex")},mac:this.getMAC(t,a)},id:s.v4(),version:3},"scrypt"===i.kdf?(o.crypto.kdf="scrypt",o.crypto.kdfparams={dklen:i.kdfparams.dklen||this.constants.scrypt.dklen,n:i.kdfparams.n||this.constants.scrypt.n,r:i.kdfparams.r||this.constants.scrypt.r,p:i.kdfparams.p||this.constants.scrypt.p,salt:r.toString("hex")}):(o.crypto.kdf="pbkdf2",o.crypto.kdfparams={c:i.kdfparams.c||this.constants.pbkdf2.c,dklen:i.kdfparams.dklen||this.constants.pbkdf2.dklen,prf:i.kdfparams.prf||this.constants.pbkdf2.prf,salt:r.toString("hex")}),o},dump:function(t,e,r,n,i,s){if(i=i||{},n=this.str2buf(n),e=this.str2buf(e),!u(s))return this.marshal(this.deriveKey(t,r,i),e,r,n,i);this.deriveKey(t,r,i,function(t){s(this.marshal(t,e,r,n,i))}.bind(this))},recover:function(t,e,r){var n,i,s,a,o,c=this;function l(t,r,i,s,a){var o;if(c.getMAC(t,s)!==n.mac)throw new Error("message authentication code mismatch");return o="1"===e.version?h(t.slice(0,16)).slice(0,16):t.slice(0,16),c.decrypt(s,o,i,a)}if(n=e.Crypto||e.crypto,i=this.str2buf(n.cipherparams.iv),s=this.str2buf(n.kdfparams.salt),a=this.str2buf(n.ciphertext),o=n.cipher,"pbkdf2"===n.kdf&&"hmac-sha256"!==n.kdfparams.prf)throw new Error("PBKDF2 only supported with HMAC-SHA256");if(!u(r))return l(this.deriveKey(t,s,n),0,i,a,o);this.deriveKey(t,s,n,(function(t){try{r(l(t,0,i,a,o))}catch(t){r(t)}}))},generateKeystoreFilename:function(t){var e="UTC--"+(new Date).toISOString()+"--"+t;return"win32"===process.platform&&(e=e.split(":").join("-")),e},exportToFile:function(t,e,n){var i,s,a,o;return e=e||"keystore",i=this.generateKeystoreFilename(t.address),a=JSON.stringify(t),this.browser?u(n)?n(a):a:(s=r(81).join(e,i),o=r(156),u(n)?void o.writeFile(s,a,(function(t){if(t)return n(t);n(s)})):(o.writeFileSync(s,a),s))},importFromFile:function(t,e,n){var i,s,a,o;if(this.browser)throw new Error("method only available in Node.js");function c(t,e,r){var n,i,s=null;for(n=0,i=r.length;n<i;++n)if(r[n].indexOf(e)>-1){s=a.join(t,r[n]),o.lstatSync(s).isDirectory()&&(s=a.join(s,r[n]));break}return s}if(a=r(81),o=r(156),t=(t=t.replace("0x","")).toLowerCase(),e=e||a.join(process.env.HOME,".ethereum"),i=a.join(e,"keystore"),!u(n)){if(!(s=c(i,t,o.readdirSync(i))))throw new Error("could not find key file for address "+t);return JSON.parse(o.readFileSync(s))}o.readdir(i,(function(e,r){var s;return e?n(e):(s=c(i,t,r),n(s?JSON.parse(o.readFileSync(s)):new Error("could not find key file for address "+t)))}))}}},6630:function(t,e,r){"use strict";var n,i={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};function s(t,e,r){if(4!==e.length)throw new i.exception.invalid("invalid aes block size");var n=t.b[r],s=e[0]^n[0],a=e[r?3:1]^n[1],o=e[2]^n[2];e=e[r?1:3]^n[3];var c,u,h,l,f=n.length/4-2,d=4,p=[0,0,0,0];t=(c=t.s[r])[0];var y=c[1],m=c[2],b=c[3],g=c[4];for(l=0;l<f;l++)c=t[s>>>24]^y[a>>16&255]^m[o>>8&255]^b[255&e]^n[d],u=t[a>>>24]^y[o>>16&255]^m[e>>8&255]^b[255&s]^n[d+1],h=t[o>>>24]^y[e>>16&255]^m[s>>8&255]^b[255&a]^n[d+2],e=t[e>>>24]^y[s>>16&255]^m[a>>8&255]^b[255&o]^n[d+3],d+=4,s=c,a=u,o=h;for(l=0;4>l;l++)p[r?3&-l:l]=g[s>>>24]<<24^g[a>>16&255]<<16^g[o>>8&255]<<8^g[255&e]^n[d++],c=s,s=a,a=o,o=e,e=c;return p}function a(t,e){var r,n,i,s=t.F,a=t.b,o=s[0],c=s[1],u=s[2],h=s[3],l=s[4],f=s[5],d=s[6],p=s[7];for(r=0;64>r;r++)16>r?n=e[r]:(n=e[r+1&15],i=e[r+14&15],n=e[15&r]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+e[15&r]+e[r+9&15]|0),n=n+p+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(d^l&(f^d))+a[r],p=d,d=f,f=l,l=h+n|0,h=u,u=c,o=n+((c=o)&u^h&(c^u))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;s[0]=s[0]+o|0,s[1]=s[1]+c|0,s[2]=s[2]+u|0,s[3]=s[3]+h|0,s[4]=s[4]+l|0,s[5]=s[5]+f|0,s[6]=s[6]+d|0,s[7]=s[7]+p|0}function o(t,e){var r,n=i.random.K[t],s=[];for(r in n)n.hasOwnProperty(r)&&s.push(n[r]);for(r=0;r<s.length;r++)s[r](e)}function c(t,e){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?t.addEntropy(window.performance.now(),e,"loadtime"):t.addEntropy((new Date).valueOf(),e,"loadtime")}function u(t){t.b=h(t).concat(h(t)),t.L=new i.cipher.aes(t.b)}function h(t){for(var e=0;4>e&&(t.h[e]=t.h[e]+1|0,!t.h[e]);e++);return t.L.encrypt(t.h)}function l(t,e){return function(){e.apply(t,arguments)}}i.cipher.aes=function(t){this.s[0][0][0]||this.O();var e,r,n,s,a=this.s[0][4],o=this.s[1],c=1;if(4!==(e=t.length)&&6!==e&&8!==e)throw new i.exception.invalid("invalid aes key size");for(this.b=[n=t.slice(0),s=[]],t=e;t<4*e+28;t++)r=n[t-1],(0==t%e||8===e&&4==t%e)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[255&r],0==t%e&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),n[t]=n[t-e]^r;for(e=0;t;e++,t--)r=n[3&e?t:t-4],s[e]=4>=t||4>e?r:o[0][a[r>>>24]]^o[1][a[r>>16&255]]^o[2][a[r>>8&255]]^o[3][a[255&r]]},i.cipher.aes.prototype={encrypt:function(t){return s(this,t,0)},decrypt:function(t){return s(this,t,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var t,e,r,n,i,s,a,o=this.s[0],c=this.s[1],u=o[4],h=c[4],l=[],f=[];for(t=0;256>t;t++)f[(l[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!u[e];e^=n||1,r=f[r]||1)for(s=(s=r^r<<1^r<<2^r<<3^r<<4)>>8^255&s^99,u[e]=s,h[s]=e,a=16843009*(i=l[t=l[n=l[e]]])^65537*t^257*n^16843008*e,i=257*l[s]^16843008*s,t=0;4>t;t++)o[t][e]=i=i<<24^i>>>8,c[t][s]=a=a<<24^a>>>8;for(t=0;5>t;t++)o[t]=o[t].slice(0),c[t]=c[t].slice(0)}},i.bitArray={bitSlice:function(t,e,r){return t=i.bitArray.$(t.slice(e/32),32-(31&e)).slice(1),void 0===r?t:i.bitArray.clamp(t,r-e)},extract:function(t,e,r){var n=Math.floor(-e-r&31);return(-32&(e+r-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],n=i.bitArray.getPartial(r);return 32===n?t.concat(e):i.bitArray.$(e,n,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+i.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var r=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<r&&e&&(t[r-1]=i.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(i.bitArray.bitLength(t)!==i.bitArray.bitLength(e))return!1;var r,n=0;for(r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n},$:function(t,e,r,n){var s;for(s=0,void 0===n&&(n=[]);32<=e;e-=32)n.push(r),r=0;if(0===e)return n.concat(t);for(s=0;s<t.length;s++)n.push(r|t[s]>>>e),r=t[s]<<32-e;return s=t.length?t[t.length-1]:0,t=i.bitArray.getPartial(s),n.push(i.bitArray.partial(e+t&31,32<e+t?r:n.pop(),1)),n},i:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,r;for(e=0;e<t.length;++e)r=t[e],t[e]=r>>>24|r>>>8&65280|(65280&r)<<8|r<<24;return t}},i.codec.utf8String={fromBits:function(t){var e,r,n="",s=i.bitArray.bitLength(t);for(e=0;e<s/8;e++)0==(3&e)&&(r=t[e/4]),n+=String.fromCharCode(r>>>24),r<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,r=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3==(3&e)&&(r.push(n),n=0);return 3&e&&r.push(i.bitArray.partial(8*(3&e),n)),r}},i.codec.hex={fromBits:function(t){var e,r="";for(e=0;e<t.length;e++)r+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return r.substr(0,i.bitArray.bitLength(t)/4)},toBits:function(t){var e,r,n=[];for(r=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return i.bitArray.clamp(n,4*r)}},i.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,r){var n=i.codec.base32.BASE,s=i.codec.base32.REMAINING,a="",o=0,c=i.codec.base32.B,u=0,h=i.bitArray.bitLength(t);for(r&&(c=i.codec.base32.X),r=0;a.length*n<h;)a+=c.charAt((u^t[r]>>>o)>>>s),o<n?(u=t[r]<<n-o,o+=s,r++):(u<<=n,o-=n);for(;7&a.length&&!e;)a+="=";return a},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var r,n,s=i.codec.base32.BITS,a=i.codec.base32.BASE,o=i.codec.base32.REMAINING,c=[],u=0,h=i.codec.base32.B,l=0,f="base32";for(e&&(h=i.codec.base32.X,f="base32hex"),r=0;r<t.length;r++){if(0>(n=h.indexOf(t.charAt(r)))){if(!e)try{return i.codec.base32hex.toBits(t)}catch(t){}throw new i.exception.invalid("this isn't "+f+"!")}u>o?(u-=o,c.push(l^n>>>u),l=n<<s-u):l^=n<<s-(u+=a)}return 56&u&&c.push(i.bitArray.partial(56&u,l,1)),c}},i.codec.base32hex={fromBits:function(t,e){return i.codec.base32.fromBits(t,e,1)},toBits:function(t){return i.codec.base32.toBits(t,1)}},i.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,r){var n="",s=0,a=i.codec.base64.B,o=0,c=i.bitArray.bitLength(t);for(r&&(a=a.substr(0,62)+"-_"),r=0;6*n.length<c;)n+=a.charAt((o^t[r]>>>s)>>>26),6>s?(o=t[r]<<6-s,s+=26,r++):(o<<=6,s-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var r,n,s=[],a=0,o=i.codec.base64.B,c=0;for(e&&(o=o.substr(0,62)+"-_"),r=0;r<t.length;r++){if(0>(n=o.indexOf(t.charAt(r))))throw new i.exception.invalid("this isn't base64!");26<a?(a-=26,s.push(c^n>>>a),c=n<<32-a):c^=n<<32-(a+=6)}return 56&a&&s.push(i.bitArray.partial(56&a,c,1)),s}},i.codec.base64url={fromBits:function(t){return i.codec.base64.fromBits(t,1,1)},toBits:function(t){return i.codec.base64.toBits(t,1)}},i.hash.sha256=function(t){this.b[0]||this.O(),t?(this.F=t.F.slice(0),this.A=t.A.slice(0),this.l=t.l):this.reset()},i.hash.sha256.hash=function(t){return(new i.hash.sha256).update(t).finalize()},i.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(t){"string"==typeof t&&(t=i.codec.utf8String.toBits(t));var e,r=this.A=i.bitArray.concat(this.A,t);if(e=this.l,9007199254740991<(t=this.l=e+i.bitArray.bitLength(t)))throw new i.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var n=new Uint32Array(r),s=0;for(e=512+e-(512+e&511);e<=t;e+=512)a(this,n.subarray(16*s,16*(s+1))),s+=1;r.splice(0,16*s)}else for(e=512+e-(512+e&511);e<=t;e+=512)a(this,r.splice(0,16));return this},finalize:function(){var t,e=this.A,r=this.F;for(t=(e=i.bitArray.concat(e,[i.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.l/4294967296)),e.push(0|this.l);e.length;)a(this,e.splice(0,16));return this.reset(),r},Y:[],b:[],O:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}for(var e,r,n=0,i=2;64>n;i++){for(r=!0,e=2;e*e<=i;e++)if(0==i%e){r=!1;break}r&&(8>n&&(this.Y[n]=t(Math.pow(i,.5))),this.b[n]=t(Math.pow(i,1/3)),n++)}}},i.mode.ccm={name:"ccm",G:[],listenProgress:function(t){i.mode.ccm.G.push(t)},unListenProgress:function(t){-1<(t=i.mode.ccm.G.indexOf(t))&&i.mode.ccm.G.splice(t,1)},fa:function(t){var e,r=i.mode.ccm.G.slice();for(e=0;e<r.length;e+=1)r[e](t)},encrypt:function(t,e,r,n,s){var a,o=e.slice(0),c=i.bitArray,u=c.bitLength(r)/8,h=c.bitLength(o)/8;if(s=s||64,n=n||[],7>u)throw new i.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;4>a&&h>>>8*a;a++);return a<15-u&&(a=15-u),r=c.clamp(r,8*(15-a)),e=i.mode.ccm.V(t,e,r,n,s,a),o=i.mode.ccm.C(t,o,r,e,s,a),c.concat(o.data,o.tag)},decrypt:function(t,e,r,n,s){s=s||64,n=n||[];var a=i.bitArray,o=a.bitLength(r)/8,c=a.bitLength(e),u=a.clamp(e,c-s),h=a.bitSlice(e,c-s);c=(c-s)/8;if(7>o)throw new i.exception.invalid("ccm: iv must be at least 7 bytes");for(e=2;4>e&&c>>>8*e;e++);if(e<15-o&&(e=15-o),r=a.clamp(r,8*(15-e)),u=i.mode.ccm.C(t,u,r,h,s,e),t=i.mode.ccm.V(t,u.data,r,n,s,e),!a.equal(u.tag,t))throw new i.exception.corrupt("ccm: tag doesn't match");return u.data},na:function(t,e,r,n,s,a){var o=[],c=i.bitArray,u=c.i;if(n=[c.partial(8,(e.length?64:0)|n-2<<2|a-1)],(n=c.concat(n,r))[3]|=s,n=t.encrypt(n),e.length)for(65279>=(r=c.bitLength(e)/8)?o=[c.partial(16,r)]:4294967295>=r&&(o=c.concat([c.partial(16,65534)],[r])),o=c.concat(o,e),e=0;e<o.length;e+=4)n=t.encrypt(u(n,o.slice(e,e+4).concat([0,0,0])));return n},V:function(t,e,r,n,s,a){var o=i.bitArray,c=o.i;if((s/=8)%2||4>s||16<s)throw new i.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<e.length)throw new i.exception.bug("ccm: can't deal with 4GiB or more data");for(r=i.mode.ccm.na(t,n,r,s,o.bitLength(e)/8,a),n=0;n<e.length;n+=4)r=t.encrypt(c(r,e.slice(n,n+4).concat([0,0,0])));return o.clamp(r,8*s)},C:function(t,e,r,n,s,a){var o,c=i.bitArray;o=c.i;var u=e.length,h=c.bitLength(e),l=u/50,f=l;if(r=c.concat([c.partial(8,a-1)],r).concat([0,0,0]).slice(0,4),n=c.bitSlice(o(n,t.encrypt(r)),0,s),!u)return{tag:n,data:[]};for(o=0;o<u;o+=4)o>l&&(i.mode.ccm.fa(o/u),l+=f),r[3]++,s=t.encrypt(r),e[o]^=s[0],e[o+1]^=s[1],e[o+2]^=s[2],e[o+3]^=s[3];return{tag:n,data:c.clamp(e,h)}}},i.mode.ocb2={name:"ocb2",encrypt:function(t,e,r,n,s,a){if(128!==i.bitArray.bitLength(r))throw new i.exception.invalid("ocb iv must be 128 bits");var o,c=i.mode.ocb2.S,u=i.bitArray,h=u.i,l=[0,0,0,0];r=c(t.encrypt(r));var f,d=[];for(n=n||[],s=s||64,o=0;o+4<e.length;o+=4)l=h(l,f=e.slice(o,o+4)),d=d.concat(h(r,t.encrypt(h(r,f)))),r=c(r);return f=e.slice(o),e=u.bitLength(f),o=t.encrypt(h(r,[0,0,0,e])),f=u.clamp(h(f.concat([0,0,0]),o),e),l=h(l,h(f.concat([0,0,0]),o)),l=t.encrypt(h(l,h(r,c(r)))),n.length&&(l=h(l,a?n:i.mode.ocb2.pmac(t,n))),d.concat(u.concat(f,u.clamp(l,s)))},decrypt:function(t,e,r,n,s,a){if(128!==i.bitArray.bitLength(r))throw new i.exception.invalid("ocb iv must be 128 bits");s=s||64;var o,c,u=i.mode.ocb2.S,h=i.bitArray,l=h.i,f=[0,0,0,0],d=u(t.encrypt(r)),p=i.bitArray.bitLength(e)-s,y=[];for(n=n||[],r=0;r+4<p/32;r+=4)o=l(d,t.decrypt(l(d,e.slice(r,r+4)))),f=l(f,o),y=y.concat(o),d=u(d);if(c=p-32*r,o=t.encrypt(l(d,[0,0,0,c])),o=l(o,h.clamp(e.slice(r),c).concat([0,0,0])),f=l(f,o),f=t.encrypt(l(f,l(d,u(d)))),n.length&&(f=l(f,a?n:i.mode.ocb2.pmac(t,n))),!h.equal(h.clamp(f,s),h.bitSlice(e,p)))throw new i.exception.corrupt("ocb: tag doesn't match");return y.concat(h.clamp(o,c))},pmac:function(t,e){var r,n=i.mode.ocb2.S,s=i.bitArray,a=s.i,o=[0,0,0,0],c=a(c=t.encrypt([0,0,0,0]),n(n(c)));for(r=0;r+4<e.length;r+=4)c=n(c),o=a(o,t.encrypt(a(c,e.slice(r,r+4))));return r=e.slice(r),128>s.bitLength(r)&&(c=a(c,n(c)),r=s.concat(r,[-2147483648,0,0,0])),o=a(o,r),t.encrypt(a(n(a(c,n(c))),o))},S:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},i.mode.gcm={name:"gcm",encrypt:function(t,e,r,n,s){var a=e.slice(0);return e=i.bitArray,n=n||[],t=i.mode.gcm.C(!0,t,a,n,r,s||128),e.concat(t.data,t.tag)},decrypt:function(t,e,r,n,s){var a=e.slice(0),o=i.bitArray,c=o.bitLength(a);if(n=n||[],(s=s||128)<=c?(e=o.bitSlice(a,c-s),a=o.bitSlice(a,0,c-s)):(e=a,a=[]),t=i.mode.gcm.C(!1,t,a,n,r,s),!o.equal(t.tag,e))throw new i.exception.corrupt("gcm: tag doesn't match");return t.data},ka:function(t,e){var r,n,s,a,o,c=i.bitArray.i;for(s=[0,0,0,0],a=e.slice(0),r=0;128>r;r++){for((n=0!=(t[Math.floor(r/32)]&1<<31-r%32))&&(s=c(s,a)),o=0!=(1&a[3]),n=3;0<n;n--)a[n]=a[n]>>>1|(1&a[n-1])<<31;a[0]>>>=1,o&&(a[0]^=-520093696)}return s},j:function(t,e,r){var n,s=r.length;for(e=e.slice(0),n=0;n<s;n+=4)e[0]^=4294967295&r[n],e[1]^=4294967295&r[n+1],e[2]^=4294967295&r[n+2],e[3]^=4294967295&r[n+3],e=i.mode.gcm.ka(e,t);return e},C:function(t,e,r,n,s,a){var o,c,u,h,l,f,d,p,y=i.bitArray;for(f=r.length,d=y.bitLength(r),p=y.bitLength(n),c=y.bitLength(s),o=e.encrypt([0,0,0,0]),96===c?(s=s.slice(0),s=y.concat(s,[1])):(s=i.mode.gcm.j(o,[0,0,0,0],s),s=i.mode.gcm.j(o,s,[0,0,Math.floor(c/4294967296),4294967295&c])),c=i.mode.gcm.j(o,[0,0,0,0],n),l=s.slice(0),n=c.slice(0),t||(n=i.mode.gcm.j(o,c,r)),h=0;h<f;h+=4)l[3]++,u=e.encrypt(l),r[h]^=u[0],r[h+1]^=u[1],r[h+2]^=u[2],r[h+3]^=u[3];return r=y.clamp(r,d),t&&(n=i.mode.gcm.j(o,c,r)),t=[Math.floor(p/4294967296),4294967295&p,Math.floor(d/4294967296),4294967295&d],n=i.mode.gcm.j(o,n,t),u=e.encrypt(s),n[0]^=u[0],n[1]^=u[1],n[2]^=u[2],n[3]^=u[3],{tag:y.bitSlice(n,0,a),data:r}}},i.misc.hmac=function(t,e){this.W=e=e||i.hash.sha256;var r,n=[[],[]],s=e.prototype.blockSize/32;for(this.w=[new e,new e],t.length>s&&(t=e.hash(t)),r=0;r<s;r++)n[0][r]=909522486^t[r],n[1][r]=1549556828^t[r];this.w[0].update(n[0]),this.w[1].update(n[1]),this.R=new e(this.w[0])},i.misc.hmac.prototype.encrypt=i.misc.hmac.prototype.mac=function(t){if(this.aa)throw new i.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},i.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1},i.misc.hmac.prototype.update=function(t){this.aa=!0,this.R.update(t)},i.misc.hmac.prototype.digest=function(){var t=this.R.finalize();t=new this.W(this.w[1]).update(t).finalize();return this.reset(),t},i.misc.pbkdf2=function(t,e,r,n,s){if(r=r||1e4,0>n||0>r)throw new i.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=i.codec.utf8String.toBits(t)),"string"==typeof e&&(e=i.codec.utf8String.toBits(e)),t=new(s=s||i.misc.hmac)(t);var a,o,c,u,h=[],l=i.bitArray;for(u=1;32*h.length<(n||1);u++){for(s=a=t.encrypt(l.concat(e,[u])),o=1;o<r;o++)for(a=t.encrypt(a),c=0;c<a.length;c++)s[c]^=a[c];h=h.concat(s)}return n&&(h=l.clamp(h,n)),h},i.prng=function(t){this.c=[new i.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=t,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80},i.prng.prototype={randomWords:function(t,e){var r,n,s=[];if((r=this.isReady(e))===this.u)throw new i.exception.notReady("generator isn't seeded");if(r&this.J){r=!(r&this.I),n=[];var a,o=0;for(this.Z=n[0]=(new Date).valueOf()+this.da,a=0;16>a;a++)n.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(n=n.concat(this.c[a].finalize()),o+=this.m[a],this.m[a]=0,r||!(this.P&1<<a));a++);for(this.P>=1<<this.c.length&&(this.c.push(new i.hash.sha256),this.m.push(0)),this.f-=o,o>this.o&&(this.o=o),this.P++,this.b=i.hash.sha256.hash(this.b.concat(n)),this.L=new i.cipher.aes(this.b),r=0;4>r&&(this.h[r]=this.h[r]+1|0,!this.h[r]);r++);}for(r=0;r<t;r+=4)0==(r+1)%this.ca&&u(this),n=h(this),s.push(n[0],n[1],n[2],n[3]);return u(this),s.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw new i.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=t},addEntropy:function(t,e,r){r=r||"user";var n,s,a=(new Date).valueOf(),c=this.H[r],u=this.isReady(),h=0;switch(void 0===(n=this.U[r])&&(n=this.U[r]=this.ha++),void 0===c&&(c=this.H[r]=0),this.H[r]=(this.H[r]+1)%this.c.length,typeof t){case"number":void 0===e&&(e=1),this.c[c].update([n,this.N++,1,e,a,1,0|t]);break;case"object":if("[object Uint32Array]"===(r=Object.prototype.toString.call(t))){for(s=[],r=0;r<t.length;r++)s.push(t[r]);t=s}else for("[object Array]"!==r&&(h=1),r=0;r<t.length&&!h;r++)"number"!=typeof t[r]&&(h=1);if(!h){if(void 0===e)for(r=e=0;r<t.length;r++)for(s=t[r];0<s;)e++,s>>>=1;this.c[c].update([n,this.N++,2,e,a,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this.c[c].update([n,this.N++,3,e,a,t.length]),this.c[c].update(t);break;default:h=1}if(h)throw new i.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[c]+=e,this.f+=e,u===this.u&&(this.isReady()!==this.u&&o("seeded",Math.max(this.o,this.f)),o("progress",this.getProgress()))},isReady:function(t){return t=this.T[void 0!==t?t:this.M],this.o&&this.o>=t?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=t?this.J|this.u:this.u},getProgress:function(t){return t=this.T[t||this.M],this.o>=t||this.f>t?1:this.f/t},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:l(this,this.ma),mouseCollector:l(this,this.oa),keyboardCollector:l(this,this.la),accelerometerCollector:l(this,this.ea),touchCollector:l(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new i.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(t,e){this.K[t][this.ga++]=e},removeEventListener:function(t,e){var r,n,i=this.K[t],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===e&&s.push(n);for(r=0;r<s.length;r++)delete i[n=s[r]]},la:function(){c(this,1)},oa:function(t){var e,r;try{e=t.x||t.clientX||t.offsetX||0,r=t.y||t.clientY||t.offsetY||0}catch(t){r=e=0}0!=e&&0!=r&&this.addEntropy([e,r],2,"mouse"),c(this,0)},qa:function(t){t=t.touches[0]||t.changedTouches[0],this.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),c(this,0)},ma:function(){c(this,2)},ea:function(t){if(t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,window.orientation){var e=window.orientation;"number"==typeof e&&this.addEntropy(e,1,"accelerometer")}t&&this.addEntropy(t,2,"accelerometer"),c(this,0)}},i.random=new i.prng(6);t:try{var f,d,p,y;if(y=t.exports){var m;try{m=r(27)}catch(t){m=null}y=d=m}if(y&&d.randomBytes)f=d.randomBytes(128),f=new Uint32Array(new Uint8Array(f).buffer),i.random.addEntropy(f,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(p=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(p);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(p)}i.random.addEntropy(p,1024,"crypto['getRandomValues']")}}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}i.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(t,e,r,n){r=r||{},n=n||{};var s,a=i.json,o=a.g({iv:i.random.randomWords(4,0)},a.defaults);if(a.g(o,r),r=o.adata,"string"==typeof o.salt&&(o.salt=i.codec.base64.toBits(o.salt)),"string"==typeof o.iv&&(o.iv=i.codec.base64.toBits(o.iv)),!i.mode[o.mode]||!i.cipher[o.cipher]||"string"==typeof t&&100>=o.iter||64!==o.ts&&96!==o.ts&&128!==o.ts||128!==o.ks&&192!==o.ks&&256!==o.ks||2>o.iv.length||4<o.iv.length)throw new i.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(t=(s=i.misc.cachedPbkdf2(t,o)).key.slice(0,o.ks/32),o.salt=s.salt):i.ecc&&t instanceof i.ecc.elGamal.publicKey&&(s=t.kem(),o.kemtag=s.tag,t=s.key.slice(0,o.ks/32)),"string"==typeof e&&(e=i.codec.utf8String.toBits(e)),"string"==typeof r&&(o.adata=r=i.codec.utf8String.toBits(r)),s=new i.cipher[o.cipher](t),a.g(n,o),n.key=t,o.ct="ccm"===o.mode&&i.arrayBuffer&&i.arrayBuffer.ccm&&e instanceof ArrayBuffer?i.arrayBuffer.ccm.encrypt(s,e,o.iv,r,o.ts):i.mode[o.mode].encrypt(s,e,o.iv,r,o.ts),o},encrypt:function(t,e,r,n){var s=i.json,a=s.ja.apply(s,arguments);return s.encode(a)},ia:function(t,e,r,n){r=r||{},n=n||{};var s,a,o=i.json;if(s=(e=o.g(o.g(o.g({},o.defaults),e),r,!0)).adata,"string"==typeof e.salt&&(e.salt=i.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=i.codec.base64.toBits(e.iv)),!i.mode[e.mode]||!i.cipher[e.cipher]||"string"==typeof t&&100>=e.iter||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||2>e.iv.length||4<e.iv.length)throw new i.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(t=(a=i.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=a.salt):i.ecc&&t instanceof i.ecc.elGamal.secretKey&&(t=t.unkem(i.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof s&&(s=i.codec.utf8String.toBits(s)),a=new i.cipher[e.cipher](t),s="ccm"===e.mode&&i.arrayBuffer&&i.arrayBuffer.ccm&&e.ct instanceof ArrayBuffer?i.arrayBuffer.ccm.decrypt(a,e.ct,e.iv,e.tag,s,e.ts):i.mode[e.mode].decrypt(a,e.ct,e.iv,s,e.ts),o.g(n,e),n.key=t,1===r.raw?s:i.codec.utf8String.fromBits(s)},decrypt:function(t,e,r,n){var s=i.json;return s.ia(t,s.decode(e),r,n)},encode:function(t){var e,r="{",n="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new i.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":r+=t[e];break;case"string":r+='"'+escape(t[e])+'"';break;case"object":r+='"'+i.codec.base64.fromBits(t[e],0)+'"';break;default:throw new i.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new i.exception.invalid("json decode: this isn't json!");t=t.replace(/^\{|\}$/g,"").split(/,/);var e,r,n={};for(e=0;e<t.length;e++){if(!(r=t[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new i.exception.invalid("json decode: this isn't json!");null!=r[3]?n[r[2]]=parseInt(r[3],10):null!=r[4]?n[r[2]]=r[2].match(/^(ct|adata|salt|iv)$/)?i.codec.base64.toBits(r[4]):unescape(r[4]):null!=r[5]&&(n[r[2]]="true"===r[5])}return n},g:function(t,e,r){if(void 0===t&&(t={}),void 0===e)return t;for(var n in e)if(e.hasOwnProperty(n)){if(r&&void 0!==t[n]&&t[n]!==e[n])throw new i.exception.invalid("required parameter overridden");t[n]=e[n]}return t},sa:function(t,e){var r,n={};for(r in t)t.hasOwnProperty(r)&&t[r]!==e[r]&&(n[r]=t[r]);return n},ra:function(t,e){var r,n={};for(r=0;r<e.length;r++)void 0!==t[e[r]]&&(n[e[r]]=t[e[r]]);return n}},i.encrypt=i.json.encrypt,i.decrypt=i.json.decrypt,i.misc.pa={},i.misc.cachedPbkdf2=function(t,e){var r,n=i.misc.pa;return r=(e=e||{}).iter||1e3,(r=(n=n[t]=n[t]||{})[r]=n[r]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):i.random.randomWords(2,0)})[n=void 0===e.salt?r.firstSalt:e.salt]=r[n]||i.misc.pbkdf2(t,n,e.iter),{key:r[n].slice(0),salt:n.slice(0)}},t.exports&&(t.exports=i),void 0===(n=function(){return i}.apply(e,[]))||(t.exports=n)},6631:function(t,e,r){for(var n=r(6632),i=[],s={},a=0;a<256;++a)i[a]=(a+256).toString(16).substr(1),s[i[a]]=a;function o(t,e){var r=e||0,n=i;return n[t[r++]]+n[t[r++]]+n[t[r++]]+n[t[r++]]+"-"+n[t[r++]]+n[t[r++]]+"-"+n[t[r++]]+n[t[r++]]+"-"+n[t[r++]]+n[t[r++]]+"-"+n[t[r++]]+n[t[r++]]+n[t[r++]]+n[t[r++]]+n[t[r++]]+n[t[r++]]}var c=n(),u=[1|c[0],c[1],c[2],c[3],c[4],c[5]],h=16383&(c[6]<<8|c[7]),l=0,f=0;function d(t,e,r){var i=e&&r||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[i+a]=s[a];return e||o(s)}var p=d;p.v1=function(t,e,r){var n=e&&r||0,i=e||[],s=void 0!==(t=t||{}).clockseq?t.clockseq:h,a=void 0!==t.msecs?t.msecs:(new Date).getTime(),c=void 0!==t.nsecs?t.nsecs:f+1,d=a-l+(c-f)/1e4;if(d<0&&void 0===t.clockseq&&(s=s+1&16383),(d<0||a>l)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=a,f=c,h=s;var p=(1e4*(268435455&(a+=122192928e5))+c)%4294967296;i[n++]=p>>>24&255,i[n++]=p>>>16&255,i[n++]=p>>>8&255,i[n++]=255&p;var y=a/4294967296*1e4&268435455;i[n++]=y>>>8&255,i[n++]=255&y,i[n++]=y>>>24&15|16,i[n++]=y>>>16&255,i[n++]=s>>>8|128,i[n++]=255&s;for(var m=t.node||u,b=0;b<6;++b)i[n+b]=m[b];return e||o(i)},p.v4=d,t.exports=p},6632:function(t,e){var r,n=global.crypto||global.msCrypto;if(n&&n.getRandomValues){var i=new Uint8Array(16);r=function(){return n.getRandomValues(i),i}}if(!r){var s=new Array(16);r=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}t.exports=r},6633:function(t,e,r){t.exports=r(6634)(r(6635))},6634:function(t,e){const r="Impossible case. Please create issue.",n="The tweak was out of range or the resulted private key is invalid",i="The tweak was out of range or equal to zero",s="Unknow error on context randomization",a="Private Key is invalid",o="Public Key could not be parsed",c="Public Key serialization error",u="The sum of the public keys is not valid",h="Signature could not be parsed",l="The nonce generation function failed, or the private key was invalid",f="Public key could not be recover",d="Scalar was invalid (zero or overflow)";function p(t,e){if(!t)throw new Error(e)}function y(t,e,r){if(p(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),void 0!==r)if(Array.isArray(r)){const n=`Expected ${t} to be an Uint8Array with length [${r.join(", ")}]`;p(r.includes(e.length),n)}else{const n=`Expected ${t} to be an Uint8Array with length ${r}`;p(e.length===r,n)}}function m(t){p("Boolean"===g(t),"Expected compressed to be a Boolean")}function b(t=(t=>new Uint8Array(t)),e){return"function"==typeof t&&(t=t(e)),y("output",t,e),t}function g(t){return Object.prototype.toString.call(t).slice(8,-1)}t.exports=t=>({contextRandomize(e){switch(p(null===e||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),null!==e&&y("seed",e,32),t.contextRandomize(e)){case 1:throw new Error(s)}},privateKeyVerify:e=>(y("private key",e,32),0===t.privateKeyVerify(e)),privateKeyNegate(e){switch(y("private key",e,32),t.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(r)}},privateKeyTweakAdd(e,r){switch(y("private key",e,32),y("tweak",r,32),t.privateKeyTweakAdd(e,r)){case 0:return e;case 1:throw new Error(n)}},privateKeyTweakMul(e,r){switch(y("private key",e,32),y("tweak",r,32),t.privateKeyTweakMul(e,r)){case 0:return e;case 1:throw new Error(i)}},publicKeyVerify:e=>(y("public key",e,[33,65]),0===t.publicKeyVerify(e)),publicKeyCreate(e,r=!0,n){switch(y("private key",e,32),m(r),n=b(n,r?33:65),t.publicKeyCreate(n,e)){case 0:return n;case 1:throw new Error(a);case 2:throw new Error(c)}},publicKeyConvert(e,r=!0,n){switch(y("public key",e,[33,65]),m(r),n=b(n,r?33:65),t.publicKeyConvert(n,e)){case 0:return n;case 1:throw new Error(o);case 2:throw new Error(c)}},publicKeyNegate(e,n=!0,i){switch(y("public key",e,[33,65]),m(n),i=b(i,n?33:65),t.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(o);case 2:throw new Error(r);case 3:throw new Error(c)}},publicKeyCombine(e,r=!0,n){p(Array.isArray(e),"Expected public keys to be an Array"),p(e.length>0,"Expected public keys array will have more than zero items");for(const t of e)y("public key",t,[33,65]);switch(m(r),n=b(n,r?33:65),t.publicKeyCombine(n,e)){case 0:return n;case 1:throw new Error(o);case 2:throw new Error(u);case 3:throw new Error(c)}},publicKeyTweakAdd(e,r,i=!0,s){switch(y("public key",e,[33,65]),y("tweak",r,32),m(i),s=b(s,i?33:65),t.publicKeyTweakAdd(s,e,r)){case 0:return s;case 1:throw new Error(o);case 2:throw new Error(n)}},publicKeyTweakMul(e,r,n=!0,s){switch(y("public key",e,[33,65]),y("tweak",r,32),m(n),s=b(s,n?33:65),t.publicKeyTweakMul(s,e,r)){case 0:return s;case 1:throw new Error(o);case 2:throw new Error(i)}},signatureNormalize(e){switch(y("signature",e,64),t.signatureNormalize(e)){case 0:return e;case 1:throw new Error(h)}},signatureExport(e,n){y("signature",e,64);const i={output:n=b(n,72),outputlen:72};switch(t.signatureExport(i,e)){case 0:return n.slice(0,i.outputlen);case 1:throw new Error(h);case 2:throw new Error(r)}},signatureImport(e,n){switch(y("signature",e),n=b(n,64),t.signatureImport(n,e)){case 0:return n;case 1:throw new Error(h);case 2:throw new Error(r)}},ecdsaSign(e,n,i={},s){y("message",e,32),y("private key",n,32),p("Object"===g(i),"Expected options to be an Object"),void 0!==i.data&&y("options.data",i.data),void 0!==i.noncefn&&p("Function"===g(i.noncefn),"Expected options.noncefn to be a Function");const a={signature:s=b(s,64),recid:null};switch(t.ecdsaSign(a,e,n,i.data,i.noncefn)){case 0:return a;case 1:throw new Error(l);case 2:throw new Error(r)}},ecdsaVerify(e,r,n){switch(y("signature",e,64),y("message",r,32),y("public key",n,[33,65]),t.ecdsaVerify(e,r,n)){case 0:return!0;case 3:return!1;case 1:throw new Error(h);case 2:throw new Error(o)}},ecdsaRecover(e,n,i,s=!0,a){switch(y("signature",e,64),p("Number"===g(n)&&n>=0&&n<=3,"Expected recovery id to be a Number within interval [0, 3]"),y("message",i,32),m(s),a=b(a,s?33:65),t.ecdsaRecover(a,e,n,i)){case 0:return a;case 1:throw new Error(h);case 2:throw new Error(f);case 3:throw new Error(r)}},ecdh(e,r,n={},i){switch(y("public key",e,[33,65]),y("private key",r,32),p("Object"===g(n),"Expected options to be an Object"),void 0!==n.data&&y("options.data",n.data),void 0!==n.hashfn?(p("Function"===g(n.hashfn),"Expected options.hashfn to be a Function"),void 0!==n.xbuf&&y("options.xbuf",n.xbuf,32),void 0!==n.ybuf&&y("options.ybuf",n.ybuf,32),y("output",i)):i=b(i,32),t.ecdh(i,e,r,n.data,n.hashfn,n.xbuf,n.ybuf)){case 0:return i;case 1:throw new Error(o);case 2:throw new Error(d)}}})},6635:function(t,e,r){const n=new(0,r(84).ec)("secp256k1"),i=n.curve,s=i.n.constructor;function a(t){const e=t[0];switch(e){case 2:case 3:return 33!==t.length?null:function(t,e){let r=new s(e);if(r.cmp(i.p)>=0)return null;r=r.toRed(i.red);let a=r.redSqr().redIMul(r).redIAdd(i.b).redSqrt();return 3===t!==a.isOdd()&&(a=a.redNeg()),n.keyPair({pub:{x:r,y:a}})}(e,t.subarray(1,33));case 4:case 6:case 7:return 65!==t.length?null:function(t,e,r){let a=new s(e),o=new s(r);if(a.cmp(i.p)>=0||o.cmp(i.p)>=0)return null;if(a=a.toRed(i.red),o=o.toRed(i.red),(6===t||7===t)&&o.isOdd()!==(7===t))return null;const c=a.redSqr().redIMul(a);return o.redSqr().redISub(c.redIAdd(i.b)).isZero()?n.keyPair({pub:{x:a,y:o}}):null}(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function o(t,e){const r=e.encode(null,33===t.length);for(let e=0;e<t.length;++e)t[e]=r[e]}t.exports={contextRandomize:()=>0,privateKeyVerify(t){const e=new s(t);return e.cmp(i.n)<0&&!e.isZero()?0:1},privateKeyNegate(t){const e=new s(t),r=i.n.sub(e).umod(i.n).toArrayLike(Uint8Array,"be",32);return t.set(r),0},privateKeyTweakAdd(t,e){const r=new s(e);if(r.cmp(i.n)>=0)return 1;if(r.iadd(new s(t)),r.cmp(i.n)>=0&&r.isub(i.n),r.isZero())return 1;const n=r.toArrayLike(Uint8Array,"be",32);return t.set(n),0},privateKeyTweakMul(t,e){let r=new s(e);if(r.cmp(i.n)>=0||r.isZero())return 1;r.imul(new s(t)),r.cmp(i.n)>=0&&(r=r.umod(i.n));const n=r.toArrayLike(Uint8Array,"be",32);return t.set(n),0},publicKeyVerify:t=>null===a(t)?1:0,publicKeyCreate(t,e){const r=new s(e);if(r.cmp(i.n)>=0||r.isZero())return 1;return o(t,n.keyFromPrivate(e).getPublic()),0},publicKeyConvert(t,e){const r=a(e);if(null===r)return 1;return o(t,r.getPublic()),0},publicKeyNegate(t,e){const r=a(e);if(null===r)return 1;const n=r.getPublic();return n.y=n.y.redNeg(),o(t,n),0},publicKeyCombine(t,e){const r=new Array(e.length);for(let t=0;t<e.length;++t)if(r[t]=a(e[t]),null===r[t])return 1;let n=r[0].getPublic();for(let t=1;t<r.length;++t)n=n.add(r[t].pub);return n.isInfinity()?2:(o(t,n),0)},publicKeyTweakAdd(t,e,r){const n=a(e);if(null===n)return 1;if((r=new s(r)).cmp(i.n)>=0)return 2;const c=n.getPublic().add(i.g.mul(r));return c.isInfinity()?2:(o(t,c),0)},publicKeyTweakMul(t,e,r){const n=a(e);if(null===n)return 1;if((r=new s(r)).cmp(i.n)>=0||r.isZero())return 2;return o(t,n.getPublic().mul(r)),0},signatureNormalize(t){const e=new s(t.subarray(0,32)),r=new s(t.subarray(32,64));return e.cmp(i.n)>=0||r.cmp(i.n)>=0?1:(1===r.cmp(n.nh)&&t.set(i.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){const r=e.subarray(0,32),n=e.subarray(32,64);if(new s(r).cmp(i.n)>=0)return 1;if(new s(n).cmp(i.n)>=0)return 1;const{output:a}=t;let o=a.subarray(4,37);o[0]=0,o.set(r,1);let c=33,u=0;for(;c>1&&0===o[u]&&!(128&o[u+1]);--c,++u);if(o=o.subarray(u),128&o[0])return 1;if(c>1&&0===o[0]&&!(128&o[1]))return 1;let h=a.subarray(39,72);h[0]=0,h.set(n,1);let l=33,f=0;for(;l>1&&0===h[f]&&!(128&h[f+1]);--l,++f);return h=h.subarray(f),128&h[0]||l>1&&0===h[0]&&!(128&h[1])?1:(t.outputlen=6+c+l,a[0]=48,a[1]=t.outputlen-2,a[2]=2,a[3]=o.length,a.set(o,4),a[4+c]=2,a[5+c]=h.length,a.set(h,6+c),0)},signatureImport(t,e){if(e.length<8)return 1;if(e.length>72)return 1;if(48!==e[0])return 1;if(e[1]!==e.length-2)return 1;if(2!==e[2])return 1;const r=e[3];if(0===r)return 1;if(5+r>=e.length)return 1;if(2!==e[4+r])return 1;const n=e[5+r];if(0===n)return 1;if(6+r+n!==e.length)return 1;if(128&e[4])return 1;if(r>1&&0===e[4]&&!(128&e[5]))return 1;if(128&e[r+6])return 1;if(n>1&&0===e[r+6]&&!(128&e[r+7]))return 1;let a=e.subarray(4,4+r);if(33===a.length&&0===a[0]&&(a=a.subarray(1)),a.length>32)return 1;let o=e.subarray(6+r);if(33===o.length&&0===o[0]&&(o=o.slice(1)),o.length>32)throw new Error("S length is too long");let c=new s(a);c.cmp(i.n)>=0&&(c=new s(0));let u=new s(e.subarray(6+r));return u.cmp(i.n)>=0&&(u=new s(0)),t.set(c.toArrayLike(Uint8Array,"be",32),0),t.set(u.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,r,a,o){if(o){const t=o;o=n=>{const i=t(e,r,null,a,n);if(!(i instanceof Uint8Array&&32===i.length))throw new Error("This is the way");return new s(i)}}const c=new s(r);if(c.cmp(i.n)>=0||c.isZero())return 1;let u;try{u=n.sign(e,r,{canonical:!0,k:o,pers:a})}catch(t){return 1}return t.signature.set(u.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(u.s.toArrayLike(Uint8Array,"be",32),32),t.recid=u.recoveryParam,0},ecdsaVerify(t,e,r){const o={r:t.subarray(0,32),s:t.subarray(32,64)},c=new s(o.r),u=new s(o.s);if(c.cmp(i.n)>=0||u.cmp(i.n)>=0)return 1;if(1===u.cmp(n.nh)||c.isZero()||u.isZero())return 3;const h=a(r);if(null===h)return 2;const l=h.getPublic();return n.verify(e,o,l)?0:3},ecdsaRecover(t,e,r,a){const c={r:e.slice(0,32),s:e.slice(32,64)},u=new s(c.r),h=new s(c.s);if(u.cmp(i.n)>=0||h.cmp(i.n)>=0)return 1;if(u.isZero()||h.isZero())return 2;let l;try{l=n.recoverPubKey(a,c,r)}catch(t){return 2}return o(t,l),0},ecdh(t,e,r,o,c,u,h){const l=a(e);if(null===l)return 1;const f=new s(r);if(f.cmp(i.n)>=0||f.isZero())return 2;const d=l.getPublic().mul(f);if(void 0===c){const e=d.encode(null,!0),r=n.hash().update(e).digest();for(let e=0;e<32;++e)t[e]=r[e]}else{u||(u=new Uint8Array(32));const e=d.getX().toArray("be",32);for(let t=0;t<32;++t)u[t]=e[t];h||(h=new Uint8Array(32));const r=d.getY().toArray("be",32);for(let t=0;t<32;++t)h[t]=r[t];const n=c(u,h,o);if(!(n instanceof Uint8Array&&n.length===t.length))return 2;t.set(n)}return 0}}}}]);