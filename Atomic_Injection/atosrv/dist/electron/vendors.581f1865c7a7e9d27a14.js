(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1346:function(t,e,s){"use strict";e.a=class LazyLoadedLib{constructor(t){this.importLib=t,this.promise=null}async get(t){let e;this.isLibLoaded()||this.loadLib();try{e=await this.promise}catch(t){throw new Error("The dynamically loaded module cannot be loaded")}if(void 0===t)return e;if(!Object.keys(e).includes(t))throw new Error(`The dynamically loaded component ${t} is not implemented`);return e[t]}isLibLoaded(){return null!==this.promise}loadLib(){this.promise=this.importLib()}}},139:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));const a={balance:"balance",history:"history"},i=Symbol("SKIP_ADDRESS_CHECK"),r=({address:t,id:e,parent:s})=>t?e:s;e.b=new class ActiveWalletsList{constructor(){this.storageId="activeWallets",this.activatedWalletsIdCollection=[],this.activityChecked={balance:{},history:{}},this.notCheckedWalletsDeactivated=!1,this.synchronize()}activate(t){this.isActivated(t)||(this.activatedWalletsIdCollection.push(r(t)),this.save())}deactivateNotCheckedWallets(t=!0){this.notCheckedWalletsDeactivated=t}getCheckResult(t,e){return this.activityChecked[e][r(t)]}isActivated(t){return["BTC","ETH",...this.activatedWalletsIdCollection].includes(r(t))}isActive(t,e=i){const s=Object.values(a),r=s.some(e=>!this.isChecked(t,e)),n=s.some(e=>this.getCheckResult(t,e));return Boolean((e||e===i)&&(this.isActivated(t)||r&&!this.notCheckedWalletsDeactivated||n))}isChecked(t,e){return void 0!==this.getCheckResult(t,e)}save(){localStorage.setItem(this.storageId,JSON.stringify({activatedWalletsIdCollection:this.activatedWalletsIdCollection,activityChecked:this.activityChecked}))}setChecked(t,e,s){this.activityChecked[e][r(t)]=s,this.save()}synchronize(){const t=localStorage.getItem(this.storageId);try{const e=JSON.parse(t||"{}");this.activatedWalletsIdCollection=e.activatedWalletsIdCollection||[],this.activityChecked=e.activityChecked||{balance:{},history:{}}}catch(t){console.error(t),this.activatedWalletsIdCollection=[],this.activityChecked={balance:{},history:{}}}}}},1439:function(t,e,s){"use strict"},151:function(t,e,s){"use strict";var a=s(60);const i=new(s.n(a).a);i.setMaxListeners(0),e.a=i},1516:function(t,e,s){"use strict";var a=s(62),i=s.n(a),r=s(31),n=s(314),o=s(1639);const c=new class Cashback{constructor(){this.settings=o.a,this.fetcher=null,this.cashbackWallet=void 0,this.fetchSettings()}async fetchSettings(){clearTimeout(this.fetcher);try{this.settings=await r.a.get("cashback-settings")}catch(t){console.error("Fetch cashback settings failed:",t)}this.fetcher=setTimeout(this.fetchSettings,6e5)}currentLevel(t){if(!t&&"0"!==String(t))return this.settings[0];const e=this.settings[this.settings.length-1];return t>=e.minAWC?e:this.settings.find(e=>t>=e.minAWC&&t<e.maxAWC)}async getCoinRate(t){await n.a.getRates([t],"USD",!0);return Number(n.a.getCoinPrice(t,"USD"))||0}async calculateCashback(t,e,s){const a=n.a.getCoinPrice(e,"USD")||await this.getCoinRate(e),r=n.a.getCoinPrice(this.cashbackWallet,"USD")||await this.getCoinRate(this.cashbackWallet);if(a*r==0)return"0";const o=this.currentLevel(s).percent;return new i.a(a).multipliedBy(t).multipliedBy(o).dividedBy(r).toFixed(8,2).toString()}setCashbackWallet(t){this.cashbackWallet=t}};e.a=c},1518:function(t,e,s){"use strict";var a=s(874),i=s.n(a),r=s(28),n=s.n(r),o=s(22),c=s(31),l=s(20);const h={BNB:"BSC",USDC:"TRX-USDC",USDT:"TRX-USDT"},d={chartDataSettings:{type:"atomicServiceGetReverse",baseUrl:"https://raki.atomicwallet.io/"},mainChartEndPoint:"lastWeek",requestTimeouts:{atomicServicePostReverse:{lastYear:18e4,lastHour:18e4,last24Hour:18e4,lastWeek:6e5,lastMonth:18e5,allTime:18e5},atomicServiceGetReverse:{lastYear:18e4,lastHour:18e4,last24Hour:18e4,lastWeek:6e5,lastMonth:18e5,allTime:18e5},atomicServicePost:{lastYear:18e4,lastHour:18e4,last24Hour:18e4,lastWeek:6e5,lastMonth:18e5,allTime:18e5},atomicServiceGet:{lastYear:18e4,lastHour:18e4,last24Hour:18e4,lastWeek:6e5,lastMonth:18e5,allTime:18e5},cryptocompare:{last24Hour:18e4,allTime:6e4}}},u=["atomicServicePost","atomicServicePostReverse"],g=["atomicServiceGetReverse","atomicServicePostReverse"];const m=new class ChartData{constructor(){this.data={},this.dataToUpdate={},this.lastRequestTimes={lastYear:null,last24Hour:null,lastWeek:null,lastMonth:null,allTime:null},this.isReverse=!0,this.isMobile=!1,this.isLoading=!1,this.fiat="USD",this.chartRequestList={},this.platformVersion=null,this.chartDataSettings=d.chartDataSettings,this.mainChartEndPoint=d.mainChartEndPoint,this.requestTimeouts=d.requestTimeouts[this.chartDataSettings.type],this.isReverse=g.includes(this.chartDataSettings.type),c.a.get("chart-data-settings-new").then(t=>{t?(this.chartDataSettings=t.chartDataSettings||d.chartDataSettings,this.mainChartEndPoint=t.mainChartEndPoint||d.mainChartEndPoint,this.isReverse=g.includes(this.chartDataSettings.type),this.requestTimeouts=t.requestTimeouts&&t.requestTimeouts[this.chartDataSettings.type]||d.requestTimeouts[this.chartDataSettings.type]):o.a.error({instance:this,error:"chart-data-config: Invalid data"})}).catch(t=>{o.a.error({instance:this,error:t})})}setFiat(t){this.fiat=t}async getChartDataFromDb(){return await l.e.chartData.where({fiat:this.fiat}).toArray()}async getChartDataTickerFromDb(t){return await l.e.chartData.where({fiat:this.fiat,ticker:t}).toArray()}setChartData(t,e,s,a){if(t[a]||(Object.defineProperty(t,Object.keys(a)[0],{}),t[a]={}),t[a][this.fiat]){const i=Object.assign({},t[a][this.fiat]);i[s]=e,t[a][this.fiat]=i}else t[a][this.fiat]={},t[a][this.fiat][s]=e;if(Object.keys(h).includes(a)){const r=h[a];t[r]=i()(t[r]||{},{[this.fiat]:{[s]:e}})}}async initChartData(t){(t?await this.getChartDataTickerFromDb(t):await this.getChartDataFromDb()).forEach(({data:t=[],endPoint:e,ticker:s})=>{this.setChartData(this.data,t,e,s)})}updateChartData(t){const e=Object.keys(t).filter(e=>t[e][this.fiat]).map(e=>t[e][this.fiat]&&Object.keys(t[e][this.fiat]).map(s=>({id:e+this.fiat+s,data:t[e][this.fiat][s],fiat:this.fiat,ticker:e,endPoint:s}))).flat();this._insertBatch(e)}async getCryptoCompareData(t){const e=await n()({method:"get",url:t}).catch(t=>o.a.error({instance:this,error:t}));return e.data&&e.data.Data.Data&&"Error"!==e.data.Response?e.data.Data.Data:""}async getCryptoCompareHistoryData({ticker:t,isRequestTimeSave:e,isGetAtOnce:s,isMainChart:a,endPoint:i}){const r=`?tsym=${this.fiat}&fsym=${t}`,n={last24Hour:"",lastYear:"",lastMonth:"",lastWeek:"",allTime:""};let o=!1,c=!1;const l=Date.now();if(a){const t=["allTime","lastWeek","lastMonth","lastYear"];o=t.includes(this.mainChartEndPoint)||t.includes(i),c="last24Hour"===this.mainChartEndPoint||this.mainChartEndPoint===i}return(o||s||l-this.requestTimeouts.allTime>this.lastRequestTimes.allTime)&&(e&&(this.lastRequestTimes.allTime=l),n.allTime=await this.getCryptoCompareData(`${this.chartDataSettings.baseUrl}v2/histoday${r}&limit=740`),n.allTime&&(n.lastWeek=n.allTime.slice(-7),n.lastMonth=n.allTime.slice(-31),n.lastYear=n.allTime.slice(-365))),(c||s||l-this.requestTimeouts.last24Hour>this.lastRequestTimes.last24Hour)&&(e&&(this.lastRequestTimes.last24Hour=l),n.last24Hour=await this.getCryptoCompareData(`${this.chartDataSettings.baseUrl}v2/histominute${r}&limit=1440`)),n}async processCryptoCompareData({tickers:t,isGetAtOnce:e,isMainChart:s,endPoints:a}){const i=t.length;for(let r=0;r<i;r++){const n=i===r+1,o=t[r];for(const t of a){const a={ticker:o,isRequestTimeSave:n,isGetAtOnce:e,isMainChart:s,endPoint:t},i=await this.getCryptoCompareHistoryData(a);for(const t in i)this.setChartData(this.data,i[t],t,o)}}this.updateChartData(this.data)}async getAtomicServiceHistoryData(t,e,s){const a=this.isMobile&&"lastWeek"===e?"lastWeekHourly":e,i=u.includes(this.chartDataSettings.type)?"post":"get",r=this.chartDataSettings.baseUrl+a,o={url:"get"===i?`${r}?tickers=${t.join(",")}&fiat=${this.fiat}`:r,method:i,headers:{Authorization:"lYK43WJ95Y3195O"}};"post"===i&&(o.data={tickers:t.join(","),fiat:this.fiat});const c=await n()(o).catch(t=>{console.warn("Fetch chart data error",t)});c&&c.data&&(s&&(this.dataToUpdate={}),t.forEach(t=>{if(!c.data[t])return;const a=this.isReverse?c.data[t].reverse():c.data[t];if(s&&this.setChartData(this.dataToUpdate,a,e,t),this.setChartData(this.data,a,e,t),"allTime"===e){const e=a.slice(-365),i=a.slice(-31);s&&(this.setChartData(this.dataToUpdate,e,"lastYear",t),this.isMobile&&this.setChartData(this.dataToUpdate,i,"lastMonth",t)),this.setChartData(this.data,e,"lastYear",t),this.isMobile&&this.setChartData(this.data,i,"lastMonth",t)}if(this.isMobile&&"lastWeek"===e){const e=a.slice(-168),i=a.slice(-24);s&&(this.setChartData(this.dataToUpdate,e,"lastWeek",t),this.setChartData(this.dataToUpdate,i,"last24Hour",t)),this.setChartData(this.data,e,"lastWeek",t),this.setChartData(this.data,i,"last24Hour",t)}}))}async processAtomicServiceData({tickers:t,isGetAtOnce:e,isMainChart:s,endPoints:a}){let i=["last24Hour","lastWeek","lastMonth","allTime"];const r=s||a.length||1===t.length,n="lastYear"===this.mainChartEndPoint?"allTime":this.mainChartEndPoint;s?i=[n]:a.length>0?i=a:(i=i.filter(t=>t!==n),i.unshift(n));const o=i.length,c=Date.now(),h=Object(l.c)(t,30),d=h.length,u=[];for(let t=0;t<o;t++){const s=i[t],a=c-this.requestTimeouts[s];if(e||a>this.lastRequestTimes[s])for(let t=0;t<d;t++)d===t+1&&(this.lastRequestTimes[s]=c),u.push(this.getAtomicServiceHistoryData(h[t],s,r))}await Promise.allSettled(u),this.updateChartData(this.data)}async getHistoryDataFromNetByEndpoint(t,e,s="USD"){await this.getHistoryDataFromNet([t],s,!0,!1,[e])}async getHistoryDataFromNet(t,e="USD",s=!1,a=!1,i=[]){if(!t||0===t.length)return;this.fiat===e||"USD"===this.fiat&&"BTC"===e||(this.fiat="BTC"===e?"USD":e,this.isLoading=!0),1===t.length?await this.initChartData(t[0]):await this.initChartData(),this.getCoinChartData("BTC")&&(this.isLoading=!1);const r={tickers:t,isGetAtOnce:s,isMainChart:a,endPoints:i};"cryptocompare"===this.chartDataSettings.type?await this.processCryptoCompareData(r):await this.processAtomicServiceData(r),this.isLoading=!1}getMainChartData(t){try{return this.data[t][this.fiat][this.mainChartEndPoint]}catch(t){return[]}}getCoinChartData(t){try{return this.data[t][this.fiat]}catch(t){return[]}}isEmptyChart(t){var e,s;const{CoinMarketCap:a,CryptoCompare:i}=this.chartRequestList;return!(!a&&!i)&&!(null!=a&&null!==(e=a.assets)&&void 0!==e&&e.includes(t)||null!=i&&null!==(s=i.assets)&&void 0!==s&&s.includes(t))}async getChartsRequestFrequency(){try{const t=await c.a.get("charts_request_frequency");this.chartRequestList=null==t?void 0:t.sources}catch(t){console.warn(t)}}isPriceChart(t){try{return this.getMainChartData(t,this.fiat).length>0}catch(t){return!1}}async _insertBatch(t){await l.e.chartData.bulkPut(t)}async getChartDataForEndpoint(t,e,s=!1,a=!1){let i=null;if("cryptocompare"===this.chartDataSettings.type){const r={ticker:t,isRequestTimeSave:!1,isMainChart:a,isGetAtOnce:s,endPoint:e};i={cryptoCompareData:await this.getCryptoCompareHistoryData(r)}}else{var r;const s=u.includes(this.chartDataSettings.type)?"post":"get",a=this.chartDataSettings.baseUrl+e,o={url:"get"===s?`${a}?tickers=${t}&fiat=${this.fiat}`:a,method:s,headers:{Authorization:"lYK43WJ95Y3195O"}};"post"===s&&(o.data={tickers:t,fiat:this.fiat});const c=await n()(o).catch(t=>{console.warn("Fetch chart data error",t)}),l=this.isReverse?null==c||null===(r=c.data[t])||void 0===r?void 0:r.reverse():null==c?void 0:c.data[t];if(l){if("allTime"===e){const t=l.slice(-365),e=l.slice(-31);i={allTime:l,lastYear:t,lastMonth:e}}if("lastWeek"===e){i={lastWeek:l.slice(-168),last24Hour:l.slice(-24)}}}}return this.updateChartData({[t]:{[this.fiat]:i}}),i}};e.a=m},1519:function(t,e,s){"use strict";var a=s(31),i=s(22);const r=["BTC","ETH","TRX"];new class PriceAlerts{getTopicForCoin(t){return t+"-price-alerts"}getDefaultCoinsTopic(){return"default-price-alerts"}async getCoinsForSubscription(){try{return await a.a.get("price-alerts-config")}catch(t){return i.a.error({instance:this,error:t}),{}}}async getDefaultPriceAlertTickers(){try{const t=await this.getCoinsForSubscription();return Object.entries(t).filter(([,t])=>!0===t.default).map(([t])=>t)}catch(t){return i.a.error({instance:this,error:t}),r}}}},1530:function(t,e,s){"use strict";var a=s(1643),i=s.n(a),r=s(31),n=s(73);e.a=new class CoinRestrictionPolicy{constructor(){this.restrictions={},r.a.get("disabled-coins").then(t=>{this.restrictions=t})}getMessage(t,e){var s;return null===(s=this.getRestrictions(t,e)[0])||void 0===s?void 0:s.message}getRestrictions(t,e){return(this.restrictions[t]||[]).filter(({actions:t})=>t.includes("all")||t.includes(e)).filter(({platforms:t})=>t.includes("all")||t.includes(n.a.getPlatform())).filter(({versions:t})=>{const e=t[n.a.getPlatform()]||["all"];return e.includes("all")||e.reduce((t,e)=>t||((t,e)=>{const s=(t=>{const e=["<","<=",">=",">"];for(const s of e)if(0===t.indexOf(s))return s;return"="})(t);return i.a.compare(e,t.replace(s,""),s)})(e,n.a.getVersion()),!1)})}isAllowed(t,e){return 0===this.getRestrictions(t,e).length}}},155:function(t,e,s){"use strict";var a=s(16),i=s.n(a),r=s(398),n=s(151),o=s(625),c=s(651),l=s(4),h=s(3);class Coin extends(Object(c.a)(o.a)){constructor(t){super(...arguments),Object.keys(t).forEach(e=>{this[e]=t[e]}),this.id||(this.id=this.ticker),this.BN=i.a,this.bus=null,this.fields={},this.parent=this.id,this.plugins=[],this.address="",this.balance="",this.fiatBalance="",this.txBaseUrl="",this.explorers=[],this.transactions=[],this.activeExplorerIndex=0,this.eventEmmiter=n.a,this.config=Object.freeze({wallet:this.instance,config:arguments[0]}),this.loadExplorers(this.config),this.manageSocket(),this.manageEvents()}get args(){return{config:Object}}get instance(){return{id:this.id,ticker:this.ticker,name:this.name,alias:this.alias,assetName:this.assetName,decimal:this.decimal,parent:this.parent,BN:i(),toCurrencyUnit:t=>this.toCurrencyUnit(t),toMinimalUnit:t=>this.toMinimalUnit(t),tokens:()=>this.tokens,feeCoefficient:this.coefficient,feeDefault:this.feeData&&this.feeData.fee,reserveForStake:this.feeData&&this.feeData.reserveForStake}}get explorer(){return this.explorers[this.activeExplorerIndex]}get privateKeysObject(){return this.KeysObject||!1}set privateKeysObject(t){this.KeysObject=t}isFeeDynamic(){return!1}manageSocket(){h.v.forEach(t=>{this.eventEmmiter.on(t,({ticker:e,address:s,hash:a})=>{if(this.ticker===e){let e;if("function"==typeof this.getScriptPubKey)try{e=this.getScriptPubKey()}catch(t){console.warn(t)}"function"==typeof this.getProvider?this.getProvider("socket").getSocketTransaction({address:s,hash:a,scriptPubKey:e,tokens:this.tokens,type:t}):this.explorer.getSocketTransaction({address:s,hash:a,scriptPubKey:e,tokens:this.tokens,type:t})}})})}manageEvents(){this.eventEmmiter.on(`update::${this.id}::balance`,t=>{t?this.balance=t:this.getInfo()}),this.eventEmmiter.on(`update::${this.ticker}::token`,t=>{this.bus&&this.bus.$emit("update::balance",t)}),this.eventEmmiter.on(`${this.parent}-${this.id}::new-socket-tx`,({unconfirmedBalance:t,unconfirmedTx:e})=>{t&&(this.balance=t),e&&e.direction?this.bus.$emit("socket::newtx",{id:this.id,ticker:this.ticker,amount:e.amount,txid:e.txid}):this.bus.$emit("socket::newtx::outgoing",{id:this.id,ticker:this.ticker})}),this.eventEmmiter.on(this.ticker+"::new-token-tx",({token:t,unconfirmedTx:e})=>{const{ticker:s,id:a}=this.tokens[t];e&&e.direction?this.bus.$emit("socket::newtx",{id:a,ticker:s,amount:e.amount,txid:e.txid}):this.bus.$emit("socket::newtx::outgoing",{id:a,ticker:s})})}async getFee(){return new this.BN(this.fee||0)}getAddress(){throw new l.h("getAddress",this)}setAddress(t){this.address=t}setPrivateKey(t){this.privateKey=t}async validateAddress(t){throw new l.h("validateAddress",this)}async loadWallet(t){throw new l.h("async loadWallet",this)}async checkTransaction(t){try{await this.explorer.checkTransaction(this.address,t)}catch(t){console.warn(this.ticker,"Unable to check transaction")}this.bus.$emit("socket::newtx::outgoing",{id:this.id,ticker:t.coin.ticker}),setTimeout(async()=>{await this.getBalance()},3e3)}async getInfo(){try{const{balance:t=null,nonce:e=null}=this.explorer&&await this.explorer.getInfo(this.address);return t&&(this.balance=t),e&&(this.nonce=Number(e)),{balance:t,nonce:e}}catch(t){return{balance:this.balance}}}async getBalance(){const{balance:t}=await this.getInfo();return this.balance=t,t}async getTransactions(t){if(this.explorer){if(!this.address)throw new Error(`[${this.ticker}] getTransactions error: address is not loaded`);return await this.explorer.getTransactions({...t,address:this.address}).catch(t=>{throw new l.d({type:h.i,error:t,instance:this})})}return this.transactions}async availableBalance(t){var e,s;const a=(null===(e=this.balances)||void 0===e?void 0:e.available)&&this.toMinimalUnit(null===(s=this.balances)||void 0===s?void 0:s.available)||this.balance;if(!a)return null;const i=t&&new this.BN(t)||await this.getFee(),r=new this.BN(a).sub(i).sub(new this.BN(this.unspendableBalance));return new this.BN(r).lt(new this.BN(0))?"0":this.toCurrencyUnit(r)}async isAvailableForSend(t,e){if(t<0)return!1;if([null,void 0].includes(this.balance))return!1;const s=e?this.toMinimalUnit(e):void 0,a=this.toMinimalUnit(await this.availableBalance(s));return new this.BN(this.toMinimalUnit(t)).lte(new this.BN(a))}updateCoinParamsFromServer(t){if(t.feeData){const e=e=>{void 0!==this[e]&&void 0!==t.feeData[e]&&(this[e]=t.feeData[e])};Object.keys(t.feeData).forEach(t=>{e(t)})}t.branchId&&(this.branchId=t.branchId),this.explorers.forEach(e=>{const s=t.explorers.find(({className:t})=>-1!==e.constructor.name.indexOf(t));s&&(s.defaultRequestTimeout&&(e.defaultRequestTimeout=s.defaultRequestTimeout),s.websocketUrl&&(e.config.websocketUrl=s.websocketUrl),e.config.baseUrl=s.baseUrl,e.setAxiosClient()),e.webUrl=t.txWebUrl})}install(){this.plugins.forEach(t=>{t.install(this)})}loadExplorers({wallet:t,config:{explorers:e,txWebUrl:s,submitUrl:a}}){return this.explorers.push(...e.reduce((e,{baseUrl:i,className:n,options:o})=>{try{e.push(new r[n]({wallet:t,config:{baseUrl:i,webUrl:s,submitUrl:a,options:o}}))}catch(e){console.warn(`[${null==t?void 0:t.ticker}] Explorer module ${n} not found`)}return e},[]))}}e.a=Coin},1619:function(t,e,s){"use strict";var a=s(9),i=s(28),r=s.n(i);var n=class CashbackService_ExchangeCashback{constructor(t,e,s){this.baseUrl=t,this.addUri=e,this.listUri=s}addTx(t){return this.submitRequest(this.addUri,"post",t,"data",null)}listTxs(t){return this.submitRequest(this.listUri,"get",t,"params",[])}async submitRequest(t,e,s,a,i){try{const{data:i}=await r()({url:`${this.baseUrl}/${t}`,[a]:s,method:e});return i}catch(t){return console.error(t),i}}},o=s(31),c=s(73),l=s(1672),h=s(20),d=s(22);var u=class IndexedDbTable_IndexedDbTable extends Array{constructor(t,e="id",s=(({id:t})=>({id:t}))){super(),this.tableName=t,this.primaryKey=e,this.getSearchCriterion=s}get table(){return h.e[this.tableName]}getBatch(t={}){return this.getItems(t).toArray()}async getItem(t={}){return this.getItems(t).first()}getItems(t={}){return Object.keys(t).length>0?this.table.where(t):this.table}async insertBatch(t){try{return await this.table.bulkAdd(t),t}catch(t){return d.a.error({instance:this,error:t}),[]}}async insertItem(t){try{return await this.table.add(t),t}catch(t){d.a.error({instance:this,error:t})}}removeItem(t){return this.table.delete(t)}async updateBatch(t){try{return await Promise.all(t.map(t=>this.updateItem(t))),t}catch(t){return d.a.error({instance:this,error:t}),[]}}async updateItem(t){try{const e=await this.getItem(this.getSearchCriterion(t));if(e&&e[this.primaryKey])return await this.table.update(e[this.primaryKey],t),t}catch(t){d.a.error({instance:this,error:t})}}};var g=class ExchangeTxCache_ExchangeTxCache extends u{constructor(){super("exchangeTxs","exid")}insertTx(t,e,s,a,i,r={}){return this.insertItem({id:t.id,userId:e,status:"In process",txHash:null,payinHash:null,payoutHash:null,refundAddress:i,payoutAddress:t.payoutAddress,payinAddress:t.payinAddress,payinExtraId:t.payinExtraId,fromCurrency:t.from.ticker,from:t.from,toCurrency:t.to.ticker,to:t.to,amountToSend:s,amountToReceive:t.amountToReceive,expectedCashbackAmount:a,timestamp:(new Date).toISOString(),...r})}insertTxs(t){return this.insertBatch(t.map(t=>({id:t.orderId,userId:t.atomicId,status:t.status,txHash:t.payoutHash,payinHash:t.payinHash,payoutHash:t.payoutHash,refundAddress:t.refundAddress,payoutAddress:t.payoutAddress,payinAddress:t.payinAddress,payinExtraId:t.payinExtraId,fromCurrency:t.fromCurrency,from:t.from,toCurrency:t.toCurrency,to:t.to,amountToSend:t.amountSend,amountToReceive:t.amountReceive,expectedCashbackAmount:t.Cashbacks.length>0?t.Cashbacks[0].expectedCashbackAmount:"0",timestamp:t.createdAt})))}};const m=(t,e)=>`${e||""}-${t||""}`.toLowerCase(),f=({contract:t,parent:e,ticker:s})=>({contract:t,network:e,ticker:s});e.a=class Exchanges_Exchanges{constructor(){this.cashback=new n("https://apollo.atomicwallet.io","v2/transactions","transactions"),this.db=new g,this.services={changenow:new l.a}}async getAvailableWalletIdCollection(t,e){const s=await o.a.get("excludedExchangeCurrency2"),i=new Set(s.map(({excludedTicker:t,excludedNetwork:e})=>m(t,e))),r=this.getService(this.getCurrentServiceName());return t.reduce((t,s)=>{const n=r.getInternalContract(s),{ticker:o,parentTicker:c}=r.getInternalWalletData(s);if(i.has(m(o,c)))return t;if(["cchain","xchain"].includes(s.network)&&null!==n)return t;if("band"===s.ticker&&"band"!==s.network)return t;const l=e.findWalletV2({alias:"atomic",contract:n,ticker:o,parentTicker:c});if("AVAX"===o&&s.network!==(null==l?void 0:l.network))return t;if(l&&a.o.isAllowed(l.ticker,a.c)&&!t.includes(l.id))return t.concat(l.id);const h=e.findToken({contract:n,parent:c,ticker:o});return h&&a.o.isAllowed(h.parent,a.c)&&!t.includes(h.id)?t.concat(h.id):t},[])}getCurrentServiceName(){return"changenow"}getExchangeTransactionFromDb(){return this.db.getBatch()}async getExchangeTransactionsFromNet(t,e={}){const[s,a]=await Promise.all([this.getExchangeTransactionFromDb(),this.cashback.listTxs({atomicId:t,...e})]);return this.db.insertTxs(a.filter(({orderId:t})=>!s.some(({id:e})=>e===t)))}getPreorder(t,e,s,a){return{preorderFrom:t.ticker,preorderTo:e.ticker,preorderFromAmount:s,preorderToAmount:a,preorderTimestamp:Date.now()}}getService(t){return this.services[t]}addExchangeTransactionToDb(t,e,s,{estimatedAwcCashback:a},i,r){return this.db.insertTx(Object.assign({},t,{from:f(t.from),to:f(t.to)}),e,s,a,i,r)}async updateExchangeTransactionsInDb(t){return this.db.updateBatch(t)}postCashbackExchangeTx(t,e,s,a,i,r,n){return this.cashback.addTx({txParams:{orderId:t.id,atomicId:e,status:"waiting",fromCurrency:t.from.ticker,toCurrency:t.to.ticker,from:f(t.from),to:f(t.to),amountSend:s,amountReceive:t.amountToReceive,payinAddress:t.payinAddress,payinExtraId:t.payinExtraId,payoutAddress:t.payoutAddress,refundAddress:i,createdAt:t.timestamp,...r},cashbackParams:{atomicId:a.hash,bnbAddress:a.bnbAddr,ethAddress:a.ethAddr,expectedCashbackAmount:a.estimatedAwcCashback,expectedCashbackAmountRate:a.estimatedAwcCashbackRate,awcBep2Balance:a.awcBep2Balance,awcBep2Rate:a.awcBep2Rate,exchangeService:n,platform:c.a.getPlatform(),walletVersion:c.a.getVersion()}})}async sendTransaction(t,e,s,i,r,n,o=null){var c;if(!s||!n)throw new Error("Invalid exchange transaction, no address or orderId is specified");let l=null,h=null,d=null,u=null,g=null;const m=t instanceof a.D;o&&(g=o.fee,d=o.gasPrice,u=o.gasLimit);try{const a={address:s,amount:i,memo:r,userGasPrice:d,gasLimit:u},n=m?await t.createTransaction(a):{};l=m?await e.createTokenTransaction(n):await t.createTransaction({address:s,amount:i,memo:r,userGasPrice:d,gasLimit:u,userFee:g})}catch(t){throw console.error("Create tx error",t),new Error(t)}try{h=await e.sendTransaction(l),await this.updateExchangeTransactionsInDb([{id:n,payinHash:h.txid}])}catch(t){throw console.error("Send tx error",t),new Error(t)}return null!==(c=h)&&void 0!==c&&c.txid&&await e.checkTransaction({address:s,amount:i,memo:r,txid:h.txid,coin:t}).catch(t=>console.warn(t)),h}}},1637:function(t,e,s){"use strict";s.d(e,"a",(function(){return Providers}));var a=s(398),i=s(22);class Providers{constructor({config:t,wallet:e}){return t&&Array.isArray(t.explorers)?(this.list=[],t.explorers.forEach(s=>{if(!a[s.className])return;const r=a[s.className];try{const a=new r({config:{...s,webUrl:t.webUrl},wallet:e});this.list.push(a),!s.usedFor||Array.isArray(s.usedFor)&&0===s.usedFor.length?this.default=a:s.usedFor.forEach(t=>{this[t]=a})}catch(t){t.message=`[${e.ticker}::Providers] Could not load provider ${s.className}: ${t.message}`,i.a.error({instance:this,error:t})}}),this):this}}},22:function(t,e,s){"use strict";var a=s(28),i=s.n(a),r=s(1624),n=s(31),o=s(73),c=s(3);const l="https://ob.atomicwallet.io/reportBugs";const h=new class Logger{constructor(){this.logs=[],this.mnemonic=null,this.intervalId=null,this.hash=null,this.loggerUrl=l,n.a.get("logs-settings").then(t=>{t&&(this.loggerUrl=t.loggerUrl||l)}),this._initInterval()}log(t){this.logs.push(this._createLogObject(t,"info"))}error(t){console.error("[Logger::error]",t),"KIN"!==t.currency&&this.isConnected()&&this.logs.push(this._createLogObject(t,"error"))}isConnected(){return window.navigator.onLine}isEmpty(){return 0===this.logs.length}_clearLogs(){this.logs=[]}_createLogObject(t,e){const s="object"==typeof t.error?t.error.toString():t.error;return{date:new Date,userId:this.hash,currency:t.currency||t.instance.constructor.name,platform:o.a.getPlatform(),errorType:t.type||"",appVersion:o.a.getVersion(),coreVersion:r.a,errorMessage:t.url?`${t.url} :: ${s}`:s,errorStack:t.error.stack||"no stack trace"}}_initInterval(t=1e4){this.intervalId=setInterval(()=>{this.isConnected()?this.isEmpty()||this._sendLogsToCloud(this.logs).then(()=>{this._clearLogs()}).catch(t=>{this.error({type:c.r,error:t,instance:this})}):console.warn("[Logger] Send logs cancelled while is offline")},t)}_sendLogsToCloud(t){return i.a.post(this.loggerUrl,{logs:t,enabled:!0,userId:this.hash},{headers:{"Content-Type":"application/json"}})}};e.a=h},31:function(t,e,s){"use strict";var a=s(28),i=s.n(a),r=s(20),n=s(618),o=s(73);const c=()=>(new Date).getTime();e.a=new class ConfigManager{constructor(t){this.ttls={"about-tab":6e5,"avax-c-gas-price":5e3,"bnb-tokens":6e5,"cashback-settings":6e5,"chart-data-settings-new":6e5,charts_request_frequency:6e5,"cn-omni-tickers":6e5,"cn-unique-tickers":6e5,"coinmarketcap-supported-coins":6e5,coins_tips:6e5,"disabled-coins":6e5,"eth-gas-price":5e3,"ethereum-tokens":6e5,"ethereum-tokens-banned":6e5,"bsc-tokens":6e5,"bsc-tokens-banned":6e5,"polygon-tokens":6e5,"polygon-tokens-banned":6e5,excludedExchangeCurrency:6e5,excludedExchangeCurrency2:6e5,"icon-font-config":6e5,"learn-staking":6e5,"logs-settings":6e5,"new-release-features-desktop":6e5,"new-release-features-mobile":6e5,"price-alerts-config":6e5,"rates-config":6e5,"rates-list":6e5,"rates-settings":6e5,"referral-program-texts":6e5,"review-settings":6e5,"service-message":3e5,"simplex-settings_v2":6e5,"polygon-gas-price":5e3,"simplex-aliases":6e5,"simplex-settings_v3":6e5,"single-socket-settings-mobile":6e5,stake_validators_ada:6e5,"stake_validators_atom-2":6e5,stake_validators_band:6e5,stake_validators_icx:6e5,stake_validators_sol:6e5,stake_validators_tezos:6e5,stake_validators_trx:6e5,stake_validators_zil:6e5,"staking-coins-list":6e5,"smpx-unique-tickers":6e5,wallets_fee_7:3e5},this.cached={},this.baseUrl=t||n.a.get("CONFIGS_BASE_URL")}async fetch(t,e={}){const s="desktop"===await(async()=>{for(let t=3;t>0&&void 0===o.a.getPlatform();t--)await new Promise(t=>setTimeout(t,100));return o.a.getPlatform()})()?"Desktop":"Mobile";return(await i.a.get(`${this.baseUrl}/config/${t}.json`,Object.assign({headers:{"x-user-agent":`AtomicWallet (${s})/${o.a.getVersion()} (${o.a.getOS()})`}},e))).data}async get(t,e=!1,s={}){if(!e&&void 0!==this.cached[t]&&this.cached[t].expired>=c())return this.cached[t].data;try{const e=await this.fetch(t,s);if("object"!=typeof e)throw new TypeError(t+".json is not valid json file");return await r.e.configs.put({id:t,data:e}),void 0!==this.ttls[t]&&0!==this.ttls[t]&&(this.cached[t]={data:e,expired:c()+this.ttls[t]}),e}catch(e){console.error(e);const s=await r.e.configs.where({id:t}).first();return null==s?void 0:s.data}}}},472:function(t,e,s){"use strict";var a=s(20),i=s(265);const r=({ticker:t,contractAddress:e,tokenId:s})=>`${t},${n(e)},${s}`,n=t=>null===t?"":t;const o=new class NftHistory{async get(t=[]){const e=t.map(t=>t.ticker);await this.maintenance();const s=e.length>0?a.e.sentNfts.where("ticker").anyOf(e):a.e.sentNfts.toCollection(),n=await s.toArray(),o=new Set(n.map(t=>r(t))),c=e.length>0?a.e.nfts.where("ticker").anyOf(e):a.e.nfts.toCollection();return(await c.and(t=>!1===o.has(r(t))).toArray()).map(({ticker:t,contractAddress:e,tokenId:s,blockchain:a,tokenStandard:r,name:n,description:o,imageUrl:c})=>{return new i.b(""===(l=e)?null:l,s,t,a,r,n,o,c);var l})}getOneOptimistic(t,e,s){const{ticker:i}=t;return a.e.nfts.where("[ticker+contractAddress+tokenId]").equals([i,n(e),s]).first()}async set(t,e){const{ticker:s}=t;return await a.e.nfts.where({ticker:s}).delete(),a.e.nfts.bulkAdd(e.map(t=>(t.contractAddress=n(t.contractAddress),t)))}delete(t,e,s){const{ticker:i}=t;return a.e.sentNfts.add({ticker:i,contractAddress:n(e),tokenId:s,expiredAt:Date.now()+3e5})}async maintenance(){return a.e.sentNfts.where("expiredAt").below(Date.now()).delete()}};e.a=o},617:function(t,e,s){"use strict";var a=s(621),i=s.n(a);var r=class AboutInfo_AboutInfo{constructor(t){if(!i()(t))throw new TypeError("AboutInfo: constructor arguments object must be used");if(!("string"==typeof t.title&&t.title.length>0))throw new TypeError("AboutInfo: must have correct title");if(this.title=t.title,!("string"==typeof t.contentUrl&&t.contentUrl.length>0))throw new TypeError("AboutInfo: must have correct contentUrl");this.contentUrl=t.contentUrl,i()(t.previewUrl)?this.previewUrl={desktop:"string"==typeof t.previewUrl.desktop?t.previewUrl.desktop:"",mobile:"string"==typeof t.previewUrl.mobile?t.previewUrl.mobile:""}:this.previewUrl={desktop:"",mobile:""}}},n=s(31);e.a=new class AboutInfoList_AboutInfoList{async get(t){let e;try{if(e=await n.a.get("about-tab"),e){const s=e.find(e=>function(t,e){const{id:s,ticker:a,contract:i,parent:r}=e,{id:n,ticker:o,contract:c,network:l}=null==t?void 0:t.where;return n&&s?n.toLowerCase()===s.toLowerCase():(!l||!r||l.toLowerCase()===r.toLowerCase())&&(c||i?(null==c?void 0:c.toLowerCase())===(null==i?void 0:i.toLowerCase()):(null==o?void 0:o.toLowerCase())===(null==a?void 0:a.toLowerCase()))}(e,t));return((null==s?void 0:s.items)||[]).reduce((t,e)=>{try{return t.concat(new r(e))}catch(e){return console.warn(e),t}},[])}}catch(t){console.warn(t)}return null}}},618:function(t,e,s){"use strict";var a=s(1623);e.a=new class Environment{constructor(){this.settings=a}get(t){return this.getSection()[t]||this.getDefaultSection()[t]}getSection(){if(process.env.STAGING)return this.settings["true"===process.env.STAGING?"stage":"default"];const t=process.env.ATOMIC_CONFIG_MODE||"default";return this.settings[t]||this.settings.default}getDefaultSection(){return this.settings.default}}},623:function(t,e,s){"use strict";var a=s(20);e.a=new class AddrCacheDb{async getAddrCache(t,e){const s=await a.e.addrCache;return t&&e?s.where({ticker:t,type:e}).toArray():t?s.where({ticker:t}).toArray():s.toArray()}async setAddrCache({ticker:t,type:e,addresses:s}){const a=s.map(s=>({id:s,ticker:t,type:e,address:s}));return await this._insertBatch(a),a}async _insertBatch(t){return await a.e.addrCache.bulkPut(t),t}async _removeItem(t){await a.e.addrCache.delete(t)}}},625:function(t,e,s){"use strict";e.a=class BaseClass{constructor(...t){const e=Object.keys(this.args);if(t.length<e.length)throw new Error(`The ${this.constructor.name} constructor must receive at least ${e.length} argument${e.length>1&&"s"}!`);const s=(t,e,s,a)=>{const i=a&&a.name?a.name.toLowerCase():"object";switch(typeof t){case"array":if(!Array.isArray(t))throw new TypeError(`The argument ${s+1} ('${e}') must be 'Array' type!`);break;case"object":if(!(t instanceof a||t.constructor.name===a.name)){const t=new TypeError(`[${this.ticker}][${this.constructor.name}] The argument ${s+1} ('${e}') must be '${a.name}' type!`);throw console.error(t.stack),t}break;case"string":case"number":case"boolean":if(typeof t!==i)throw new TypeError(`The argument ${s+1} ('${e}') must be '${a&&a.name}' type!`)}};Object.assign(this,t.reduce((t,a,i)=>{const r=e[i];if(void 0!==r){const e=this.args[r];if("function"==typeof e&&s(a,r,i,e),Array.isArray(e)){let t=!1;const n=[];if(e.forEach(e=>{try{s(a,r,i,e),t=!0}catch(t){n.push(t)}}),!t)throw n}t[r]=a}else t[i]=a;return t},{}))}get args(){return{}}}},73:function(t,e,s){"use strict";const a=Symbol("unknownOS"),i=Object.freeze({android:"Android",darwin:"macOS",ios:"iOS",win32:"Windows",linux:"Linux",[a]:"Unknown"});e.a=new class PlatformVersion{constructor(){var t;this.os=null!==(t=i[process.platform])&&void 0!==t?t:i.linux,this.platform=void 0,this.version=void 0}getAvailablePlatforms(){return{android:"android",browser:"android",desktop:"desktop",ios:"ios"}}getAvailableOSList(){return i}getPlatform(){return this.platform}getVersion(){return this.version}isIOS(){return"iOS"===this.getOS()}setPlatform(t){var e;const s=this.getAvailablePlatforms();this.platform=null!==(e=s[t])&&void 0!==e?e:s.desktop}getPlatformType(){const t=this.getAvailablePlatforms();return[[[t.ios,t.android],"Mobile"],[[t.desktop],"Desktop"]].reduce((t,e)=>(e[0].includes(this.getPlatform())&&(t=e[1]),t),"Unknown")}setVersion(t){this.version=t}setOS(t){const e=this.getAvailableOSList(),s=t.toLowerCase();this.os=e[s]?s:a}getOS(){return this.os===a?"Unknown".toLowerCase():this.os}getOSName(){return this.getAvailableOSList()[this.os]}getUnknownValue(){return"Unknown"}}},8:function(t,e,s){"use strict";var a=s(28),i=s.n(a),r=s(620),n=s.n(r),o=s(370),c=s.n(o),l=s(87),h=s(151),d=s(29),u=s(39),g=s(4),m=s(3);const f=["reward","unfreeze","freeze","vote"];e.a=class Explorer{constructor({wallet:t,config:e}){this.config=e;const s=this.getAllowedTickers();if(!s.includes(t.ticker))throw new Error(`[${this.constructor.name}] This Explorer supports ${s.join(", ")} wallet types, but does not support ${t.ticker}`);this.defaultTxLimit=100,this.wallet=t,this.setAxiosClient(),this.socket={},this.webUrl=e.webUrl,this.clients={},this.eventEmmiter=h.a,this.lastGetInfoRequestTime=null,this.lastGetTxsRequestTime=null,this.defaultRequestTimeout=null}setSocketClient(t){this.socket[this.wallet.ticker]=n()(t,{transports:["websocket"]})}setAxiosClient(){this.client=i.a.create(this.getInitParams())}toBNMinimalUnit(t){return new this.wallet.BN(this.wallet.toMinimalUnit(null!=t?t:0))}toBNCurrencyUnit(t){return new this.wallet.BN(this.wallet.toCurrencyUnit(null!=t?t:0))}getWebTransactionUrl(t){return`${this.webUrl}${t}`}getAllowedTickers(){throw new g.h("getAllowedTickers",this)}getInitParams(){if(!this.config.baseUrl)throw new Error(`${this.wallet.ticker} ${this.constructor.name}: explorer config have no baseUrl`);return{baseURL:this.config.baseUrl}}getTokenId(t,e,s="atomic"){if(!t)throw new Error("[getTokenId] Error: Missing `ticker` arg");if(!e)throw new Error("[getTokenId] Error: Missing `contract` arg");return c.a.hash(t.toLowerCase()+e.toLowerCase())}getApiPrefix(){return"api"}async checkTransaction(t,{coin:e,address:s,amount:a,memo:i,txid:r,nonce:n,fee:o,feeTicker:c}){const h=new d.a({ticker:e.ticker,walletid:e.id,name:e.name,alias:e.alias,explorer:this.constructor.name,txid:r,direction:t===s,otherSideAddress:s,amount:Object(u.c)(a,e.decimal),datetime:new Date,memo:i,nonce:n,confirmations:0,fee:o,feeTicker:c});return await l.a.filterAndUpdateTransactions([h]),h}async getInfo(t){if(!t||"string"!=typeof t)throw this.createError("getInfo: address must be string with length > 0");if(this.defaultRequestTimeout&&Date.now()-this.defaultRequestTimeout*m.o<this.lastGetInfoRequestTime)return this.modifyInfoResponse(void 0);this.defaultRequestTimeout&&Date.now()-this.defaultRequestTimeout*m.o>this.lastGetInfoRequestTime&&(this.lastGetInfoRequestTime=Date.now());const e=await this.request(this.getInfoUrl(t),this.getInfoMethod(),this.getInfoParams(t),m.f,this.getInfoOptions());return this.modifyInfoResponse(e)}getInfoUrl(t){throw new g.h("getInfoUrl",this)}getInfoMethod(){return"get"}getInfoParams(t){return{}}getInfoOptions(){return{transformResponse:[t=>JSON.parse(t.replace(/:(\d+)([,}])/g,':"$1"$2'))]}}getTransactionOptions(){return{}}getTransactionsOptions(){return{}}getUtxoOptions(){return{}}getLatestBlockOptions(){return{}}getSendOptions(){return{}}modifyInfoResponse(t){return t}async getTransaction(t,e,s=[]){const a=await this.request(this.getTransactionUrl(e),this.getTransactionMethod(),this.getTransactionParams(e),m.j,this.getTransactionOptions());return this.modifyTransactionResponse(a,t,s)}getTransactionModifiedResponse(t,e,s=this.wallet.ticker){return Object.assign({explorer:this.constructor.name,locktime:t&&t.lockTime},this.getTransactionsModifiedResponse(t,e,s))}getTransactionsModifiedResponse(t,e,s=this.wallet.ticker){return{ticker:s,name:this.wallet.name,walletid:this.wallet.id,txid:this.getTxHash(t),direction:this.getTxDirection(e,t),otherSideAddress:this.getTxOtherSideAddress(e,t),amount:this.getTxValue(e,t),datetime:this.getTxDateTime(t),memo:this.getTxMemo(t),confirmations:this.getTxConfirmations(t),nonce:this.getTxNonce(t),alias:this.wallet.alias,fee:this.getTxFee(t),feeTicker:this.getTxFeeTicker()}}getTransactionUrl(t){throw new g.h("getTransactionUrl",this)}getTransactionMethod(){return"get"}getTransactionParams(t){return{}}modifyTransactionResponse(t,e,s=this.wallet.ticker){return new d.a(this.getTransactionModifiedResponse(t,e,s))}async getTransactions({address:t,offset:e,limit:s,pageNum:a}){if(this.defaultRequestTimeout&&Date.now()-this.defaultRequestTimeout*m.o<this.lastGetTxsRequestTime)return[];this.defaultRequestTimeout&&Date.now()-this.defaultRequestTimeout*m.o>this.lastGetTxsRequestTime&&(this.lastGetTxsRequestTime=Date.now());const i=await this.request(this.getTransactionsUrl(t),this.getTransactionsMethod(),this.getTransactionsParams(t,e||0,s||this.defaultTxLimit,a),m.i,this.getTransactionsOptions());return this.modifyTransactionsResponse(i,t)}getTransactionsUrl(t){throw new g.h("getTransactionsUrl",this)}getTransactionsMethod(){return"get"}getTransactionsParams(t,e=0,s=this.defaultTxLimit,a){return{from:e,to:e+s}}modifyTransactionsResponse(t,e){return Array.isArray(t)?t.map(t=>this.getTransactionsModifiedResponse(t,e)):[]}async getUnspentOutputs(t,e){const s=await this.request(this.getUnspentOutputsUrl(t),this.getUnspentOutputsMethod(),this.getUnspentOutputsParams(t),m.k,this.getUtxoOptions());return this.modifyUnspentOutputsResponse(t,s,e)}getUnspentOutputsUrl(t){throw new g.h("getUnspentOutputsUrl",this)}getUnspentOutputsMethod(){return"get"}getUnspentOutputsParams(t){return{}}modifyUnspentOutputsResponse(t,e,s){return e}async sendTransaction(t){const e=await this.request(this.getSendTransactionUrl(),this.getSendTransactionMethod(),this.getSendTransactionParams(t),m.s,this.getSendOptions());return this.modifySendTransactionResponse(e)}getSendTransactionUrl(){throw new g.h("getSendTransactionUrl",this)}getSendTransactionMethod(){return"post"}getSendTransactionParam(){return"txid"}getSendTransactionParams(t){return{[this.getSendTransactionParam()]:t}}modifySendTransactionResponse(t){return t}getHeaders(){return{}}async request(t,e="get",s={},a=m.w,i={}){let r;if(-1!==t.search("undefined"))throw new Error("corrupted url: "+t);try{r=await this.client.request({url:t,method:e,["get"===e?"params":"data"]:s,...i})}catch(e){const{headers:s,method:i,baseURL:r,url:n,data:o}=(null==e?void 0:e.config)||{},c={request:{headers:s,method:i,baseURL:r,url:n,data:o}};if(e.response){const{data:t,status:s,statusText:a,headers:i}=e.response,r={data:t,status:s,statusText:a,headers:i};c.response=r}else c.response="No response data available";throw new g.d({type:a,error:new Error(JSON.stringify(c)),errorData:c,url:`${this.config.baseUrl}${t}`,instance:this})}try{return this.modifyGeneralResponse(r)}catch(e){throw new g.d({type:a,error:e,url:`${this.config.baseUrl}${t}`,instance:this})}}modifyGeneralResponse(t){return t.data}getTxNonce(t){}getTxFee(t){return this.wallet.toCurrencyUnit(t.fee||this.wallet.feeDefault||0)}getTxValue(t,e){throw new g.h("getTxValue",this)}getTxDirection(t,e){return e.vin&&!e.vin.find(({addr:e})=>e===t)&&!0}getTxOtherSideAddress(t,e){if(e.vin){if(this.getTxDirection(t,e))return e.vin[0].addr;const s=e.vout.find(({scriptPubKey:{addresses:e}})=>!e.includes(t));if(s)return s.scriptPubKey.addresses[0]}return"..."}getTxDateTime(t){return new Date(Number(t.time+"000"))}getTxDate(t){return this.getTxDateTime(t).toDateString().slice(4)}getTxTime(t){return this.getTxDateTime(t).toTimeString().slice(0,5)}getTxConfirmations(t){return t.confirmations||0}getTxHash(t){return t.txid}getTxMemo(t){return""}getTxFeeTicker(){return this.wallet.parent}async getBalance(t,e=!1){const s=await this.getInfo(t);return s&&s.balance?e?s.balance:String(this.wallet.toCurrencyUnit(s.balance)):null}getLatestBlockUrl(){throw new g.h("getLatestBlockUrl",this)}getLatestBlockMethod(){return"get"}getLatestBlockParams(){return{}}modifyLatestBlockResponse(t){return t}async getLatestBlock(){const t=await this.request(this.getLatestBlockUrl(),this.getLatestBlockMethod(),this.getLatestBlockParams(),m.h,this.getLatestBlockOptions());return this.modifyLatestBlockResponse(t)}getBlockUrl(){throw new g.h("getBlockUrl",this)}getBlockMethod(){throw new g.h("getBlockMethod",this)}getBlockParams(){throw new g.h("getBlockParams",this)}getBlockOptions(){throw new g.h("getBlockParams",this)}async getBlock(t){const e=await this.request(this.getBlockUrl(t),this.getBlockMethod(),this.getBlockParams(),m.g,this.getBlockOptions());return this.modifyGetBlockResponse(e)}modifyGetBlockResponse(t){return t}getTxLimit(){return this.defaultTxLimit}createError(t){return new Error(`[${this.wallet.ticker}] ${this.constructor.name} Error: ${t}`)}async getSocketTransaction({address:t,hash:e,tokens:s,type:a}){const i=await this.getTransaction(t,e,s);await l.a.filterAndUpdateTransactions([i]),"receive"===a&&this.eventEmmiter.emit(`${this.wallet.parent}-${i.walletid}::new-socket-tx`,{unconfirmedTx:i}),"confirm"===a&&this.eventEmmiter.emit(this.wallet.parent+"::confirmed-socket-tx",i.walletid,i,i.ticker),f.forEach(t=>{a===t&&this.eventEmmiter.emit(`${this.wallet.parent}::confirmed-${a}`,i||{})})}makeNftInfoUrl(t,e){throw new g.h("makeNftInfoUrl",this)}async fetchNftList(t){throw new g.h("fetchNftList",this)}async sendNft(t,e,s,a,i,r){throw new g.h("fetchNftList",this)}}},87:function(t,e,s){"use strict";var a=s(29),i=s(22),r=s(20);const n=new class History{constructor(){this.processing=!1}async getTransactionIds(){this.processing=!0;return(await r.e.transactions.toArray().finally(()=>{this.processing=!1})).map(({txid:t,ticker:e,walletid:s,alias:a})=>({txid:t,ticker:e,walletid:s,alias:a}))}async findTransaction(t){this.processing=!0;return await r.e.transactions.where({txid:t}).first().finally(()=>{this.processing=!1})}async removeTransaction(t){this.processing=!0;return await r.e.transactions.where({...t,alias:"atomic"}).delete().finally(()=>{this.processing=!1})}async selectTransactions(t=null){this.processing=!0;let e=[];if(t){const{ticker:s,...i}=t;return e=await r.e.transactions.where({...i,alias:"atomic"}).and(t=>{var e;return"string"!=typeof s||(null===(e=t.ticker)||void 0===e?void 0:e.toLowerCase())===s.toLowerCase()}).toArray().finally(()=>{this.processing=!1}),e.map(t=>a.a.fromHistory(t))}return e=await r.e.transactions.toArray().finally(()=>{this.processing=!1}),e.map(t=>a.a.fromHistory(t))}async filterAndUpdateTransactions(t){const e=await Promise.all(t.map(async t=>{const e={...t};return e.fee=await t.fee,e.confirmations=await t.confirmations,e}));await this.putTransactions(e).catch(t=>i.a.error({instance:this,error:t}))}async putTransactions(t){return(t=t.filter(Boolean).map(this._prepareTransactionForIDB)).length>0&&(this.processing=!0,await r.e.transactions.bulkPut(t)),t}async updateTransaction(t){this.processing=!0;const e=await r.e.transactions.where({txid:t.txid,ticker:t.ticker,alias:t.alias,walletid:t.walletid}).first();if(e&&e.id)return await r.e.transactions.update(e.id,t),t}async clearTransactions(){await r.e.transactions.clear()}_prepareTransactionForIDB(t){return Object.keys(t).reduce((e,s)=>{if(void 0===t[s])return e;var a;"txid"===s&&(e.id=null===(a=t[s])||void 0===a?void 0:a.toString());if(["date","time"].includes(s))return e;if("direction"===s)e[s]=t[s]?"in":"out";else if("otherSideAddress"===s){var i;e.recepient=null===(i=t[s])||void 0===i?void 0:i.toString()}else{var r;e[s]=null===(r=t[s])||void 0===r?void 0:r.toString()}return e},{})}async updatePendingOrInsert(t,e){const s=(await this.selectTransactions({txid:"pending",ticker:t.ticker,alias:"atomic"})).find(e=>e.amount===t.amount&&e.recepient===t.otherSideAddress);s?(this.processing=!0,s&&s.id&&await r.e.transactions.delete(s.id).finally(()=>{this.processing=!1})):await this.filterAndUpdateTransactions([t])}async xmrHasFrozenBalance(){return!!(await this.selectTransactions({ticker:"XMR"})).find(t=>t.confirmations<10)}};e.a=n},886:function(t,e,s){"use strict";var a=s(35);e.a=class PromiseQueue{constructor(t,e){this.chunks=Object(a.chunk)(t,e)}async execute(){for(let t=0;t<this.chunks.length;t++)await Promise.all(this.chunks[t].map(t=>t()))}}},933:function(t,e,s){"use strict";e.a=class Addresses{constructor(t){this.secureStrage=t,this.secureStrageId="wallets",this.storageId="addresses"}async get(){try{const t=await this.secureStrage.get(this.secureStrageId),e=JSON.parse(localStorage.getItem(this.storageId)||t);return JSON.parse(t).map(t=>{var s;return Object.assign({address:null===(s=e.find(({id:e})=>e===t.id))||void 0===s?void 0:s.address},t)})}catch(t){return console.error(t),[]}}set(t){try{const e=Array.from(t);this.secureStrage.set(this.secureStrageId,JSON.stringify(e.map(({alias:t,balance:e,id:s,privateKey:a,ticker:i})=>({alias:t,balance:e,id:s,privateKey:a,ticker:i})))),localStorage.setItem(this.storageId,JSON.stringify(e.map(({id:t,address:e})=>({id:t,address:e}))))}catch(t){console.error(t)}}}},934:function(t,e,s){"use strict";var a=s(31),i=s(22),r=s(392),n=s(3),o=s(1627);e.a=new class Buy{constructor(){this.rates=new r.c,this.settings=n.c,this.settings.simplexTickers=o,Promise.allSettled([a.a.get("simplex-settings_v3"),a.a.get("simplex-aliases")]).then(([t,e])=>{"fulfilled"===t.status&&(this.settings=t.value),"fulfilled"===e.status&&(this.settings.simplexTickers=e.value)}).catch(t=>{i.a.error({instance:this,error:t})})}async getSettings(t){const e=this.settings.fiats[t];if("USD"===t||"EUR"===t)return e;try{const s=await this.getUsdPrice(t),a=60,i=19990,r=10;return{min:Math.round(s*a),max:Math.round(s*i),fee:Math.ceil(s*r),default:e.default}}catch(t){return e}}getSimplexTicker({contract:t,parent:e,ticker:s}){const a=Object.entries(this.settings.simplexTickers).find(([,{contract:a,network:i,ticker:r}])=>{const n=!a&&!t&&r.toLowerCase()===s.toLowerCase(),o=a&&t&&a.toLowerCase()===t.toLowerCase();return e.toLowerCase()===i.toLowerCase()&&(n||o)});return a?a[0]:s}getAvailableWallet({id:t}){return this.settings.availableWallets.find(({id:e})=>e.toUpperCase()===t.toUpperCase())}isAvailable(t){return void 0!==this.getAvailableWallet(t)}async getUsdPrice(t){try{const e="USD",s=await this.rates.get([{id:e,ticker:e}],t),{rate:a}=s.find(({ticker:t})=>t===e)||{};return a||0}catch(t){return console.error(t),0}}}}}]);